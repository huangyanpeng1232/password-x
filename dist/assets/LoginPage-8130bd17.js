import{s as S,m as L,k as N,c as A,F as U,G as O,g as K,b as P}from"./element-plus-6342e0a0.js";import{_ as z,l as $,g as G,e as J}from"./index-62da80b3.js";import{s as y,g as I}from"./global-92074fcc.js";import{u as T,b as Q}from"./vue-router-c2e97886.js";import{u as X}from"./vue-i18n-3214f365.js";import{h as j}from"./@vueuse-9ffc2ac5.js";import{r as H,X as E,o as W,c as Y,a as u,S as r,J as s,u as f,P as i,Q as Z,R as ee,aq as oe,ar as te}from"./@vue-8e6a53e5.js";import"./lodash-es-f5bdeb48.js";import"./async-validator-dee29e8b.js";import"./@element-plus-169d18e8.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./escape-html-cf2a8097.js";import"./ali-oss-21f5c855.js";import"./normalize-wheel-es-ed76fb12.js";import"./vuex-7c7bb3a2.js";import"./cos-js-sdk-v5-31c61e27.js";import"./js-md5-11f5a111.js";import"./crypto-js-d55471a7.js";import"./@intlify-6e8dbf92.js";const re=""+new URL("backImg-584761fc.svg",import.meta.url).href;const se=m=>(oe("data-v-95d42b4b"),m=m(),te(),m),ae=se(()=>u("img",{alt:"",class:"back-img",src:re},null,-1)),le={class:"content"},ne={class:"language-div"},ie={class:"content-input"},ue={class:"title"},de={class:"content-button"},ce={class:"oss-register-doc"},me={__name:"LoginPage",setup(m){const{t:l,locale:p}=X(),k=j(),h=T(),d=Q(),b=H(),o=E({type:"cos",region:"",keyId:"",keySecret:"",bucket:""}),V=E({region:[{required:!0,message:l("login.form.region.verify"),trigger:"blur"}],keyId:[{required:!0,message:l("login.form.accessKeyId.verify"),trigger:"blur"}],keySecret:[{required:!0,message:l("login.form.accessKeySecret.verify"),trigger:"blur"}],bucket:[{required:!0,message:l("login.form.bucket.verify"),trigger:"blur"}]}),w=async()=>{window.open("https://gitee.com/password-x/password-x/wikis/%E9%98%BF%E9%87%8C%E4%BA%91%E8%B4%A6%E5%8F%B7%E6%93%8D%E4%BD%9C%E6%8C%87%E5%BC%95")},C=async t=>{await t.validate(e=>{e&&$(o).then(n=>{q()}).catch(n=>{B(n)})})},q=()=>{let t=G(),e=J(t,JSON.stringify(o));localStorage.setItem("databaseForm",e),S.success(l("login.form.successMessage")),h.push("/")},B=t=>{console.error(t);let e;t.code==="RequestError"?e=l("login.form.error.RequestError"):t.code==="InvalidAccessKeyId"?e=l("login.form.error.InvalidAccessKeyId"):t.code==="SignatureDoesNotMatch"?e=l("login.form.error.SignatureDoesNotMatch"):t.code==="AccessDenied"?e=l("login.form.error.AccessDenied"):e=t.code,S({type:"error",title:l("login.form.failMessage"),message:e})},_=t=>{p.value=t,y("language",t)},F=()=>{let t=I("language");t?_(t):navigator.language.toLowerCase()!=="zh-cn"&&(p.value="en-us",y("language","en-us"));let e=I("darkMode");if(e)k.value=e;else{let n=window.matchMedia("(prefers-color-scheme: dark)");n&&n.matches&&(k.value=!0,y("darkMode",!0))}},R=()=>{o.type=d.query.type||"oss",o.region=d.query.region||"",o.keyId=d.query.keyId||"",o.keySecret=d.query.keySecret||"",o.bucket=d.query.bucket||""};return F(),R(),(t,e)=>{const n=L,v=U,D=O,c=K,g=P,x=N,M=A;return W(),Y(ee,null,[ae,u("div",le,[u("div",ne,[r(n,{type:f(p)==="zh-cn"?"primary":"default",onClick:e[0]||(e[0]=a=>_("zh-cn")),underline:!1},{default:s(()=>[i("简体中文 ")]),_:1},8,["type"]),i(" / "),r(n,{type:f(p)==="en-us"?"primary":"default",onClick:e[1]||(e[1]=a=>_("en-us")),underline:!1},{default:s(()=>[i("English ")]),_:1},8,["type"])]),u("div",ie,[u("div",ue,Z(f(l)("login.form.title")),1),r(x,{ref_key:"ruleFormRef",ref:b,model:o,rules:V},{default:s(()=>[r(c,{prop:"type"},{default:s(()=>[r(D,{modelValue:o.type,"onUpdate:modelValue":e[2]||(e[2]=a=>o.type=a),style:{margin:"0 auto"}},{default:s(()=>[r(v,{label:"oss"},{default:s(()=>[i("阿里OSS")]),_:1}),r(v,{label:"cos"},{default:s(()=>[i("腾讯COS")]),_:1})]),_:1},8,["modelValue"])]),_:1}),r(c,{prop:"region"},{default:s(()=>[r(g,{modelValue:o.region,"onUpdate:modelValue":e[3]||(e[3]=a=>o.region=a),clearable:"",placeholder:"region"},null,8,["modelValue"])]),_:1}),r(c,{prop:"keyId"},{default:s(()=>[r(g,{modelValue:o.keyId,"onUpdate:modelValue":e[4]||(e[4]=a=>o.keyId=a),clearable:"",placeholder:"keyId"},null,8,["modelValue"])]),_:1}),r(c,{prop:"keySecret"},{default:s(()=>[r(g,{modelValue:o.keySecret,"onUpdate:modelValue":e[5]||(e[5]=a=>o.keySecret=a),clearable:"",placeholder:"keySecret"},null,8,["modelValue"])]),_:1}),r(c,{prop:"bucket"},{default:s(()=>[r(g,{modelValue:o.bucket,"onUpdate:modelValue":e[6]||(e[6]=a=>o.bucket=a),clearable:"",placeholder:"bucket"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),u("div",de,[r(M,{type:"primary",style:{width:"100%"},onClick:e[7]||(e[7]=a=>C(f(b)))},{default:s(()=>[i("登录")]),_:1})]),u("div",ce,[r(n,{type:"primary",onClick:w},{default:s(()=>[i("阿里云OSS注册指引")]),_:1})])])])],64)}}},xe=z(me,[["__scopeId","data-v-95d42b4b"]]);export{xe as default};
