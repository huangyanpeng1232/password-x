import{s as k,m as R,k as x,c as M,b as L,g as O}from"./element-plus-18f066c9.js";import{_ as N,l as A,s as U,g as P,e as z}from"./index-448a6c4e.js";import{s as _,g as v}from"./global-a76afce6.js";import{u as $,b as J}from"./vue-router-5a7b09ab.js";import{u as T}from"./vue-i18n-4c151794.js";import{h as Q}from"./@vueuse-e77020a1.js";import{r as X,X as I,o as j,c as G,a as c,S as t,J as n,u as f,P as i,Q as H,R as W,ap as Y,aq as Z}from"./@vue-b476408c.js";import"./lodash-es-f5bdeb48.js";import"./async-validator-dee29e8b.js";import"./@element-plus-deb668f5.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./escape-html-900e7f0d.js";import"./ali-oss-85314bd4.js";import"./normalize-wheel-es-ed76fb12.js";import"./vuex-ea406d73.js";import"./js-md5-80305e46.js";import"./crypto-js-0173151c.js";import"./@intlify-6e8dbf92.js";const ee=""+new URL("backImg-584761fc.svg",import.meta.url).href;const oe=u=>(Y("data-v-91e6b5bf"),u=u(),Z(),u),se=oe(()=>c("img",{alt:"",class:"back-img",src:ee},null,-1)),te={class:"content"},re={class:"language-div"},ae={class:"content-input"},le={class:"title"},ne={class:"content-button"},ce={class:"oss-register-doc"},ie={__name:"LoginPage",setup(u){const{t:a,locale:d}=T(),S=Q(),h=$(),m=J(),b=X(),s=I({region:"",accessKeyId:"",accessKeySecret:"",bucket:""}),K=I({region:[{required:!0,message:a("login.form.region.verify"),trigger:"blur"}],accessKeyId:[{required:!0,message:a("login.form.accessKeyId.verify"),trigger:"blur"}],accessKeySecret:[{required:!0,message:a("login.form.accessKeySecret.verify"),trigger:"blur"}],bucket:[{required:!0,message:a("login.form.bucket.verify"),trigger:"blur"}]}),E=async()=>{window.open("https://gitee.com/password-x/password-x/wikis/%E9%98%BF%E9%87%8C%E4%BA%91%E8%B4%A6%E5%8F%B7%E6%93%8D%E4%BD%9C%E6%8C%87%E5%BC%95")},w=async o=>{await o.validate(e=>{e&&A(s).then(r=>{V(r)}).catch(r=>{C(r)})})},V=o=>{U.commit("setOss",o);let e=P(),r=z(e,JSON.stringify(s));localStorage.setItem("ossForm",r),k.success(a("login.form.successMessage")),h.push("/")},C=o=>{console.error(o);let e;o.code==="RequestError"?e=a("login.form.error.RequestError"):o.code==="InvalidAccessKeyId"?e=a("login.form.error.InvalidAccessKeyId"):o.code==="SignatureDoesNotMatch"?e=a("login.form.error.SignatureDoesNotMatch"):o.code==="AccessDenied"?e=a("login.form.error.AccessDenied"):e=o.code,k({type:"error",title:a("login.form.failMessage"),message:e})},y=o=>{d.value=o,_("language",o)},q=()=>{let o=v("language");o?y(o):navigator.language.toLowerCase()!=="zh-cn"&&(d.value="en-us",_("language","en-us"));let e=v("darkMode");if(e)S.value=e;else{let r=window.matchMedia("(prefers-color-scheme: dark)");r&&r.matches&&(S.value=!0,_("darkMode",!0))}},B=()=>{s.region=m.query.region||"",s.accessKeyId=m.query.accessKeyId||"",s.accessKeySecret=m.query.accessKeySecret||"",s.bucket=m.query.bucket||""};return q(),B(),(o,e)=>{const r=R,g=L,p=O,D=x,F=M;return j(),G(W,null,[se,c("div",te,[c("div",re,[t(r,{type:f(d)==="zh-cn"?"primary":"default",onClick:e[0]||(e[0]=l=>y("zh-cn")),underline:!1},{default:n(()=>[i("简体中文 ")]),_:1},8,["type"]),i(" / "),t(r,{type:f(d)==="en-us"?"primary":"default",onClick:e[1]||(e[1]=l=>y("en-us")),underline:!1},{default:n(()=>[i("English ")]),_:1},8,["type"])]),c("div",ae,[c("div",le,H(f(a)("login.form.title")),1),t(D,{ref_key:"ruleFormRef",ref:b,rules:K,model:s},{default:n(()=>[t(p,{prop:"region"},{default:n(()=>[t(g,{modelValue:s.region,"onUpdate:modelValue":e[2]||(e[2]=l=>s.region=l),clearable:"",placeholder:"OSS region"},null,8,["modelValue"])]),_:1}),t(p,{prop:"accessKeyId"},{default:n(()=>[t(g,{modelValue:s.accessKeyId,"onUpdate:modelValue":e[3]||(e[3]=l=>s.accessKeyId=l),clearable:"",placeholder:"OSS accessKeyId"},null,8,["modelValue"])]),_:1}),t(p,{prop:"accessKeySecret"},{default:n(()=>[t(g,{modelValue:s.accessKeySecret,"onUpdate:modelValue":e[4]||(e[4]=l=>s.accessKeySecret=l),clearable:"",placeholder:"OSS accessKeySecret"},null,8,["modelValue"])]),_:1}),t(p,{prop:"bucket"},{default:n(()=>[t(g,{modelValue:s.bucket,"onUpdate:modelValue":e[5]||(e[5]=l=>s.bucket=l),clearable:"",placeholder:"OSS bucket"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"]),c("div",ne,[t(F,{type:"primary",style:{width:"100%"},onClick:e[6]||(e[6]=l=>w(f(b)))},{default:n(()=>[i("登录")]),_:1})]),c("div",ce,[t(r,{type:"primary",onClick:E},{default:n(()=>[i("阿里云OSS注册指引")]),_:1})])])])],64)}}},qe=N(ie,[["__scopeId","data-v-91e6b5bf"]]);export{qe as default};
