import{s as _,g as v}from"./el-link-0aa41350.js";import{_ as x,u as R,n as M,p as L,ab as O,a as A,r as b,o as N,q as U,b as c,d as t,w as n,f as p,e as i,t as z,F as P,ac as $,v as J,x as T,J as H,R as I,S as j,H as G,l as Q,a8 as W,a9 as X,k as Y,A as Z}from"./index-7f4c583e.js";const ee=""+new URL("backImg-584761fc.svg",import.meta.url).href;const se=u=>(W("data-v-ef5022e0"),u=u(),X(),u),oe=se(()=>c("img",{alt:"",class:"back-img",src:ee},null,-1)),te={class:"content"},ae={class:"language-div"},re={class:"content-input"},le={class:"title"},ne={class:"content-button"},ce={class:"oss-register-doc"},ie={__name:"LoginPage",setup(u){const{t:r,locale:d}=R(),S=M(),K=L(),g=O(),k=A(),o=b({region:"",accessKeyId:"",accessKeySecret:"",bucket:""}),h=b({region:[{required:!0,message:r("login.form.region.verify"),trigger:"blur"}],accessKeyId:[{required:!0,message:r("login.form.accessKeyId.verify"),trigger:"blur"}],accessKeySecret:[{required:!0,message:r("login.form.accessKeySecret.verify"),trigger:"blur"}],bucket:[{required:!0,message:r("login.form.bucket.verify"),trigger:"blur"}]}),E=async()=>{window.open("https://gitee.com/password-x/password-x/wikis/%E9%98%BF%E9%87%8C%E4%BA%91%E8%B4%A6%E5%8F%B7%E6%93%8D%E4%BD%9C%E6%8C%87%E5%BC%95")},w=async s=>{await s.validate(e=>{e&&$(o).then(a=>{V(a)}).catch(a=>{C(a)})})},V=s=>{J.commit("setOss",s);let e=T(),a=H(e,JSON.stringify(o));localStorage.setItem("ossForm",a),I.success(r("login.form.successMessage")),K.push("/")},C=s=>{console.error(s);let e=s.code;s.code==="RequestError"?e=r("login.form.error.RequestError"):s.code==="InvalidAccessKeyId"?e=r("login.form.error.InvalidAccessKeyId"):s.code==="SignatureDoesNotMatch"?e=r("login.form.error.SignatureDoesNotMatch"):s.code==="AccessDenied"?e=r("login.form.error.AccessDenied"):e=s.code,I({type:"error",title:r("login.form.failMessage"),message:e})},y=s=>{d.value=s,_("language",s)},F=()=>{let s=v("language");s?y(s):navigator.language.toLowerCase()!=="zh-cn"&&(d.value="en-us",_("language","en-us"));let e=v("darkMode");if(e)S.value=e;else{let a=window.matchMedia("(prefers-color-scheme: dark)");a&&a.matches&&(S.value=!0,_("darkMode",!0))}},q=()=>{o.region=g.query.region||"",o.accessKeyId=g.query.accessKeyId||"",o.accessKeySecret=g.query.accessKeySecret||"",o.bucket=g.query.bucket||""};return F(),q(),(s,e)=>{const a=j,m=Y,f=Z,B=G,D=Q;return N(),U(P,null,[oe,c("div",te,[c("div",ae,[t(a,{type:p(d)==="zh-cn"?"primary":"default",onClick:e[0]||(e[0]=l=>y("zh-cn")),underline:!1},{default:n(()=>[i("简体中文 ")]),_:1},8,["type"]),i(" / "),t(a,{type:p(d)==="en-us"?"primary":"default",onClick:e[1]||(e[1]=l=>y("en-us")),underline:!1},{default:n(()=>[i("English ")]),_:1},8,["type"])]),c("div",re,[c("div",le,z(p(r)("login.form.title")),1),t(B,{ref_key:"ruleFormRef",ref:k,rules:h,model:o},{default:n(()=>[t(f,{prop:"region"},{default:n(()=>[t(m,{modelValue:o.region,"onUpdate:modelValue":e[2]||(e[2]=l=>o.region=l),clearable:"",placeholder:"OSS region"},null,8,["modelValue"])]),_:1}),t(f,{prop:"accessKeyId"},{default:n(()=>[t(m,{modelValue:o.accessKeyId,"onUpdate:modelValue":e[3]||(e[3]=l=>o.accessKeyId=l),clearable:"",placeholder:"OSS accessKeyId"},null,8,["modelValue"])]),_:1}),t(f,{prop:"accessKeySecret"},{default:n(()=>[t(m,{modelValue:o.accessKeySecret,"onUpdate:modelValue":e[4]||(e[4]=l=>o.accessKeySecret=l),clearable:"",placeholder:"OSS accessKeySecret"},null,8,["modelValue"])]),_:1}),t(f,{prop:"bucket"},{default:n(()=>[t(m,{modelValue:o.bucket,"onUpdate:modelValue":e[5]||(e[5]=l=>o.bucket=l),clearable:"",placeholder:"OSS bucket"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"]),c("div",ne,[t(D,{type:"primary",style:{width:"100%"},onClick:e[6]||(e[6]=l=>w(p(k)))},{default:n(()=>[i("登录")]),_:1})]),c("div",ce,[t(a,{type:"primary",onClick:E},{default:n(()=>[i("阿里云OSS注册指引")]),_:1})])])])],64)}}},ge=x(ie,[["__scopeId","data-v-ef5022e0"]]);export{ge as default};
