import{E as ze}from"./exceljs-6b62d6db.js";import{F as Oe}from"./file-saver-38a5c18e.js";import{h as ke}from"./moment-fbc5633a.js";import{u as de}from"./vue-i18n-63343f04.js";import{E as ne,a as Be,b as fe,c as we,d as Te,e as Ct,f as Vt,g as Me,h as qe,i as Ye,j as Ge,k as Qe,l as et,m as Fe,n as tt,o as We,p as je,q as Tt,r as Mt,s as lt,t as Ft,u as Et,v as Dt,w as Rt,x as At,y as Ut,z as It,A as Nt,B as zt,C as Lt,D as $t}from"./element-plus-58652eb8.js";import{r as T,o as v,c as H,X as j,b as at,u as e,O as Y,I as D,ac as Ee,J as l,a as $,S as t,P as C,Q as S,A as ce,R as X,aj as oe,ak as st,w as Ke,_ as ot,ar as Bt,as as Yt}from"./@vue-054857f9.js";import{m as Gt}from"./js-md5-11f5a111.js";import{h as De}from"./@vueuse-1b6f7037.js";import{d as pe,s as te,g as xe,a as Xe,l as Le,u as Wt,b as _e,e as Pe,c as $e,r as jt,_ as nt,p as rt,f as dt,i as Ht}from"./index-f44d34d7.js";import{u as Jt}from"./vue-router-e948df84.js";import{_ as Ot}from"./backImg-a3b16eec.js";import{m as Kt,u as Xt,n as Ze,o as Zt,v as qt,h as Qt,r as el}from"./@element-plus-7b906f9a.js";import"./ali-oss-21f5c855.js";import"./@intlify-9ddbe450.js";import"./lodash-es-f5bdeb48.js";import"./async-validator-dee29e8b.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./escape-html-cf2a8097.js";import"./normalize-wheel-es-ed76fb12.js";import"./crypto-js-d55471a7.js";import"./vuex-90336bc0.js";import"./cos-js-sdk-v5-31c61e27.js";const tl={__name:"ImportExport",emits:["importComplete"],setup(Z,{expose:b,emit:K}){const{t:k}=de(),M=K,n=T(),g=T(),p=T(0),P=r=>{n.value.click(),g.value=r},V=async()=>{if(n.value.files===0)return;p.value=Date.now();const r=new ze.Workbook;r.xlsx.load(n.value.files[0]).then(()=>{r.eachSheet(function(o){if(o.rowCount<2){ne.error(k("importExport.data.empty")),n.value.value="";return}let a=[];for(let d=2;d<=o.rowCount;d++){let c=o.getRow(d),F=s(c.getCell(1).value),N=s(c.getCell(2).value),w=s(c.getCell(3).value),x=s(c.getCell(4).value),U=s(c.getCell(5).value),E=s(c.getCell(6).value),J=s(c.getCell(7).value),z=s(c.getCell(8).value);F&&a.push({id:p.value++,name:F,address:N,userName:w,password:x,remark:E,label:_(U),insertTime:J,updateTime:z})}M("importComplete",a,g.value),n.value.value=""})}).catch(o=>{ne.error(o),n.value.value=""})},s=r=>r?typeof r=="object"?r instanceof Date?ke(r).format("YYYY-MM-DD HH:mm:ss"):r.text:r.toString():"",_=r=>{if(!r)return"";let o=[],a=r.split("、");for(let d=0;d<a.length;d++){let c=y(g.value,a[d],"");if(c)o.push(c);else{let F=[];R(g.value,a[d].split(">"),0,F);for(let N=0;N<F.length;N++)o.push(F[N])}}return Array.from(new Set(o))},y=(r,o,a)=>{for(let d=0;d<r.length;d++){let c=a?a+">"+r[d].label:r[d].label;if(o===c)return r[d].id;if(r[d].children&&r[d].children.length>0)return y(r[d].children,o,c)}},R=(r,o,a,d)=>{if(!o[a])return;for(let F=0;F<r.length;F++)if(r[F].label===o[a])return o[a+1]||d.push(r[F].id),R(r[F].children,o,a+1,d);let c={id:p.value++,label:o[a],children:[]};r.push(c),o[a+1]||d.push(c.id),R(c.children,o,a+1,d)},A=async(r,o)=>{g.value=o;const a=new ze.Workbook,d=a.addWorksheet("sheet1");d.getCell("A1").value=k("password.name"),d.getCell("B1").value=k("password.address"),d.getCell("C1").value=k("password.userName"),d.getCell("D1").value=k("password.password"),d.getCell("E1").value=k("password.label"),d.getCell("F1").value=k("password.remark"),d.getCell("G1").value=k("password.insertTime"),d.getCell("H1").value=k("password.updateTime");for(let c=0;c<r.length;c++){let F=r[c].insertTime;F||(F=ke().format("YYYY-MM-DD HH:mm:ss")),d.getCell("A"+(c+2)).value=r[c].name,d.getCell("B"+(c+2)).value=r[c].address,d.getCell("C"+(c+2)).value=r[c].userName,d.getCell("D"+(c+2)).value=r[c].password,d.getCell("E"+(c+2)).value=W(r[c].label),d.getCell("F"+(c+2)).value=r[c].remark,d.getCell("G"+(c+2)).value=F,d.getCell("H"+(c+2)).value=r[c].updateTime}a.xlsx.writeBuffer().then(c=>{let F=new Blob([c],{type:"application/octet-stream"});Oe.saveAs(F,k("importExport.exportName")+"_"+ke().format("YYYY-MM-DD HH:mm:ss")+".xlsx")})},W=r=>{if(!r)return"";let o=[];return B(g.value,r,o,""),o.join("、")},B=(r,o,a,d)=>{for(let c=0;c<r.length;c++){let F=d?d+">"+r[c].label:r[c].label;o.includes(r[c].id)&&a.push(F),r[c].children&&r[c].children.length>0&&B(r[c].children,o,a,F)}};return b({importExcel:P,exportExcel:A,downloadExcelTemplate:()=>{const r=new ze.Workbook,o=r.addWorksheet("sheet1");o.getCell("A1").value=k("password.name"),o.getCell("B1").value=k("password.address"),o.getCell("C1").value=k("password.userName"),o.getCell("D1").value=k("password.password"),o.getCell("E1").value=k("password.label"),o.getCell("F1").value=k("password.remark"),o.getCell("G1").value=k("password.insertTime"),o.getCell("H1").value=k("password.updateTime"),r.xlsx.writeBuffer().then(a=>{let d=new Blob([a],{type:"application/octet-stream"});Oe.saveAs(d,k("importExport.importTemplateName")+".xlsx")})}}),(r,o)=>(v(),H("input",{type:"file",onChange:V,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ref_key:"fileUploadInput",ref:n,style:{display:"none"}},null,544))}},ll=["width","height"],He={__name:"GesturePassword",props:{size:{type:Number,default:300},count:{type:Number,default:3},showGesture:{type:Boolean,default:!0}},emits:["complete"],setup(Z,{expose:b,emit:K}){const k=De(),M=K,n=T();let g=Z;const p=j({padding:g.size*.18,background:k.value?"rgb(20,20,20)":"#fff",failColor:"#F56C6C",passColor:"#67C23A",point:{color:"#409EFF",size:g.size*.023,selected:{range:g.size*.07,color:"#409EFF",size:g.size*.023,madding:{color:"#409EFF",size:g.size*.07,lineWidth:1}}},line:{color:"#409EFF",width:2}}),P=T({}),V=T([]),s=T(!1),_=T("");let y=null;const R=()=>{p.background=k.value?"rgb(20,20,20)":"#fff",y=n.value.getContext("2d"),A()},A=()=>{y.fillStyle=p.background,y.fillRect(0,0,g.size,g.size),P.value=[];let w=(g.size-p.padding*2)/(g.count-1),x=1;for(let U=0;U<g.count;U++)for(let E=0;E<g.count;E++){let J=p.padding+E*w,z=p.padding+U*w,m=w/2,G={id:x,x:J,y:z,startX:J-m,endX:J+m,startY:z-m,endY:z+m,h:w,w};W(G),P.value[x]=G,x++}},W=w=>{let x=c(w);x&&g.showGesture&&(y.beginPath(),_.value==="fail"?y.strokeStyle=p.failColor:_.value==="pass"?y.strokeStyle=p.passColor:y.strokeStyle=p.point.selected.madding.color,y.lineWidth=p.point.selected.madding.lineWidth,y.arc(w.x,w.y,p.point.selected.madding.size,0,Math.PI*2),y.stroke()),y.beginPath(),x&&g.showGesture?(_.value==="fail"?y.fillStyle=p.failColor:_.value==="pass"?y.fillStyle=p.passColor:y.fillStyle=p.point.selected.madding.color,y.arc(w.x,w.y,p.point.selected.size,0,Math.PI*2)):(y.fillStyle=p.point.color,y.arc(w.x,w.y,p.point.size,0,Math.PI*2)),y.fill()},B=()=>{s.value=!0},h=()=>{if(!s.value)return;s.value=!1;let w=o();if(w){let x=Gt(w);M("complete",x)}A(),d()},r=w=>{_.value=w,A(),d(),w?setTimeout(()=>{_.value="",V.value=[],A()},500):(V.value=[],A())},o=()=>{let w="";for(let x=0;x<V.value.length;x++)w+=V.value[x].id+",";return w&&(w=w.substring(0,w.length-1)),w},a=w=>{let x=w.offsetX,U=w.offsetY;if(A(),d(x,U),!s.value)return;let E=F(x,U);!E||c(E)||(V.value.push(E),A(),d(x,U))},d=(w,x)=>{if(!g.showGesture)return;let U=F(w,x);if(U&&_.value===""&&(y.beginPath(),y.strokeStyle=p.point.selected.madding.color,y.lineWidth=p.point.selected.madding.lineWidth,y.arc(U.x,U.y,p.point.selected.madding.size,0,Math.PI*2),y.stroke()),V.value.length!==0){y.beginPath(),_.value==="fail"?y.strokeStyle=p.failColor:_.value==="pass"?y.strokeStyle=p.passColor:y.strokeStyle=p.line.color,y.lineWidth=p.line.width,y.lineCap="round",y.moveTo(V.value[0].x,V.value[0].y);for(let E=1;E<V.value.length;E++)y.lineTo(V.value[E].x,V.value[E].y);s.value&&w&&x&&_.value===""&&y.lineTo(w,x),y.stroke()}},c=w=>{for(let x=0;x<V.value.length;x++)if(w.id===V.value[x].id)return!0;return!1},F=(w,x)=>{for(let U in P.value){let E=P.value[U];if(w>E.startX+p.point.selected.range&&w<E.endX-p.point.selected.range&&x>E.startY+p.point.selected.range&&x<E.endY-p.point.selected.range)return E}},N=w=>{let x=w.touches[0].clientX-n.value.offsetLeft,U=w.touches[0].clientY-n.value.offsetTop;a({offsetX:x,offsetY:U})};return at(()=>{R()}),b({setVerifyStatus:r}),(w,x)=>e(g).size?(v(),H("canvas",{key:0,width:e(g).size,height:e(g).size,ref_key:"canvasRef",ref:n,onMousedown:B,onMouseup:h,onMousemove:x[0]||(x[0]=U=>a(U)),onMouseleave:h,onTouchstart:B,onTouchend:h,onTouchmove:N},null,40,ll)):Y("",!0)}},al={style:{"text-align":"center"}},sl={class:"dialog-footer"},ol={__name:"DeleteAccount",emits:["deleteAccount"],setup(Z,{expose:b,emit:K}){const{t:k}=de(),M=K,n=T(),g=j({deleteAccount:!1}),p=T(""),P=T(""),V=()=>{let R=pe(P.value,te.state.verifyCode);if(R&&R==="password-x"){p.value==="gesture"&&n.value.setVerifyStatus("pass");let A=localStorage.getItem("databaseForm"),W=pe(xe(),A);if(JSON.parse(W).keyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){ne.error("演示账号不能注销");return}Xe("password.json"),Xe("labelTree.json"),localStorage.removeItem("systemConfig"),ne.success(k("systemSetting.deleteAccount.success")),M("deleteAccount")}else p.value==="common"?ne.error(k("systemSetting.deleteAccount.mainPasswordError")):n.value.setVerifyStatus("fail")},s=()=>{p.value=te.state.mainPasswordType,g.deleteAccount=!0},_=R=>{P.value=R,V()},y=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){y.value=document.documentElement.clientWidth<728}),b({showDeleteAccount:s}),(R,A)=>{const W=Be,B=He,h=fe,r=we,o=Te;return v(),D(o,{fullscreen:e(y),modelValue:e(g).deleteAccount,"onUpdate:modelValue":A[1]||(A[1]=a=>e(g).deleteAccount=a),title:e(k)("systemSetting.deleteAccount"),width:"400px"},Ee({default:l(()=>[t(W,{type:"error",closable:!1},{default:l(()=>[C(S(e(k)("systemSetting.deleteAccount.text")),1)]),_:1}),$("div",al,[e(p)==="gesture"?(v(),D(B,{key:0,ref_key:"gesturePasswordRef",ref:n,onComplete:_},null,512)):Y("",!0),e(p)==="common"?(v(),D(h,{key:1,modelValue:e(P),"onUpdate:modelValue":A[0]||(A[0]=a=>ce(P)?P.value=a:null),style:{"margin-top":"20px"}},null,8,["modelValue"])):Y("",!0)])]),_:2},[e(p)==="common"?{name:"footer",fn:l(()=>[$("span",sl,[t(r,{type:"danger",onClick:V},{default:l(()=>[C(S(e(k)("systemSetting.deleteAccount.affirm")),1)]),_:1})])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},nl={style:{"text-align":"center"}},rl={class:"dialog-footer"},dl={__name:"SystemSetting",emits:["updateMainPassword","deleteAccount","systemChangeChange"],setup(Z,{expose:b,emit:K}){const k=Jt(),M=De(),{t:n,locale:g}=de(),p=K,P=T(),V=j({setting:!1}),s=j(Le()),_=j([{key:"zh-cn",label:"简体中文"},{key:"en-us",label:"English"}]),y=j([{key:"insertTimeDesc",label:n("systemSetting.sort.insertTimeDesc")},{key:"insertTimeAsc",label:n("systemSetting.sort.insertTimeAsc")},{key:"updateTimeDesc",label:n("systemSetting.sort.updateTimeDesc")},{key:"updateTimeAsc",label:n("systemSetting.sort.updateTimeAsc")},{key:"nameAsc",label:n("systemSetting.sort.nameAsc")},{key:"nameDesc",label:n("systemSetting.sort.nameDesc")},{key:"strengthDesc",label:n("systemSetting.sort.strengthAsc")},{key:"strengthAsc",label:n("systemSetting.sort.strengthDesc")}]),R=j([{key:!1,label:n("systemSetting.topic.light")},{key:!0,label:n("systemSetting.topic.dark")}]),A=j([{key:!0,label:n("systemSetting.cacheMainPassword.enable")},{key:!1,label:n("systemSetting.cacheMainPassword.disabled")}]),W=j([{key:!0,label:n("systemSetting.showAddTime.enable")},{key:!1,label:n("systemSetting.showAddTime.disabled")}]),B=j([{key:!0,label:n("systemSetting.showUpTime.enable")},{key:!1,label:n("systemSetting.showUpTime.disabled")}]),h=j([{key:!0,label:n("systemSetting.showLabel.enable")},{key:!1,label:n("systemSetting.showLabel.disabled")}]),r=j([{key:!0,label:n("mainPasswordSetting.verify.showGesture.enable")},{key:!1,label:n("mainPasswordSetting.verify.showGesture.disabled")}]),o=j([{key:!0,label:n("systemSetting.cacheDatabaseForm.enable")},{key:!1,label:n("systemSetting.cacheDatabaseForm.disabled")}]),a=j([{key:!0,label:n("passwordForm.autoGeneratePassword.enable")},{key:!1,label:n("passwordForm.autoGeneratePassword.disabled")}]),d=j([{key:!0,label:n("systemSetting.showPasswordStrength.enable")},{key:!1,label:n("systemSetting.showPasswordStrength.disabled")}]);let c=null;const F=()=>{let z=Le();for(let m in z)s[m]=z[m];s.language!==g.value&&(s.language=g.value),c=JSON.stringify(s),V.setting=!0},N=()=>{V.setting=!1},w=()=>{let z=s.defaultPasswordRule;if(!z.number&&!z.symbol&&!z.lowercase&&!z.uppercase){ne.error(n("systemSetting.passwordRuleVerify"));return}Wt(s);let m=JSON.parse(c);s.cacheMainPassword!==m.cacheMainPassword&&s.cacheMainPassword===!1&&(localStorage.removeItem("mainPasswordCiphertext"),console.log("删除主密码缓存")),s.cacheDatabaseForm!==m.cacheDatabaseForm&&s.cacheDatabaseForm===!1&&(localStorage.removeItem("databaseForm"),console.log("删除自动登录信息")),s.language!==g.value&&(g.value=s.language,console.log("系统语言设置为：",s.language)),M.value!==s.darkMode&&(M.value=s.darkMode,console.log("暗黑模式设置为：",s.darkMode)),s.sortRule!==m.sortRule&&(p("systemChangeChange","sortChange",s.sortRule),console.log("排序规则设置为：",s.sortRule)),s.showPasswordStrength!==m.showPasswordStrength&&(p("systemChangeChange","showPasswordStrength",s.showPasswordStrength),console.log("是否显示密码强度设置为：",s.showPasswordStrength)),V.setting=!1},x=()=>{localStorage.removeItem("databaseForm"),localStorage.removeItem("mainPasswordCiphertext"),te.commit("delDatabase"),te.commit("delDatabaseForm"),te.commit("delVerifyCode"),k.push("/login")},U=()=>{V.setting=!1,p("updateMainPassword")},E=()=>{V.setting=!1,P.value.showDeleteAccount()},J=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){J.value=document.documentElement.clientWidth<728}),b({logout:x,openSystemSetting:F,showUpdateMainPassword:U,settingForm:s}),(z,m)=>{const G=Ct,Q=Vt,q=Me,ge=qe,le=Ye,be=fe,ye=Ge,ee=Qe,ae=we,Re=et,Ae=Fe,Ue=Be,Ie=Te,Ce=ol;return v(),H(X,null,[t(Ie,{fullscreen:e(J),modelValue:e(V).setting,"onUpdate:modelValue":m[16]||(m[16]=u=>e(V).setting=u),title:e(n)("systemSetting.title"),width:"600px"},{footer:l(()=>[$("span",rl,[t(ae,{plain:"",onClick:N},{default:l(()=>[C(S(e(n)("systemSetting.close")),1)]),_:1}),t(ae,{type:"primary",plain:"",onClick:w},{default:l(()=>[C(S(e(n)("systemSetting.save")),1)]),_:1})])]),default:l(()=>[t(Ae,{model:e(s),"label-width":"120px"},{default:l(()=>[t(Re,{"tab-position":"left",style:{height:"350px"}},{default:l(()=>[t(ee,{label:"常规"},{default:l(()=>[t(q,{label:e(n)("systemSetting.language")},{default:l(()=>[t(Q,{modelValue:e(s).language,"onUpdate:modelValue":m[0]||(m[0]=u=>e(s).language=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(_),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(n)("systemSetting.sort")},{default:l(()=>[t(Q,{modelValue:e(s).sortRule,"onUpdate:modelValue":m[1]||(m[1]=u=>e(s).sortRule=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(y),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(n)("passwordForm.autoGeneratePassword")},{default:l(()=>[t(Q,{modelValue:e(s).autoGeneratePassword,"onUpdate:modelValue":m[2]||(m[2]=u=>e(s).autoGeneratePassword=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(a),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(n)("systemSetting.defaultPasswordRule")},{default:l(()=>[t(ye,{style:{"margin-top":"15px"}},{default:l(()=>[t(le,{span:12},{default:l(()=>[t(ge,{size:"small",modelValue:e(s).defaultPasswordRule.uppercase,"onUpdate:modelValue":m[3]||(m[3]=u=>e(s).defaultPasswordRule.uppercase=u),label:e(n)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(le,{span:12},{default:l(()=>[t(ge,{size:"small",modelValue:e(s).defaultPasswordRule.lowercase,"onUpdate:modelValue":m[4]||(m[4]=u=>e(s).defaultPasswordRule.lowercase=u),label:e(n)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(le,{span:12},{default:l(()=>[t(ge,{size:"small",modelValue:e(s).defaultPasswordRule.number,"onUpdate:modelValue":m[5]||(m[5]=u=>e(s).defaultPasswordRule.number=u),label:e(n)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(le,{span:12},{default:l(()=>[t(ge,{size:"small",modelValue:e(s).defaultPasswordRule.symbol,"onUpdate:modelValue":m[6]||(m[6]=u=>e(s).defaultPasswordRule.symbol=u),label:e(n)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1}),t(le,{span:24},{default:l(()=>[$("div",null,[t(be,{size:"small",style:{position:"relative",top:"3px"},modelValue:e(s).defaultPasswordRule.length,"onUpdate:modelValue":m[7]||(m[7]=u=>e(s).defaultPasswordRule.length=u)},{prepend:l(()=>[C(S(e(n)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["label"])]),_:1}),t(ee,{label:"个性化"},{default:l(()=>[t(q,{label:e(n)("systemSetting.topic")},{default:l(()=>[t(Q,{modelValue:e(s).darkMode,"onUpdate:modelValue":m[8]||(m[8]=u=>e(s).darkMode=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(R),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(n)("systemSetting.showPasswordStrength")},{default:l(()=>[t(Q,{modelValue:e(s).showPasswordStrength,"onUpdate:modelValue":m[9]||(m[9]=u=>e(s).showPasswordStrength=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(d),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(n)("systemSetting.showAddTime")},{default:l(()=>[t(Q,{modelValue:e(s).showAddTime,"onUpdate:modelValue":m[10]||(m[10]=u=>e(s).showAddTime=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(W),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(n)("systemSetting.showUpTime")},{default:l(()=>[t(Q,{modelValue:e(s).showUpTime,"onUpdate:modelValue":m[11]||(m[11]=u=>e(s).showUpTime=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(B),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(n)("systemSetting.showLabel")},{default:l(()=>[t(Q,{modelValue:e(s).showLabel,"onUpdate:modelValue":m[12]||(m[12]=u=>e(s).showLabel=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(h),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),t(ee,{label:"安全"},{default:l(()=>[t(q,{label:e(n)("systemSetting.cacheMainPassword")},{default:l(()=>[t(Q,{modelValue:e(s).cacheMainPassword,"onUpdate:modelValue":m[13]||(m[13]=u=>e(s).cacheMainPassword=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(A),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(n)("systemSetting.cacheDatabaseForm")},{default:l(()=>[t(Q,{modelValue:e(s).cacheDatabaseForm,"onUpdate:modelValue":m[14]||(m[14]=u=>e(s).cacheDatabaseForm=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(o),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(n)("mainPasswordSetting.verify.showGesture")},{default:l(()=>[t(Q,{modelValue:e(s).verifyShowGesture,"onUpdate:modelValue":m[15]||(m[15]=u=>e(s).verifyShowGesture=u)},{default:l(()=>[(v(!0),H(X,null,oe(e(r),u=>(v(),D(G,{key:u.key,label:u.label,value:u.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),t(ee,{label:"其他"},{default:l(()=>[$("div",nl,[t(ae,{plain:"",onClick:U},{default:l(()=>[C(S(e(n)("systemSetting.updateMainPassword")),1)]),_:1}),t(ae,{plain:"",type:"danger",onClick:E},{default:l(()=>[C(S(e(n)("systemSetting.deleteAccount")),1)]),_:1}),t(ae,{type:"warning",plain:"",onClick:x},{default:l(()=>[C(S(e(n)("systemSetting.logout")),1)]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"]),t(Ue,{style:{"margin-top":"20px"},type:"warning"},{default:l(()=>[C(S(e(n)("systemSetting.takeEffect")),1)]),_:1})]),_:1},8,["fullscreen","modelValue","title"]),t(Ce,{ref_key:"deleteAccountRef",ref:P,onDeleteAccount:x},null,512)],64)}}},il={style:{"text-align":"center"}},ul={class:"dialog-footer"},it={__name:"MainPasswordVerify",emits:["verifyPass"],setup(Z,{expose:b,emit:K}){const{t:k}=de(),M=K,n=T(),g=T(""),p=T(""),P=j({verifyMainPassword:!1}),V=h=>{g.value=h,s()},s=()=>{let h=pe(g.value,te.state.verifyCode);h&&h==="password-x"?(p.value==="gesture"&&n.value.setVerifyStatus("pass"),M("verifyPass",g.value),y(g.value),g.value="",P.verifyMainPassword=!1):p.value==="common"?ne.error(k("mainPasswordVerify.form.verify")):n.value.setVerifyStatus("fail")},_=()=>{localStorage.removeItem("mainPasswordCiphertext")},y=h=>{if(_e("cacheMainPassword")===!1)return;let o=xe(),a=Pe(o,h);localStorage.setItem("mainPasswordCiphertext",a)},R=()=>{if(_e("cacheMainPassword")===!1)return null;let r=localStorage.getItem("mainPasswordCiphertext");if(!r)return null;let o=xe(),a=pe(o,r);return a||null},A=()=>_e("verifyShowGesture")!==!1,W=(h=!0)=>{if(p.value=te.state.mainPasswordType,!h){P.verifyMainPassword=!0;return}let r=R();if(!r){P.verifyMainPassword=!0;return}let o=pe(r,te.state.verifyCode);o&&o==="password-x"?M("verifyPass",r):P.verifyMainPassword=!0},B=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){B.value=document.documentElement.clientWidth<728}),b({verifyMainPassword:W,delLocalMainPassword:_}),(h,r)=>{const o=He,a=fe,d=Me,c=Fe,F=we,N=Te;return v(),D(N,{fullscreen:e(B),modelValue:e(P).verifyMainPassword,"onUpdate:modelValue":r[1]||(r[1]=w=>e(P).verifyMainPassword=w),title:e(k)("mainPasswordVerify.form.title"),width:"400px"},Ee({default:l(()=>[$("div",il,[e(p)==="gesture"&&e(P).verifyMainPassword?(v(),D(o,{key:0,"show-gesture":A(),ref_key:"gesturePasswordRef",ref:n,onComplete:V},null,8,["show-gesture"])):Y("",!0),e(p)==="common"&&e(P).verifyMainPassword?(v(),D(c,{key:1,style:{padding:"10px"}},{default:l(()=>[t(d,null,{default:l(()=>[t(a,{modelValue:e(g),"onUpdate:modelValue":r[0]||(r[0]=w=>ce(g)?g.value=w:null),placeholder:e(k)("mainPasswordVerify.form.mainPassword"),type:"password",onKeyup:st(s,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1})]),_:1})):Y("",!0)])]),_:2},[e(p)==="common"?{name:"footer",fn:l(()=>[$("span",ul,[t(F,{type:"primary",disabled:!e(g),onClick:s},{default:l(()=>[C(S(e(k)("mainPasswordVerify.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},ml={class:"dialog-footer"},cl={__name:"MainPasswordSetting",emits:["mainPasswordChange"],setup(Z,{expose:b,emit:K}){const{t:k}=de(),M=K,n=T(),g=T(),p=T("gesture"),P=T(""),V=T(""),s=j({mainPassword:!1}),_=T(""),y=r=>{_.value==="setting"?(P.value=r,_.value="affirm",g.value.setVerifyStatus("")):_.value==="affirm"&&(V.value=r,R())},R=()=>{if(P.value!==V.value){ne.error(k("mainPasswordSetting.form.passwordsDiff"));return}let r=localStorage.getItem("databaseForm"),o=pe(xe(),r);if(JSON.parse(o).accessKeyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){ne.error("演示账号不能修改主密码");return}p.value==="gesture"?te.commit("setMainPasswordType","gesture"):te.commit("setMainPasswordType","common"),M("mainPasswordChange",P.value,p.value);let d=_e("cacheMainPassword");if(d||d==null){let c=xe(),F=Pe(c,P.value);localStorage.setItem("mainPasswordCiphertext",F)}P.value="",V.value="",s.mainPassword=!1},A=()=>{_.value="setting",s.mainPassword=!0},W=()=>{n.value.verifyMainPassword(!1)},B=()=>{p.value==="gesture"&&(_.value="setting"),P.value="",V.value=""},h=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){h.value=document.documentElement.clientWidth<728}),b({settingMainPassword:A,updateMainPassword:W}),(r,o)=>{const a=Be,d=tt,c=He,F=We,N=Qe,w=fe,x=Me,U=Fe,E=et,J=we,z=Te,m=it;return v(),H(X,null,[t(z,{fullscreen:e(h),modelValue:e(s).mainPassword,"onUpdate:modelValue":o[4]||(o[4]=G=>e(s).mainPassword=G),title:e(k)("mainPasswordSetting.form.setMainPassword"),width:"470px"},Ee({default:l(()=>[t(a,{type:"error",style:{position:"relative",top:"-10px"},closable:!1},{default:l(()=>[C(S(e(k)("mainPasswordSetting.forget.message")),1)]),_:1}),t(E,{modelValue:e(p),"onUpdate:modelValue":o[3]||(o[3]=G=>ce(p)?p.value=G:null),style:{"margin-top":"10px"},type:"card",onTabChange:B},{default:l(()=>[t(N,{label:e(k)("mainPasswordSetting.passwordType.gesture"),name:"gesture",style:{"text-align":"center"}},{default:l(()=>[$("div",null,[e(_)==="setting"?(v(),D(d,{key:0},{default:l(()=>[C(S(e(k)("mainPasswordSetting.gesture.first")),1)]),_:1})):Y("",!0),e(_)==="affirm"?(v(),D(d,{key:1},{default:l(()=>[C(S(e(k)("mainPasswordSetting.gesture.affirm")),1)]),_:1})):Y("",!0)]),e(s).mainPassword&&e(p)==="gesture"?(v(),D(c,{key:0,ref_key:"gesturePasswordRef",ref:g,onComplete:y},null,512)):Y("",!0),$("div",null,[t(F,{underline:!1,style:{position:"relative",top:"-2px"},type:"primary",onClick:o[0]||(o[0]=G=>_.value="setting")},{default:l(()=>[C(S(e(k)("mainPasswordSetting.gesture.reset")),1)]),_:1})])]),_:1},8,["label"]),t(N,{label:e(k)("mainPasswordSetting.passwordType.common"),name:"common",style:{"text-align":"center"}},{default:l(()=>[t(U,{inline:!0,"label-width":"100px",style:{"margin-top":"20px"}},{default:l(()=>[t(x,{label:e(k)("mainPasswordSetting.form.newMainPassword")},{default:l(()=>[t(w,{type:"password",modelValue:e(P),"onUpdate:modelValue":o[1]||(o[1]=G=>ce(P)?P.value=G:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"]),t(x,{label:e(k)("mainPasswordSetting.form.newMainPasswordAffirm")},{default:l(()=>[t(w,{type:"password",modelValue:e(V),"onUpdate:modelValue":o[2]||(o[2]=G=>ce(V)?V.value=G:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:2},[e(p)==="common"?{name:"footer",fn:l(()=>[$("span",ml,[t(J,{type:"primary",disabled:!e(P),onClick:R},{default:l(()=>[C(S(e(k)("mainPasswordSetting.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"]),t(m,{ref_key:"mainPasswordVerifyRef",ref:n,onVerifyPass:A},null,512)],64)}}},pl={class:"dialog-footer"},fl={__name:"PasswordForm",props:{labelTree:Array},emits:["addPassword","updatePassword"],setup(Z,{expose:b,emit:K}){const k=K,{t:M}=de(),n=T(),g=j({password:!1}),p=T(""),P=j({uppercase:"ABCDEFGHJKLMNPQRSTUVWXYZ",lowercase:"abcdefghjkmnpqrstuvwxyz",number:"0123456789",symbol:"~!@#$^&*()_+.,;"}),V=()=>({id:0,name:"",address:"",userName:"",password:"",remark:"",label:"",insertTime:"",updateTime:""}),s=j(V()),_=j({length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}),y=j({name:[{required:!0,message:M("passwordForm.form.name.verify"),trigger:"blur"}]}),R=()=>{if(!_.number&&!_.symbol&&!_.lowercase&&!_.uppercase){ne.error(M("systemSetting.passwordRuleVerify"));return}let o=[];_.lowercase&&o.push(P.lowercase),_.uppercase&&o.push(P.uppercase),_.symbol&&o.push(P.symbol),_.number&&o.push(P.number),s.password=jt(o,_.length)},A=async o=>{await o.validate(a=>{a&&(g.password=!1,p.value==="add"?(s.id=Date.now(),s.insertTime=ke().format("YYYY-MM-DD HH:mm:ss"),k("addPassword",JSON.parse(JSON.stringify(s)))):(s.updateTime=ke().format("YYYY-MM-DD HH:mm:ss"),k("updatePassword",JSON.parse(JSON.stringify(s)))))})},W=()=>{let o=_e("defaultPasswordRule");if(o)for(let a in o)_[a]=o[a]},B=()=>{W();let o=V();for(let d in o)s[d]=o[d];_e("autoGeneratePassword")&&R(),p.value="add",g.password=!0},h=o=>{W();for(let a in s)s[a]=o[a];p.value="update",g.password=!0},r=()=>document.documentElement.clientWidth;return b({showAddPassword:B,showUpdatePassword:h}),(o,a)=>{const d=fe,c=Me,F=we,N=Ye,w=Ge,x=qe,U=je,E=Tt,J=Fe,z=Mt;return v(),D(z,{modelValue:e(g).password,"onUpdate:modelValue":a[13]||(a[13]=m=>e(g).password=m),title:e(p)==="add"?e(M)("passwordForm.form.addPassword"):e(M)("passwordForm.form.editPassword"),size:"620px",direction:r()>768?"rtl":"btt"},{footer:l(()=>[$("span",pl,[t(F,{onClick:a[12]||(a[12]=m=>A(e(n))),type:"primary"},{default:l(()=>[C(S(e(M)("passwordForm.generateForm.save")),1)]),_:1})])]),default:l(()=>[t(J,{ref_key:"passwordFormRef",ref:n,model:e(s),rules:e(y),"label-width":"70px",style:{"padding-right":"30px"}},{default:l(()=>[t(c,{label:e(M)("password.name"),prop:"name"},{default:l(()=>[t(d,{modelValue:e(s).name,"onUpdate:modelValue":a[0]||(a[0]=m=>e(s).name=m),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(c,{label:e(M)("password.address")},{default:l(()=>[t(d,{modelValue:e(s).address,"onUpdate:modelValue":a[1]||(a[1]=m=>e(s).address=m),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(c,{label:e(M)("password.userName")},{default:l(()=>[t(d,{modelValue:e(s).userName,"onUpdate:modelValue":a[2]||(a[2]=m=>e(s).userName=m),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(c,{label:e(M)("password.password")},{default:l(()=>[t(U,{style:{width:"100%"}},{default:l(()=>[t(w,null,{default:l(()=>[t(N,null,{default:l(()=>[t(d,{modelValue:e(s).password,"onUpdate:modelValue":a[4]||(a[4]=m=>e(s).password=m),clearable:""},{append:l(()=>[t(F,{onClick:a[3]||(a[3]=m=>e($e)(e(s).password))},{default:l(()=>[C(S(e(M)("passwordForm.generateForm.password.copy")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(w,{style:{"margin-top":"15px"}},{default:l(()=>[t(N,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(_).uppercase,"onUpdate:modelValue":a[5]||(a[5]=m=>e(_).uppercase=m),label:e(M)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(N,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(_).lowercase,"onUpdate:modelValue":a[6]||(a[6]=m=>e(_).lowercase=m),label:e(M)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(N,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(_).number,"onUpdate:modelValue":a[7]||(a[7]=m=>e(_).number=m),label:e(M)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(N,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(_).symbol,"onUpdate:modelValue":a[8]||(a[8]=m=>e(_).symbol=m),label:e(M)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1})]),_:1}),t(w,{style:{"margin-top":"15px"}},{default:l(()=>[t(N,{style:{"text-align":"center"}},{default:l(()=>[t(d,{modelValue:e(_).length,"onUpdate:modelValue":a[9]||(a[9]=m=>e(_).length=m),size:"small",style:{width:"120px"}},{prepend:l(()=>[C(S(e(M)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"]),t(F,{plain:"",size:"small",style:{position:"relative",top:"-5px","margin-left":"10px"},type:"success",onClick:R},{default:l(()=>[C(S(e(M)("passwordForm.generateForm.randomPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["label"]),t(c,{label:e(M)("password.label")},{default:l(()=>[t(E,{modelValue:e(s).label,"onUpdate:modelValue":a[10]||(a[10]=m=>e(s).label=m),"value-key":"id",data:Z.labelTree,"check-strictly":"",multiple:"","default-expand-all":"",placeholder:e(M)("password.label.placeholder"),filterable:""},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),t(c,{label:e(M)("password.remark")},{default:l(()=>[t(d,{type:"textarea",placeholder:e(M)("passwordForm.generateForm.remark"),rows:4,modelValue:e(s).remark,"onUpdate:modelValue":a[11]||(a[11]=m=>e(s).remark=m)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","direction"])}}};const wl={class:"label-tree-node"},gl=["onClick","onBlur"],_l={class:"label-tree-node-menu"},bl={__name:"LabelTree",emits:["labelCheckChange","labelTreeChange"],setup(Z,{expose:b,emit:K}){const k=De(),{t:M}=de(),n=K,g=T(),p=T([]),P=T([]),V=T(!1),s=()=>{let a=g.value.getCheckedNodes();n("labelCheckChange",a)},_=(a,d)=>a?d.label.includes(a):!0,y=a=>{const d={id:Date.now(),label:M("labelTree.addLabel"),children:[]};a.children||(a.children=[]),a.children.push(d)},R=(a,d)=>{const c=a.parent,F=c.data.children||c.data,N=F.findIndex(w=>w.id===d.id);F.splice(N,1)},A=a=>!a.edit,W=()=>{P.value.push({id:Date.now(),label:M("labelTree.firstAddLabel"),children:[]})},B=()=>{V.value&&rt("labelTree.json",{labelTree:P.value})},h=a=>{P.value=a};Ke(p,a=>{g.value.filter(a)}),Ke(P,()=>{B(),n("labelTreeChange",P.value)},{deep:!0});const r=()=>{dt("labelTree.json").then(a=>{a&&a.labelTree?P.value=a.labelTree:P.value=[],V.value=!0}).catch(a=>{lt.error(a.code)})},o=()=>k.value;return r(),b({setLabelTree:h}),(a,d)=>{const c=fe,F=we,N=We,w=Ft,x=Et,U=je;return v(),D(U,{class:"body-card",style:ot({"background-color":o()?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.4)"})},{header:l(()=>[C(S(e(M)("labelTree.title")),1)]),default:l(()=>[t(c,{modelValue:e(p),"onUpdate:modelValue":d[0]||(d[0]=E=>ce(p)?p.value=E:null),clearable:"",placeholder:e(M)("labelTree.search.placeholder")},null,8,["modelValue","placeholder"]),t(x,{height:"35vh"},{default:l(()=>[t(w,{data:e(P),"show-checkbox":"",ref_key:"labelTreeRef",ref:g,draggable:"","node-key":"id",style:{"margin-top":"10px","background-color":"rgba(0,0,0,0)"},onCheck:s,"filter-node-method":_,"expand-on-click-node":!1,"allow-drag":A,"default-expand-all":""},{empty:l(()=>[t(F,{size:"small",type:"primary",plain:"",onClick:W},{default:l(()=>[C(S(e(M)("labelTree.firstAddLabel")),1)]),_:1})]),default:l(({node:E,data:J})=>[$("span",wl,[E.edit?Y("",!0):(v(),H("span",{key:0,onClick:z=>E.edit=!0,onBlur:z=>E.edit=!1},S(J.label),41,gl)),E.edit?(v(),D(c,{key:1,style:{width:"60%"},ref:E.id+"_input",size:"small",onBlur:z=>E.edit=!1,modelValue:J.label,"onUpdate:modelValue":z=>J.label=z},null,8,["onBlur","modelValue","onUpdate:modelValue"])):Y("",!0),$("span",_l,[t(N,{onClick:z=>y(J),type:"primary",underline:!1},{default:l(()=>[C(S(e(M)("labelTree.tree.add")),1)]),_:2},1032,["onClick"]),t(N,{onClick:z=>R(E,J),type:"danger",underline:!1,style:{"margin-left":"8px"}},{default:l(()=>[C(S(e(M)("labelTree.tree.remove")),1)]),_:2},1032,["onClick"])])])]),_:1},8,["data"])]),_:1})]),_:1},8,["style"])}}},yl=nt(bl,[["__scopeId","data-v-18737dd1"]]);const Se=Z=>(Bt("data-v-b5fb178d"),Z=Z(),Yt(),Z),vl=Se(()=>$("img",{alt:"",class:"back-img",src:Ot},null,-1)),hl={style:{display:"flex","justify-content":"space-between"}},kl={class:"hidden-xs-only"},Pl=Se(()=>$("br",null,null,-1)),xl={key:1},Sl={style:{display:"flex","justify-content":"end"},class:"password-title-right"},Cl=Se(()=>$("div",{class:"password-strength",style:{"background-color":"#67C23A"}},null,-1)),Vl=Se(()=>$("div",{class:"password-strength",style:{"background-color":"#E6A23C"}},null,-1)),Tl=Se(()=>$("div",{class:"password-strength",style:{"background-color":"#F56C6C"}},null,-1)),Ml={key:0},Fl={class:"password-text"},El={class:"pass-action-div"},Dl={__name:"IndexPage",setup(Z){const{t:b,locale:K}=de(),k=De(),M=T(),n=T(),g=T(),p=T(),P=T(),V=T(),s=T(),_=j({}),y=T(""),R=T(""),A=T(""),W=T(!1),B=T(""),h=T([]),r=T([]),o=T([]),a=T([]),d=async()=>{if(!y.value&&!o.value){r.value=h.value;return}let i=[];for(let f=0;f<h.value.length;f++){let L=h.value[f].name||"",O=h.value[f].userName||"",ie=h.value[f].address||"",ue=h.value[f].remark||"",me=h.value[f].password||"",Ne=!y.value||L.includes(y.value)||O.includes(y.value)||ie.includes(y.value)||ue.includes(y.value)||me.includes(y.value),ve=!1;if(o.value.length>0)for(let he=0;he<o.value.length;he++){let se=o.value[he];h.value[f].label&&h.value[f].label.includes(se.id)&&(ve=!0)}else ve=!0;Ne&&ve&&i.push(h.value[f])}r.value=i},c=()=>{M.value.showAddPassword()},F=i=>{M.value.showUpdatePassword(i)},N=i=>{h.value.unshift(i),ae(),d()},w=i=>{for(let f=0;f<h.value.length;f++)if(h.value[f].id===i.id){h.value[f]=i,ae(),d();break}},x=()=>{B.value=Pe(R.value,JSON.stringify(h.value)),W.value=!1,r.value=[],h.value=[],R.value="",g.value.delLocalMainPassword()},U=()=>{g.value.verifyMainPassword()},E=i=>{let f=b("password.name")+": "+i.name+`\r
`;i.address&&(f+=b("password.address")+": "+i.address+`\r
`),i.userName&&(f+=b("password.userName")+": "+i.userName+`\r
`),i.password&&(f+=b("password.password")+": "+i.password+`\r
`),i.remark&&(f+=i.remark+`\r
`),f=f.substring(0,f.length-2),$e(f)},J=i=>{for(let f=0;f<h.value.length;f++)if(h.value[f].id===i.id){h.value.splice(f,1),ae(),d(),ne.success(b("index.table.delete.success"));break}},z=i=>{R.value=i;let f=pe(i,B.value);h.value=JSON.parse(f),W.value=!0,d()},m=(i,f)=>{R.value=i,A.value=f,ae(),ne.success(b("index.mainPassword.changeSuccess"))},G=()=>{P.value.openSystemSetting()},Q=()=>{p.value.updateMainPassword()},q=(i,f)=>{_[i]=f,i==="sortChange"&&ge(f)},ge=i=>{i==="insertTimeDesc"?(n.value.sort("insertTime","descending"),ee("insertTime",-1)):i==="insertTimeAsc"?(n.value.sort("insertTime","ascending"),ee("insertTime",1)):i==="updateTimeDesc"?(n.value.sort("updateTime","descending"),ee("updateTime",-1)):i==="updateTimeAsc"?(n.value.sort("updateTime","ascending"),ee("updateTime",1)):i==="nameAsc"?(n.value.sort("name","ascending"),ee("name",1)):i==="nameDesc"?(n.value.sort("name","descending"),ee("name",-1)):i==="strengthDesc"?(n.value.sort("strength","descending"),ee("strength",-1)):i==="strengthAsc"&&(n.value.sort("strength","ascending"),ee("strength",1)),ae()},le=i=>{let f=0;return/[0-9]/.test(i)&&f++,/[a-z]/.test(i)&&f++,/[A-Z]/.test(i)&&f++,/[^0-9a-zA-Z_]/.test(i)&&f++,i.length<6&&f>2&&(f=2),f>3?3:f},be=(i,f)=>le(i.password)>le(f.password)?1:-1,ye=i=>{let f=0;for(let L=0;L<h.value.length;L++){if(!h.value[L].password)continue;let O=le(h.value[L].password);i===O&&f++}return f},ee=(i,f)=>{h.value.sort((L,O)=>i==="strength"?f>0?be(L,O):be(O,L):(L=L[i],O=O[i],L<O?f*-1:L>O?f*1:0))},ae=()=>{if(!W.value)return;B.value=Pe(R.value,JSON.stringify(h.value));let i=Pe(R.value,"password-x");te.commit("setVerifyCode",i),rt("password.json",{verifyValue:i,mainPasswordType:A.value,passwordCiphertext:B.value})},Re=()=>{dt("password.json").then(i=>{if(i.verifyValue){let f=i.verifyValue;A.value=i.mainPasswordType||"common",te.commit("setVerifyCode",f),te.commit("setMainPasswordType",A.value),B.value=i.passwordCiphertext,g.value.verifyMainPassword(!0)}else W.value=!0,p.value.settingMainPassword()}).catch(i=>{console.error(i),lt.error("error-1000："+i)})},Ae=i=>{o.value=i,d()},Ue=i=>{a.value=i},Ie=i=>{if(!i)return"";let f=[];return Ce(a.value,i,f),f},Ce=(i,f,L)=>{for(let O=0;O<i.length;O++)f.includes(i[O].id)&&L.push(i[O].label),i[O].children&&i[O].children.length>0&&Ce(i[O].children,f,L)},u=()=>{V.value.downloadExcelTemplate()},ut=()=>{V.value.importExcel(a.value)},mt=()=>{V.value.exportExcel(h.value,a.value)},ct=(i,f)=>{if(i.length!==0){for(let L=i.length-1;L>=0;L--)h.value.unshift(i[L]);s.value.setLabelTree(f),ae(),d()}},pt=()=>{P.value.logout()},ft=()=>k.value;return at(()=>{let i=Le();for(let f in i)_[f]=i[f];_.language&&_.language!==K.value&&(K.value=_.language),Re()}),(i,f)=>{const L=tt,O=fe,ie=we,ue=Dt,me=Rt,Ne=At,ve=Ut,he=It,se=Nt,Ve=We,wt=$t,gt=zt,_t=Lt,bt=je,Je=Ye,yt=yl,vt=Ge,ht=fl,kt=it,Pt=cl,xt=dl,St=tl;return v(),H(X,null,[vl,t(vt,{id:"passwordBody"},{default:l(()=>[t(Je,{xl:{span:16,offset:2},lg:{span:19},md:{span:19}},{default:l(()=>[t(bt,{class:"body-card",style:ot({"background-color":ft()?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.4)"})},{header:l(()=>[$("div",hl,[$("div",null,[$("div",kl,[e(h)?(v(),D(L,{key:0,class:"password-table-title"},{default:l(()=>[C(S(e(h).length)+" "+S(e(b)("index.title.passwordCount")),1)]),_:1})):Y("",!0),Pl,e(_).showPasswordStrength?(v(),H("div",xl,[t(L,{class:"password-table-strength"},{default:l(()=>[C(S(e(b)("index.title.strength"))+"（ ",1),t(L,{type:"success"},{default:l(()=>[C(S(e(b)("index.title.strength.strong")),1)]),_:1}),C(" : "+S(ye(3))+" ",1),t(L,{style:{"margin-left":"5px"},type:"warning"},{default:l(()=>[C(S(e(b)("index.title.strength.medium")),1)]),_:1}),C(" : "+S(ye(2))+" ",1),t(L,{style:{"margin-left":"5px"},type:"danger"},{default:l(()=>[C(S(e(b)("index.title.strength.weak")),1)]),_:1}),C(" : "+S(ye(1))+"） ",1)]),_:1})])):Y("",!0)])]),$("div",Sl,[$("div",null,[t(O,{modelValue:e(y),"onUpdate:modelValue":f[0]||(f[0]=I=>ce(y)?y.value=I:null),style:{"max-width":"300px"},clearable:"",placeholder:e(b)("index.title.search"),"prefix-icon":e(Kt),disabled:!e(R),onKeyup:st(d,["enter"])},null,8,["modelValue","placeholder","prefix-icon","disabled","onKeyup"])]),$("div",null,[t(ie,{disabled:!e(R)||!e(W),type:"primary",plain:"",onClick:f[1]||(f[1]=I=>c())},{default:l(()=>[C(S(e(b)("index.title.addPassword")),1)]),_:1},8,["disabled"])]),$("div",null,[e(R)?Y("",!0):(v(),D(ue,{key:0,content:e(b)("index.title.unlock"),effect:"dark",placement:"top"},{default:l(()=>[t(ie,{disabled:!e(B),icon:e(Xt),onClick:U},null,8,["disabled","icon"])]),_:1},8,["content"])),e(R)?(v(),D(ue,{key:1,content:e(b)("index.title.lock"),effect:"dark",placement:"top"},{default:l(()=>[t(ie,{icon:e(Ze),onClick:x},null,8,["icon"])]),_:1},8,["content"])):Y("",!0)]),t(ve,null,{dropdown:l(()=>[t(Ne,null,{default:l(()=>[t(me,{onClick:G},{default:l(()=>[C(S(e(b)("systemSetting.title")),1)]),_:1}),t(me,{divided:"",onClick:ut},{default:l(()=>[C(S(e(b)("index.title.importExport.import")),1)]),_:1}),t(me,{onClick:mt},{default:l(()=>[C(S(e(b)("index.title.importExport.export")),1)]),_:1}),t(me,{onClick:u},{default:l(()=>[C(S(e(b)("index.title.importExport.download")),1)]),_:1}),t(me,{divided:"",onClick:pt},{default:l(()=>[C(S(e(b)("index.title.logout")),1)]),_:1})]),_:1})]),default:l(()=>[t(ie,{icon:e(Zt)},null,8,["icon"])]),_:1})])])]),default:l(()=>[t(_t,{height:"calc(100vh - 150px)",style:{"background-color":"rgba(0,0,0,0)"},"header-row-style":{"background-color":"rgba(0,0,0,0)"},"header-cell-style":{"background-color":"rgba(0,0,0,0)"},"row-style":{"background-color":"rgba(0,0,0,0)"},"cell-style":{"background-color":"rgba(0,0,0,0)"},data:e(r),"highlight-current-row":"",ref_key:"tableRef",ref:n},{empty:l(()=>[t(he,{description:e(R)?e(b)("index.table.empty"):e(b)("index.table.lock")},Ee({default:l(()=>[t(ie,{onClick:U,plain:"",type:"primary"},{default:l(()=>[C(S(e(b)("index.title.unlock")),1)]),_:1})]),_:2},[e(R)?void 0:{name:"image",fn:l(()=>[t(e(Ze))]),key:"0"}]),1032,["description"])]),default:l(()=>[e(_).showPasswordStrength?(v(),D(se,{key:0,sortable:"","sort-method":be,prop:"strength",width:"30px"},{default:l(I=>[le(I.row.password)===3?(v(),D(ue,{key:0},{content:l(()=>[C(S(e(b)("index.title.strength")+"："+e(b)("index.title.strength.strong")),1)]),default:l(()=>[Cl]),_:1})):Y("",!0),le(I.row.password)===2?(v(),D(ue,{key:1},{content:l(()=>[C(S(e(b)("index.title.strength")+"："+e(b)("index.title.strength.medium")),1)]),default:l(()=>[Vl]),_:1})):Y("",!0),le(I.row.password)===1?(v(),D(ue,{key:2},{content:l(()=>[C(S(e(b)("index.title.strength")+"："+e(b)("index.title.strength.weak")),1)]),default:l(()=>[Tl]),_:1})):Y("",!0)]),_:1})):Y("",!0),t(se,{sortable:"",label:e(b)("password.name"),"min-width":"140px",prop:"name"},null,8,["label"]),t(se,{label:e(b)("password.address"),"min-width":"200px",prop:"address"},{default:l(I=>[e(Ht)(I.row.address)?(v(),D(Ve,{key:0,href:I.row.address,target:"_blank"},{default:l(()=>[C(S(I.row.address),1)]),_:2},1032,["href"])):(v(),D(L,{key:1},{default:l(()=>[C(S(I.row.address),1)]),_:2},1024))]),_:1},8,["label"]),t(se,{label:e(b)("password.userName"),"min-width":"120px",prop:"userName"},null,8,["label"]),t(se,{label:e(b)("password.password"),"min-width":"150px",prop:"password"},{default:l(I=>[I.row.password?(v(),H("div",Ml,[$("span",Fl,[I.row.show?Y("",!0):(v(),H(X,{key:0},[C("•••••••")],64)),I.row.show?(v(),H(X,{key:1},[C(S(I.row.password),1)],64)):Y("",!0)]),$("div",El,[I.row.show?Y("",!0):(v(),D(e(qt),{key:0,onClick:re=>I.row.show=!I.row.show},null,8,["onClick"])),I.row.show?(v(),D(e(Qt),{key:1,onClick:re=>I.row.show=!I.row.show},null,8,["onClick"])):Y("",!0),t(e(el),{onClick:re=>e($e)(I.row.password)},null,8,["onClick"])])])):Y("",!0)]),_:1},8,["label"]),e(_).showLabel!==!1?(v(),D(se,{key:1,label:e(b)("index.table.label"),"min-width":"130px",prop:"label"},{default:l(I=>[(v(!0),H(X,null,oe(Ie(I.row.label),re=>(v(),D(wt,{style:{margin:"3px"},key:re},{default:l(()=>[C(S(re),1)]),_:2},1024))),128))]),_:1},8,["label"])):Y("",!0),t(se,{label:e(b)("password.remark"),"min-width":"100px",prop:"remark"},null,8,["label"]),e(_).showAddTime?(v(),D(se,{key:2,sortable:"",label:e(b)("password.insertTime"),"min-width":"130px",prop:"insertTime"},null,8,["label"])):Y("",!0),e(_).showUpTime?(v(),D(se,{key:3,sortable:"",label:e(b)("password.updateTime"),"min-width":"130px",prop:"updateTime"},null,8,["label"])):Y("",!0),t(se,{"min-width":"140px",label:e(b)("index.table.operation")},{default:l(I=>[t(Ve,{type:"success",underline:!1,onClick:re=>E(I.row)},{default:l(()=>[C(S(e(b)("index.table.share")),1)]),_:2},1032,["onClick"]),t(Ve,{underline:!1,style:{"margin-left":"10px"},type:"primary",onClick:re=>F(I.row)},{default:l(()=>[C(S(e(b)("index.table.edit")),1)]),_:2},1032,["onClick"]),t(gt,{title:e(b)("index.table.operation.affirmDelete"),"confirm-button-text":e(b)("index.table.operation.affirm"),"cancel-button-text":e(b)("index.table.operation.cancel"),onConfirm:re=>J(I.row)},{reference:l(()=>[t(Ve,{style:{"margin-left":"10px"},underline:!1,type:"danger"},{default:l(()=>[C(S(e(b)("index.table.operation.delete")),1)]),_:1})]),_:2},1032,["title","confirm-button-text","cancel-button-text","onConfirm"])]),_:1},8,["label"])]),_:1},8,["header-row-style","header-cell-style","row-style","cell-style","data"])]),_:1},8,["style"])]),_:1}),t(Je,{xl:{span:4},lg:{span:5},md:{span:5},class:"hidden-sm-and-down",style:{"padding-left":"15px"}},{default:l(()=>[t(yt,{ref_key:"labelTreeRef",ref:s,onLabelCheckChange:Ae,onLabelTreeChange:Ue},null,512)]),_:1})]),_:1}),t(ht,{ref_key:"passwordFormRef",ref:M,labelTree:e(a),onAddPassword:N,onUpdatePassword:w},null,8,["labelTree"]),t(kt,{ref_key:"mainPasswordVerifyRef",ref:g,onVerifyPass:z},null,512),t(Pt,{ref_key:"mainPasswordSettingRef",ref:p,onMainPasswordChange:m},null,512),t(xt,{ref_key:"systemSettingRef",ref:P,onUpdateMainPassword:Q,onSystemChangeChange:q},null,512),t(St,{ref_key:"importExportRef",ref:V,labelTree:e(a),onImportComplete:ct},null,8,["labelTree"])],64)}}},la=nt(Dl,[["__scopeId","data-v-b5fb178d"]]);export{la as default};
