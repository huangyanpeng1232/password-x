import{E as De}from"./exceljs-6b62d6db.js";import{F as Ye}from"./file-saver-38a5c18e.js";import{h as be}from"./moment-fbc5633a.js";import{u as oe}from"./vue-i18n-63343f04.js";import{E as te,a as Ue,b as me,c as ce,d as ke,e as Ct,f as Vt,g as Pe,h as Je,i as Ie,j as Ne,k as Oe,l as Ke,m as xe,n as Xe,o as ze,p as Le,q as Tt,r as Mt,s as Ze,t as Ft,u as Et,v as Dt,w as Rt,x as At,y as Ut,z as It,A as Nt,B as zt,C as Lt,D as $t}from"./element-plus-58652eb8.js";import{r as T,o as _,c as W,X as Z,b as qe,u as e,O as B,I as R,ac as Se,J as l,a as L,S as t,P as C,Q as S,A as ie,R as O,aj as ee,ak as Qe,w as We,_ as et,ar as Bt,as as Gt}from"./@vue-054857f9.js";import{m as Yt}from"./js-md5-11f5a111.js";import{h as Ce}from"./@vueuse-1b6f7037.js";import{d as ue,s as q,g as ye,a as je,l as Re,u as Wt,b as fe,e as _e,c as Ae,r as jt,_ as tt,p as lt,f as at,i as Ht}from"./index-8d41cedf.js";import{u as Jt}from"./vue-router-e948df84.js";import{_ as Ot}from"./backImg-a3b16eec.js";import{m as Kt,u as Xt,n as He,o as Zt,v as qt,h as Qt,r as el}from"./@element-plus-7b906f9a.js";import"./ali-oss-21f5c855.js";import"./@intlify-9ddbe450.js";import"./lodash-es-f5bdeb48.js";import"./async-validator-dee29e8b.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./escape-html-cf2a8097.js";import"./normalize-wheel-es-ed76fb12.js";import"./crypto-js-d55471a7.js";import"./vuex-90336bc0.js";import"./cos-js-sdk-v5-31c61e27.js";const tl={__name:"ImportExport",emits:["importComplete"],setup(X,{expose:g,emit:J}){const{t:h}=oe(),M=J,n=T(),y=T(),f=T(0),k=i=>{n.value.click(),y.value=i},V=async()=>{if(n.value.files===0)return;f.value=Date.now();const i=new De.Workbook;i.xlsx.load(n.value.files[0]).then(()=>{i.eachSheet(function(d){if(d.rowCount<2){te.error(h("importExport.data.empty")),n.value.value="";return}let s=[];for(let r=2;r<=d.rowCount;r++){let a=d.getRow(r),P=o(a.getCell(1).value),E=o(a.getCell(2).value),p=o(a.getCell(3).value),x=o(a.getCell(4).value),U=o(a.getCell(5).value),D=o(a.getCell(6).value),j=o(a.getCell(7).value),Y=o(a.getCell(8).value);P&&s.push({id:f.value++,name:P,address:E,userName:p,password:x,remark:D,label:m(U),insertTime:j,updateTime:Y})}M("importComplete",s,y.value),n.value.value=""})}).catch(d=>{te.error(d),n.value.value=""})},o=i=>i?typeof i=="object"?i instanceof Date?be(i).format("YYYY-MM-DD HH:mm:ss"):i.text:i.toString():"",m=i=>{if(!i)return"";let d=[],s=i.split("、");for(let r=0;r<s.length;r++){let a=b(y.value,s[r],"");if(a)d.push(a);else{let P=[];A(y.value,s[r].split(">"),0,P);for(let E=0;E<P.length;E++)d.push(P[E])}}return Array.from(new Set(d))},b=(i,d,s)=>{for(let r=0;r<i.length;r++){let a=s?s+">"+i[r].label:i[r].label;if(d===a)return i[r].id;if(i[r].children&&i[r].children.length>0)return b(i[r].children,d,a)}},A=(i,d,s,r)=>{if(!d[s])return;for(let P=0;P<i.length;P++)if(i[P].label===d[s])return d[s+1]||r.push(i[P].id),A(i[P].children,d,s+1,r);let a={id:f.value++,label:d[s],children:[]};i.push(a),d[s+1]||r.push(a.id),A(a.children,d,s+1,r)},I=async(i,d)=>{y.value=d;const s=new De.Workbook,r=s.addWorksheet("sheet1");r.getCell("A1").value=h("password.name"),r.getCell("B1").value=h("password.address"),r.getCell("C1").value=h("password.userName"),r.getCell("D1").value=h("password.password"),r.getCell("E1").value=h("password.label"),r.getCell("F1").value=h("password.remark"),r.getCell("G1").value=h("password.insertTime"),r.getCell("H1").value=h("password.updateTime");for(let a=0;a<i.length;a++){let P=i[a].insertTime;P||(P=be().format("YYYY-MM-DD HH:mm:ss")),r.getCell("A"+(a+2)).value=i[a].name,r.getCell("B"+(a+2)).value=i[a].address,r.getCell("C"+(a+2)).value=i[a].userName,r.getCell("D"+(a+2)).value=i[a].password,r.getCell("E"+(a+2)).value=G(i[a].label),r.getCell("F"+(a+2)).value=i[a].remark,r.getCell("G"+(a+2)).value=P,r.getCell("H"+(a+2)).value=i[a].updateTime}s.xlsx.writeBuffer().then(a=>{let P=new Blob([a],{type:"application/octet-stream"});Ye.saveAs(P,h("importExport.exportName")+"_"+be().format("YYYY-MM-DD HH:mm:ss")+".xlsx")})},G=i=>{if(!i)return"";let d=[];return $(y.value,i,d,""),d.join("、")},$=(i,d,s,r)=>{for(let a=0;a<i.length;a++){let P=r?r+">"+i[a].label:i[a].label;d.includes(i[a].id)&&s.push(P),i[a].children&&i[a].children.length>0&&$(i[a].children,d,s,P)}};return g({importExcel:k,exportExcel:I,downloadExcelTemplate:()=>{const i=new De.Workbook,d=i.addWorksheet("sheet1");d.getCell("A1").value=h("password.name"),d.getCell("B1").value=h("password.address"),d.getCell("C1").value=h("password.userName"),d.getCell("D1").value=h("password.password"),d.getCell("E1").value=h("password.label"),d.getCell("F1").value=h("password.remark"),d.getCell("G1").value=h("password.insertTime"),d.getCell("H1").value=h("password.updateTime"),i.xlsx.writeBuffer().then(s=>{let r=new Blob([s],{type:"application/octet-stream"});Ye.saveAs(r,h("importExport.importTemplateName")+".xlsx")})}}),(i,d)=>(_(),W("input",{type:"file",onChange:V,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ref_key:"fileUploadInput",ref:n,style:{display:"none"}},null,544))}},ll=["width","height"],$e={__name:"GesturePassword",props:{size:{type:Number,default:300},count:{type:Number,default:3},showGesture:{type:Boolean,default:!0}},emits:["complete"],setup(X,{expose:g,emit:J}){const h=Ce(),M=J,n=T();let y=X;const f=Z({padding:y.size*.18,background:h.value?"rgb(20,20,20)":"#fff",failColor:"#F56C6C",passColor:"#67C23A",point:{color:"#409EFF",size:y.size*.023,selected:{range:y.size*.07,color:"#409EFF",size:y.size*.023,madding:{color:"#409EFF",size:y.size*.07,lineWidth:1}}},line:{color:"#409EFF",width:2}}),k=T({}),V=T([]),o=T(!1),m=T("");let b=null;const A=()=>{f.background=h.value?"rgb(20,20,20)":"#fff",b=n.value.getContext("2d"),I()},I=()=>{b.fillStyle=f.background,b.fillRect(0,0,y.size,y.size),k.value=[];let p=(y.size-f.padding*2)/(y.count-1),x=1;for(let U=0;U<y.count;U++)for(let D=0;D<y.count;D++){let j=f.padding+D*p,Y=f.padding+U*p,F=p/2,K={id:x,x:j,y:Y,startX:j-F,endX:j+F,startY:Y-F,endY:Y+F,h:p,w:p};G(K),k.value[x]=K,x++}},G=p=>{let x=a(p);x&&y.showGesture&&(b.beginPath(),m.value==="fail"?b.strokeStyle=f.failColor:m.value==="pass"?b.strokeStyle=f.passColor:b.strokeStyle=f.point.selected.madding.color,b.lineWidth=f.point.selected.madding.lineWidth,b.arc(p.x,p.y,f.point.selected.madding.size,0,Math.PI*2),b.stroke()),b.beginPath(),x&&y.showGesture?(m.value==="fail"?b.fillStyle=f.failColor:m.value==="pass"?b.fillStyle=f.passColor:b.fillStyle=f.point.selected.madding.color,b.arc(p.x,p.y,f.point.selected.size,0,Math.PI*2)):(b.fillStyle=f.point.color,b.arc(p.x,p.y,f.point.size,0,Math.PI*2)),b.fill()},$=()=>{o.value=!0},v=()=>{if(!o.value)return;o.value=!1;let p=d();if(p){let x=Yt(p);M("complete",x)}I(),r()},i=p=>{m.value=p,I(),r(),p?setTimeout(()=>{m.value="",V.value=[],I()},500):(V.value=[],I())},d=()=>{let p="";for(let x=0;x<V.value.length;x++)p+=V.value[x].id+",";return p&&(p=p.substring(0,p.length-1)),p},s=p=>{let x=p.offsetX,U=p.offsetY;if(I(),r(x,U),!o.value)return;let D=P(x,U);!D||a(D)||(V.value.push(D),I(),r(x,U))},r=(p,x)=>{if(!y.showGesture)return;let U=P(p,x);if(U&&m.value===""&&(b.beginPath(),b.strokeStyle=f.point.selected.madding.color,b.lineWidth=f.point.selected.madding.lineWidth,b.arc(U.x,U.y,f.point.selected.madding.size,0,Math.PI*2),b.stroke()),V.value.length!==0){b.beginPath(),m.value==="fail"?b.strokeStyle=f.failColor:m.value==="pass"?b.strokeStyle=f.passColor:b.strokeStyle=f.line.color,b.lineWidth=f.line.width,b.lineCap="round",b.moveTo(V.value[0].x,V.value[0].y);for(let D=1;D<V.value.length;D++)b.lineTo(V.value[D].x,V.value[D].y);o.value&&p&&x&&m.value===""&&b.lineTo(p,x),b.stroke()}},a=p=>{for(let x=0;x<V.value.length;x++)if(p.id===V.value[x].id)return!0;return!1},P=(p,x)=>{for(let U in k.value){let D=k.value[U];if(p>D.startX+f.point.selected.range&&p<D.endX-f.point.selected.range&&x>D.startY+f.point.selected.range&&x<D.endY-f.point.selected.range)return D}},E=p=>{let x=p.touches[0].clientX-n.value.offsetLeft,U=p.touches[0].clientY-n.value.offsetTop;s({offsetX:x,offsetY:U})};return qe(()=>{A()}),g({setVerifyStatus:i}),(p,x)=>e(y).size?(_(),W("canvas",{key:0,width:e(y).size,height:e(y).size,ref_key:"canvasRef",ref:n,onMousedown:$,onMouseup:v,onMousemove:x[0]||(x[0]=U=>s(U)),onMouseleave:v,onTouchstart:$,onTouchend:v,onTouchmove:E},null,40,ll)):B("",!0)}},al={style:{"text-align":"center"}},sl={class:"dialog-footer"},ol={__name:"DeleteAccount",emits:["deleteAccount"],setup(X,{expose:g,emit:J}){const{t:h}=oe(),M=J,n=T(),y=Z({deleteAccount:!1}),f=T(""),k=T(""),V=()=>{let A=ue(k.value,q.state.verifyCode);if(A&&A==="password-x"){f.value==="gesture"&&n.value.setVerifyStatus("pass");let I=localStorage.getItem("databaseForm"),G=ue(ye(),I);if(JSON.parse(G).keyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){te.error("演示账号不能注销");return}je("password.json"),je("labelTree.json"),localStorage.removeItem("systemConfig"),te.success(h("systemSetting.deleteAccount.success")),M("deleteAccount")}else f.value==="common"?te.error(h("systemSetting.deleteAccount.mainPasswordError")):n.value.setVerifyStatus("fail")},o=()=>{f.value=q.state.mainPasswordType,y.deleteAccount=!0},m=A=>{k.value=A,V()},b=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){b.value=document.documentElement.clientWidth<728}),g({showDeleteAccount:o}),(A,I)=>{const G=Ue,$=$e,v=me,i=ce,d=ke;return _(),R(d,{fullscreen:e(b),modelValue:e(y).deleteAccount,"onUpdate:modelValue":I[1]||(I[1]=s=>e(y).deleteAccount=s),title:e(h)("systemSetting.deleteAccount"),width:"400px"},Se({default:l(()=>[t(G,{type:"error",closable:!1},{default:l(()=>[C(S(e(h)("systemSetting.deleteAccount.text")),1)]),_:1}),L("div",al,[e(f)==="gesture"?(_(),R($,{key:0,ref_key:"gesturePasswordRef",ref:n,onComplete:m},null,512)):B("",!0),e(f)==="common"?(_(),R(v,{key:1,modelValue:e(k),"onUpdate:modelValue":I[0]||(I[0]=s=>ie(k)?k.value=s:null),style:{"margin-top":"20px"}},null,8,["modelValue"])):B("",!0)])]),_:2},[e(f)==="common"?{name:"footer",fn:l(()=>[L("span",sl,[t(i,{type:"danger",onClick:V},{default:l(()=>[C(S(e(h)("systemSetting.deleteAccount.affirm")),1)]),_:1})])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},nl={style:{"text-align":"center"}},rl={class:"dialog-footer"},dl={__name:"SystemSetting",emits:["updateMainPassword","deleteAccount","systemChangeChange"],setup(X,{expose:g,emit:J}){const h=Jt(),M=Ce(),{t:n,locale:y}=oe(),f=J,k=T(),V=Z({setting:!1}),o=Z(Re()),m=Z({languages:[],sorts:[],topics:[],cacheMains:[],showAddTimes:[],showUpTimes:[],showLabels:[],verifyShowGestures:[],cacheDatabaseForms:[],autoGeneratePasswords:[],showPasswordStrengths:[]}),b=()=>{m.languages=[{key:"zh-cn",label:"简体中文"},{key:"en-us",label:"English"}],m.sorts=[{key:"insertTimeDesc",label:n("systemSetting.sort.insertTimeDesc")},{key:"insertTimeAsc",label:n("systemSetting.sort.insertTimeAsc")},{key:"updateTimeDesc",label:n("systemSetting.sort.updateTimeDesc")},{key:"updateTimeAsc",label:n("systemSetting.sort.updateTimeAsc")},{key:"nameAsc",label:n("systemSetting.sort.nameAsc")},{key:"nameDesc",label:n("systemSetting.sort.nameDesc")},{key:"strengthDesc",label:n("systemSetting.sort.strengthAsc")},{key:"strengthAsc",label:n("systemSetting.sort.strengthDesc")}],m.topics=[{key:!1,label:n("systemSetting.topic.light")},{key:!0,label:n("systemSetting.topic.dark")}],m.cacheMains=[{key:!0,label:n("systemSetting.cacheMainPassword.enable")},{key:!1,label:n("systemSetting.cacheMainPassword.disabled")}],m.showAddTimes=[{key:!0,label:n("systemSetting.showAddTime.enable")},{key:!1,label:n("systemSetting.showAddTime.disabled")}],m.showUpTimes=[{key:!0,label:n("systemSetting.showUpTime.enable")},{key:!1,label:n("systemSetting.showUpTime.disabled")}],m.showLabels=[{key:!0,label:n("systemSetting.showLabel.enable")},{key:!1,label:n("systemSetting.showLabel.disabled")}],m.verifyShowGestures=[{key:!0,label:n("mainPasswordSetting.verify.showGesture.enable")},{key:!1,label:n("mainPasswordSetting.verify.showGesture.disabled")}],m.cacheDatabaseForms=[{key:!0,label:n("systemSetting.cacheDatabaseForm.enable")},{key:!1,label:n("systemSetting.cacheDatabaseForm.disabled")}],m.autoGeneratePasswords=[{key:!0,label:n("passwordForm.autoGeneratePassword.enable")},{key:!1,label:n("passwordForm.autoGeneratePassword.disabled")}],m.showPasswordStrengths=[{key:!0,label:n("systemSetting.showPasswordStrength.enable")},{key:!1,label:n("systemSetting.showPasswordStrength.disabled")}]};let A=null;const I=()=>{b();let r=Re();for(let a in r)o[a]=r[a];A=JSON.stringify(o),V.setting=!0},G=()=>{V.setting=!1},$=()=>{let r=o.defaultPasswordRule;if(!r.number&&!r.symbol&&!r.lowercase&&!r.uppercase){te.error(n("systemSetting.passwordRuleVerify"));return}Wt(o);let a=JSON.parse(A);o.cacheMainPassword!==a.cacheMainPassword&&o.cacheMainPassword===!1&&(localStorage.removeItem("mainPasswordCiphertext"),console.log("删除主密码缓存")),o.cacheDatabaseForm!==a.cacheDatabaseForm&&o.cacheDatabaseForm===!1&&(localStorage.removeItem("databaseForm"),console.log("删除自动登录信息")),o.language!==y.value&&(y.value=o.language,console.log("系统语言设置为：",o.language)),M.value!==o.darkMode&&(M.value=o.darkMode,console.log("暗黑模式设置为：",o.darkMode)),o.sortRule!==a.sortRule&&(f("systemChangeChange","sortChange",o.sortRule),console.log("排序规则设置为：",o.sortRule)),o.showPasswordStrength!==a.showPasswordStrength&&(f("systemChangeChange","showPasswordStrength",o.showPasswordStrength),console.log("是否显示密码强度设置为：",o.showPasswordStrength)),V.setting=!1},v=()=>{localStorage.removeItem("databaseForm"),localStorage.removeItem("mainPasswordCiphertext"),q.commit("delDatabase"),q.commit("delDatabaseForm"),q.commit("delVerifyCode"),h.push("/login")},i=()=>{V.setting=!1,f("updateMainPassword")},d=()=>{V.setting=!1,k.value.showDeleteAccount()},s=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){s.value=document.documentElement.clientWidth<728}),g({logout:v,openSystemSetting:I,showUpdateMainPassword:i,settingForm:o}),(r,a)=>{const P=Ct,E=Vt,p=Pe,x=Je,U=Ie,D=me,j=Ne,Y=Oe,F=ce,K=Ke,Ve=xe,Te=Ue,Me=ke,le=ol;return _(),W(O,null,[t(Me,{fullscreen:e(s),modelValue:e(V).setting,"onUpdate:modelValue":a[16]||(a[16]=c=>e(V).setting=c),title:e(n)("systemSetting.title"),width:"600px"},{footer:l(()=>[L("span",rl,[t(F,{plain:"",onClick:G},{default:l(()=>[C(S(e(n)("systemSetting.close")),1)]),_:1}),t(F,{type:"primary",plain:"",onClick:$},{default:l(()=>[C(S(e(n)("systemSetting.save")),1)]),_:1})])]),default:l(()=>[t(Ve,{"label-width":"120px"},{default:l(()=>[t(K,{"tab-position":"left",style:{height:"350px"}},{default:l(()=>[t(Y,{label:e(n)("systemSetting.type.general")},{default:l(()=>[t(p,{label:e(n)("systemSetting.language")},{default:l(()=>[t(E,{modelValue:e(o).language,"onUpdate:modelValue":a[0]||(a[0]=c=>e(o).language=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).languages,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.sort")},{default:l(()=>[t(E,{modelValue:e(o).sortRule,"onUpdate:modelValue":a[1]||(a[1]=c=>e(o).sortRule=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).sorts,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("passwordForm.autoGeneratePassword")},{default:l(()=>[t(E,{modelValue:e(o).autoGeneratePassword,"onUpdate:modelValue":a[2]||(a[2]=c=>e(o).autoGeneratePassword=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).autoGeneratePasswords,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.defaultPasswordRule")},{default:l(()=>[t(j,{style:{"margin-top":"15px"}},{default:l(()=>[t(U,{span:12},{default:l(()=>[t(x,{size:"small",modelValue:e(o).defaultPasswordRule.uppercase,"onUpdate:modelValue":a[3]||(a[3]=c=>e(o).defaultPasswordRule.uppercase=c),label:e(n)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(U,{span:12},{default:l(()=>[t(x,{size:"small",modelValue:e(o).defaultPasswordRule.lowercase,"onUpdate:modelValue":a[4]||(a[4]=c=>e(o).defaultPasswordRule.lowercase=c),label:e(n)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(U,{span:12},{default:l(()=>[t(x,{size:"small",modelValue:e(o).defaultPasswordRule.number,"onUpdate:modelValue":a[5]||(a[5]=c=>e(o).defaultPasswordRule.number=c),label:e(n)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(U,{span:12},{default:l(()=>[t(x,{size:"small",modelValue:e(o).defaultPasswordRule.symbol,"onUpdate:modelValue":a[6]||(a[6]=c=>e(o).defaultPasswordRule.symbol=c),label:e(n)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1}),t(U,{span:24},{default:l(()=>[L("div",null,[t(D,{size:"small",style:{position:"relative",top:"3px"},modelValue:e(o).defaultPasswordRule.length,"onUpdate:modelValue":a[7]||(a[7]=c=>e(o).defaultPasswordRule.length=c)},{prepend:l(()=>[C(S(e(n)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["label"])]),_:1},8,["label"]),t(Y,{label:e(n)("systemSetting.type.personalization")},{default:l(()=>[t(p,{label:e(n)("systemSetting.topic")},{default:l(()=>[t(E,{modelValue:e(o).darkMode,"onUpdate:modelValue":a[8]||(a[8]=c=>e(o).darkMode=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).topics,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.showPasswordStrength")},{default:l(()=>[t(E,{modelValue:e(o).showPasswordStrength,"onUpdate:modelValue":a[9]||(a[9]=c=>e(o).showPasswordStrength=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).showPasswordStrengths,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.showAddTime")},{default:l(()=>[t(E,{modelValue:e(o).showAddTime,"onUpdate:modelValue":a[10]||(a[10]=c=>e(o).showAddTime=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).showAddTimes,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.showUpTime")},{default:l(()=>[t(E,{modelValue:e(o).showUpTime,"onUpdate:modelValue":a[11]||(a[11]=c=>e(o).showUpTime=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).showUpTimes,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.showLabel")},{default:l(()=>[t(E,{modelValue:e(o).showLabel,"onUpdate:modelValue":a[12]||(a[12]=c=>e(o).showLabel=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).showLabels,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["label"]),t(Y,{label:e(n)("systemSetting.type.security")},{default:l(()=>[t(p,{label:e(n)("systemSetting.cacheMainPassword")},{default:l(()=>[t(E,{modelValue:e(o).cacheMainPassword,"onUpdate:modelValue":a[13]||(a[13]=c=>e(o).cacheMainPassword=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).cacheMains,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.cacheDatabaseForm")},{default:l(()=>[t(E,{modelValue:e(o).cacheDatabaseForm,"onUpdate:modelValue":a[14]||(a[14]=c=>e(o).cacheDatabaseForm=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).cacheDatabaseForms,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("mainPasswordSetting.verify.showGesture")},{default:l(()=>[t(E,{modelValue:e(o).verifyShowGesture,"onUpdate:modelValue":a[15]||(a[15]=c=>e(o).verifyShowGesture=c)},{default:l(()=>[(_(!0),W(O,null,ee(e(m).verifyShowGestures,c=>(_(),R(P,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["label"]),t(Y,{label:e(n)("systemSetting.type.other")},{default:l(()=>[L("div",nl,[t(F,{plain:"",onClick:i},{default:l(()=>[C(S(e(n)("systemSetting.updateMainPassword")),1)]),_:1}),t(F,{plain:"",type:"danger",onClick:d},{default:l(()=>[C(S(e(n)("systemSetting.deleteAccount")),1)]),_:1}),t(F,{type:"warning",plain:"",onClick:v},{default:l(()=>[C(S(e(n)("systemSetting.logout")),1)]),_:1})])]),_:1},8,["label"])]),_:1})]),_:1}),t(Te,{style:{"margin-top":"20px"},type:"warning"},{default:l(()=>[C(S(e(n)("systemSetting.takeEffect")),1)]),_:1})]),_:1},8,["fullscreen","modelValue","title"]),t(le,{ref_key:"deleteAccountRef",ref:k,onDeleteAccount:v},null,512)],64)}}},il={style:{"text-align":"center"}},ul={class:"dialog-footer"},st={__name:"MainPasswordVerify",emits:["verifyPass"],setup(X,{expose:g,emit:J}){const{t:h}=oe(),M=J,n=T(),y=T(""),f=T(""),k=Z({verifyMainPassword:!1}),V=v=>{y.value=v,o()},o=()=>{let v=ue(y.value,q.state.verifyCode);v&&v==="password-x"?(f.value==="gesture"&&n.value.setVerifyStatus("pass"),M("verifyPass",y.value),b(y.value),y.value="",k.verifyMainPassword=!1):f.value==="common"?te.error(h("mainPasswordVerify.form.verify")):n.value.setVerifyStatus("fail")},m=()=>{localStorage.removeItem("mainPasswordCiphertext")},b=v=>{if(fe("cacheMainPassword")===!1)return;let d=ye(),s=_e(d,v);localStorage.setItem("mainPasswordCiphertext",s)},A=()=>{if(fe("cacheMainPassword")===!1)return null;let i=localStorage.getItem("mainPasswordCiphertext");if(!i)return null;let d=ye(),s=ue(d,i);return s||null},I=()=>fe("verifyShowGesture")!==!1,G=(v=!0)=>{if(f.value=q.state.mainPasswordType,!v){k.verifyMainPassword=!0;return}let i=A();if(!i){k.verifyMainPassword=!0;return}let d=ue(i,q.state.verifyCode);d&&d==="password-x"?M("verifyPass",i):k.verifyMainPassword=!0},$=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){$.value=document.documentElement.clientWidth<728}),g({verifyMainPassword:G,delLocalMainPassword:m}),(v,i)=>{const d=$e,s=me,r=Pe,a=xe,P=ce,E=ke;return _(),R(E,{fullscreen:e($),modelValue:e(k).verifyMainPassword,"onUpdate:modelValue":i[1]||(i[1]=p=>e(k).verifyMainPassword=p),title:e(h)("mainPasswordVerify.form.title"),width:"400px"},Se({default:l(()=>[L("div",il,[e(f)==="gesture"&&e(k).verifyMainPassword?(_(),R(d,{key:0,"show-gesture":I(),ref_key:"gesturePasswordRef",ref:n,onComplete:V},null,8,["show-gesture"])):B("",!0),e(f)==="common"&&e(k).verifyMainPassword?(_(),R(a,{key:1,style:{padding:"10px"}},{default:l(()=>[t(r,null,{default:l(()=>[t(s,{modelValue:e(y),"onUpdate:modelValue":i[0]||(i[0]=p=>ie(y)?y.value=p:null),placeholder:e(h)("mainPasswordVerify.form.mainPassword"),type:"password",onKeyup:Qe(o,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1})]),_:1})):B("",!0)])]),_:2},[e(f)==="common"?{name:"footer",fn:l(()=>[L("span",ul,[t(P,{type:"primary",disabled:!e(y),onClick:o},{default:l(()=>[C(S(e(h)("mainPasswordVerify.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},ml={class:"dialog-footer"},cl={__name:"MainPasswordSetting",emits:["mainPasswordChange"],setup(X,{expose:g,emit:J}){const{t:h}=oe(),M=J,n=T(),y=T(),f=T("gesture"),k=T(""),V=T(""),o=Z({mainPassword:!1}),m=T(""),b=i=>{m.value==="setting"?(k.value=i,m.value="affirm",y.value.setVerifyStatus("")):m.value==="affirm"&&(V.value=i,A())},A=()=>{if(k.value!==V.value){te.error(h("mainPasswordSetting.form.passwordsDiff"));return}let i=localStorage.getItem("databaseForm"),d=ue(ye(),i);if(JSON.parse(d).accessKeyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){te.error("演示账号不能修改主密码");return}f.value==="gesture"?q.commit("setMainPasswordType","gesture"):q.commit("setMainPasswordType","common"),M("mainPasswordChange",k.value,f.value);let r=fe("cacheMainPassword");if(r||r==null){let a=ye(),P=_e(a,k.value);localStorage.setItem("mainPasswordCiphertext",P)}k.value="",V.value="",o.mainPassword=!1},I=()=>{m.value="setting",o.mainPassword=!0},G=()=>{n.value.verifyMainPassword(!1)},$=()=>{f.value==="gesture"&&(m.value="setting"),k.value="",V.value=""},v=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){v.value=document.documentElement.clientWidth<728}),g({settingMainPassword:I,updateMainPassword:G}),(i,d)=>{const s=Ue,r=Xe,a=$e,P=ze,E=Oe,p=me,x=Pe,U=xe,D=Ke,j=ce,Y=ke,F=st;return _(),W(O,null,[t(Y,{fullscreen:e(v),modelValue:e(o).mainPassword,"onUpdate:modelValue":d[4]||(d[4]=K=>e(o).mainPassword=K),title:e(h)("mainPasswordSetting.form.setMainPassword"),width:"470px"},Se({default:l(()=>[t(s,{type:"error",style:{position:"relative",top:"-10px"},closable:!1},{default:l(()=>[C(S(e(h)("mainPasswordSetting.forget.message")),1)]),_:1}),t(D,{modelValue:e(f),"onUpdate:modelValue":d[3]||(d[3]=K=>ie(f)?f.value=K:null),style:{"margin-top":"10px"},type:"card",onTabChange:$},{default:l(()=>[t(E,{label:e(h)("mainPasswordSetting.passwordType.gesture"),name:"gesture",style:{"text-align":"center"}},{default:l(()=>[L("div",null,[e(m)==="setting"?(_(),R(r,{key:0},{default:l(()=>[C(S(e(h)("mainPasswordSetting.gesture.first")),1)]),_:1})):B("",!0),e(m)==="affirm"?(_(),R(r,{key:1},{default:l(()=>[C(S(e(h)("mainPasswordSetting.gesture.affirm")),1)]),_:1})):B("",!0)]),e(o).mainPassword&&e(f)==="gesture"?(_(),R(a,{key:0,ref_key:"gesturePasswordRef",ref:y,onComplete:b},null,512)):B("",!0),L("div",null,[t(P,{underline:!1,style:{position:"relative",top:"-2px"},type:"primary",onClick:d[0]||(d[0]=K=>m.value="setting")},{default:l(()=>[C(S(e(h)("mainPasswordSetting.gesture.reset")),1)]),_:1})])]),_:1},8,["label"]),t(E,{label:e(h)("mainPasswordSetting.passwordType.common"),name:"common",style:{"text-align":"center"}},{default:l(()=>[t(U,{inline:!0,"label-width":"100px",style:{"margin-top":"20px"}},{default:l(()=>[t(x,{label:e(h)("mainPasswordSetting.form.newMainPassword")},{default:l(()=>[t(p,{type:"password",modelValue:e(k),"onUpdate:modelValue":d[1]||(d[1]=K=>ie(k)?k.value=K:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"]),t(x,{label:e(h)("mainPasswordSetting.form.newMainPasswordAffirm")},{default:l(()=>[t(p,{type:"password",modelValue:e(V),"onUpdate:modelValue":d[2]||(d[2]=K=>ie(V)?V.value=K:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:2},[e(f)==="common"?{name:"footer",fn:l(()=>[L("span",ml,[t(j,{type:"primary",disabled:!e(k),onClick:A},{default:l(()=>[C(S(e(h)("mainPasswordSetting.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"]),t(F,{ref_key:"mainPasswordVerifyRef",ref:n,onVerifyPass:I},null,512)],64)}}},pl={class:"dialog-footer"},fl={__name:"PasswordForm",props:{labelTree:Array},emits:["addPassword","updatePassword"],setup(X,{expose:g,emit:J}){const h=J,{t:M}=oe(),n=T(),y=Z({password:!1}),f=T(""),k=Z({uppercase:"ABCDEFGHJKLMNPQRSTUVWXYZ",lowercase:"abcdefghjkmnpqrstuvwxyz",number:"0123456789",symbol:"~!@#$^&*()_+.,;"}),V=()=>({id:0,name:"",address:"",userName:"",password:"",remark:"",label:"",insertTime:"",updateTime:""}),o=Z(V()),m=Z({length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}),b=Z({name:[{required:!0,message:M("passwordForm.form.name.verify"),trigger:"blur"}]}),A=()=>{if(!m.number&&!m.symbol&&!m.lowercase&&!m.uppercase){te.error(M("systemSetting.passwordRuleVerify"));return}let d=[];m.lowercase&&d.push(k.lowercase),m.uppercase&&d.push(k.uppercase),m.symbol&&d.push(k.symbol),m.number&&d.push(k.number),o.password=jt(d,m.length)},I=async d=>{await d.validate(s=>{s&&(y.password=!1,f.value==="add"?(o.id=Date.now(),o.insertTime=be().format("YYYY-MM-DD HH:mm:ss"),h("addPassword",JSON.parse(JSON.stringify(o)))):(o.updateTime=be().format("YYYY-MM-DD HH:mm:ss"),h("updatePassword",JSON.parse(JSON.stringify(o)))))})},G=()=>{let d=fe("defaultPasswordRule");if(d)for(let s in d)m[s]=d[s]},$=()=>{G();let d=V();for(let r in d)o[r]=d[r];fe("autoGeneratePassword")&&A(),f.value="add",y.password=!0},v=d=>{G();for(let s in o)o[s]=d[s];f.value="update",y.password=!0},i=()=>document.documentElement.clientWidth;return g({showAddPassword:$,showUpdatePassword:v}),(d,s)=>{const r=me,a=Pe,P=ce,E=Ie,p=Ne,x=Je,U=Le,D=Tt,j=xe,Y=Mt;return _(),R(Y,{modelValue:e(y).password,"onUpdate:modelValue":s[13]||(s[13]=F=>e(y).password=F),title:e(f)==="add"?e(M)("passwordForm.form.addPassword"):e(M)("passwordForm.form.editPassword"),size:"620px",direction:i()>768?"rtl":"btt"},{footer:l(()=>[L("span",pl,[t(P,{onClick:s[12]||(s[12]=F=>I(e(n))),type:"primary"},{default:l(()=>[C(S(e(M)("passwordForm.generateForm.save")),1)]),_:1})])]),default:l(()=>[t(j,{ref_key:"passwordFormRef",ref:n,model:e(o),rules:e(b),"label-width":"70px",style:{"padding-right":"30px"}},{default:l(()=>[t(a,{label:e(M)("password.name"),prop:"name"},{default:l(()=>[t(r,{modelValue:e(o).name,"onUpdate:modelValue":s[0]||(s[0]=F=>e(o).name=F),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(a,{label:e(M)("password.address")},{default:l(()=>[t(r,{modelValue:e(o).address,"onUpdate:modelValue":s[1]||(s[1]=F=>e(o).address=F),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(a,{label:e(M)("password.userName")},{default:l(()=>[t(r,{modelValue:e(o).userName,"onUpdate:modelValue":s[2]||(s[2]=F=>e(o).userName=F),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(a,{label:e(M)("password.password")},{default:l(()=>[t(U,{style:{width:"100%"}},{default:l(()=>[t(p,null,{default:l(()=>[t(E,null,{default:l(()=>[t(r,{modelValue:e(o).password,"onUpdate:modelValue":s[4]||(s[4]=F=>e(o).password=F),clearable:""},{append:l(()=>[t(P,{onClick:s[3]||(s[3]=F=>e(Ae)(e(o).password))},{default:l(()=>[C(S(e(M)("passwordForm.generateForm.password.copy")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(p,{style:{"margin-top":"15px"}},{default:l(()=>[t(E,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(m).uppercase,"onUpdate:modelValue":s[5]||(s[5]=F=>e(m).uppercase=F),label:e(M)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(E,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(m).lowercase,"onUpdate:modelValue":s[6]||(s[6]=F=>e(m).lowercase=F),label:e(M)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(E,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(m).number,"onUpdate:modelValue":s[7]||(s[7]=F=>e(m).number=F),label:e(M)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(E,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(m).symbol,"onUpdate:modelValue":s[8]||(s[8]=F=>e(m).symbol=F),label:e(M)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1})]),_:1}),t(p,{style:{"margin-top":"15px"}},{default:l(()=>[t(E,{style:{"text-align":"center"}},{default:l(()=>[t(r,{modelValue:e(m).length,"onUpdate:modelValue":s[9]||(s[9]=F=>e(m).length=F),size:"small",style:{width:"120px"}},{prepend:l(()=>[C(S(e(M)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"]),t(P,{plain:"",size:"small",style:{position:"relative",top:"-5px","margin-left":"10px"},type:"success",onClick:A},{default:l(()=>[C(S(e(M)("passwordForm.generateForm.randomPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["label"]),t(a,{label:e(M)("password.label")},{default:l(()=>[t(D,{modelValue:e(o).label,"onUpdate:modelValue":s[10]||(s[10]=F=>e(o).label=F),"value-key":"id",data:X.labelTree,"check-strictly":"",multiple:"","default-expand-all":"",placeholder:e(M)("password.label.placeholder"),filterable:""},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),t(a,{label:e(M)("password.remark")},{default:l(()=>[t(r,{type:"textarea",placeholder:e(M)("passwordForm.generateForm.remark"),rows:4,modelValue:e(o).remark,"onUpdate:modelValue":s[11]||(s[11]=F=>e(o).remark=F)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","direction"])}}};const wl={class:"label-tree-node"},gl=["onClick","onBlur"],bl={class:"label-tree-node-menu"},_l={__name:"LabelTree",emits:["labelCheckChange","labelTreeChange"],setup(X,{expose:g,emit:J}){const h=Ce(),{t:M}=oe(),n=J,y=T(),f=T([]),k=T([]),V=T(!1),o=()=>{let s=y.value.getCheckedNodes();n("labelCheckChange",s)},m=(s,r)=>s?r.label.includes(s):!0,b=s=>{const r={id:Date.now(),label:M("labelTree.addLabel"),children:[]};s.children||(s.children=[]),s.children.push(r)},A=(s,r)=>{const a=s.parent,P=a.data.children||a.data,E=P.findIndex(p=>p.id===r.id);P.splice(E,1)},I=s=>!s.edit,G=()=>{k.value.push({id:Date.now(),label:M("labelTree.firstAddLabel"),children:[]})},$=()=>{V.value&&lt("labelTree.json",{labelTree:k.value})},v=s=>{k.value=s};We(f,s=>{y.value.filter(s)}),We(k,()=>{$(),n("labelTreeChange",k.value)},{deep:!0});const i=()=>{at("labelTree.json").then(s=>{s&&s.labelTree?k.value=s.labelTree:k.value=[],V.value=!0}).catch(s=>{Ze.error(s.code)})},d=()=>h.value;return i(),g({setLabelTree:v}),(s,r)=>{const a=me,P=ce,E=ze,p=Ft,x=Et,U=Le;return _(),R(U,{class:"body-card",style:et({"background-color":d()?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.4)"})},{header:l(()=>[C(S(e(M)("labelTree.title")),1)]),default:l(()=>[t(a,{modelValue:e(f),"onUpdate:modelValue":r[0]||(r[0]=D=>ie(f)?f.value=D:null),clearable:"",placeholder:e(M)("labelTree.search.placeholder")},null,8,["modelValue","placeholder"]),t(x,{height:"50vh"},{default:l(()=>[t(p,{data:e(k),"show-checkbox":"",ref_key:"labelTreeRef",ref:y,draggable:"","node-key":"id",style:{"margin-top":"10px","background-color":"rgba(0,0,0,0)"},onCheck:o,"filter-node-method":m,"expand-on-click-node":!1,"allow-drag":I,"default-expand-all":""},{empty:l(()=>[t(P,{size:"small",type:"primary",plain:"",onClick:G},{default:l(()=>[C(S(e(M)("labelTree.firstAddLabel")),1)]),_:1})]),default:l(({node:D,data:j})=>[L("span",wl,[D.edit?B("",!0):(_(),W("span",{key:0,onClick:Y=>D.edit=!0,onBlur:Y=>D.edit=!1},S(j.label),41,gl)),D.edit?(_(),R(a,{key:1,style:{width:"60%"},ref:D.id+"_input",size:"small",onBlur:Y=>D.edit=!1,modelValue:j.label,"onUpdate:modelValue":Y=>j.label=Y},null,8,["onBlur","modelValue","onUpdate:modelValue"])):B("",!0),L("span",bl,[t(E,{onClick:Y=>b(j),type:"primary",underline:!1},{default:l(()=>[C(S(e(M)("labelTree.tree.add")),1)]),_:2},1032,["onClick"]),t(E,{onClick:Y=>A(D,j),type:"danger",underline:!1,style:{"margin-left":"8px"}},{default:l(()=>[C(S(e(M)("labelTree.tree.remove")),1)]),_:2},1032,["onClick"])])])]),_:1},8,["data"])]),_:1})]),_:1},8,["style"])}}},yl=tt(_l,[["__scopeId","data-v-5b83f236"]]);const ve=X=>(Bt("data-v-b5fb178d"),X=X(),Gt(),X),vl=ve(()=>L("img",{alt:"",class:"back-img",src:Ot},null,-1)),hl={style:{display:"flex","justify-content":"space-between"}},kl={class:"hidden-xs-only"},Pl=ve(()=>L("br",null,null,-1)),xl={key:1},Sl={style:{display:"flex","justify-content":"end"},class:"password-title-right"},Cl=ve(()=>L("div",{class:"password-strength",style:{"background-color":"#67C23A"}},null,-1)),Vl=ve(()=>L("div",{class:"password-strength",style:{"background-color":"#E6A23C"}},null,-1)),Tl=ve(()=>L("div",{class:"password-strength",style:{"background-color":"#F56C6C"}},null,-1)),Ml={key:0},Fl={class:"password-text"},El={class:"pass-action-div"},Dl={__name:"IndexPage",setup(X){const{t:g,locale:J}=oe(),h=Ce(),M=T(),n=T(),y=T(),f=T(),k=T(),V=T(),o=T(),m=Z({}),b=T(""),A=T(""),I=T(""),G=T(!1),$=T(""),v=T([]),i=T([]),d=T([]),s=T([]),r=async()=>{if(!b.value&&!d.value){i.value=v.value;return}let u=[];for(let w=0;w<v.value.length;w++){let z=v.value[w].name||"",H=v.value[w].userName||"",ne=v.value[w].address||"",re=v.value[w].remark||"",de=v.value[w].password||"",Ee=!b.value||z.includes(b.value)||H.includes(b.value)||ne.includes(b.value)||re.includes(b.value)||de.includes(b.value),we=!1;if(d.value.length>0)for(let ge=0;ge<d.value.length;ge++){let Q=d.value[ge];v.value[w].label&&v.value[w].label.includes(Q.id)&&(we=!0)}else we=!0;Ee&&we&&u.push(v.value[w])}i.value=u},a=()=>{M.value.showAddPassword()},P=u=>{M.value.showUpdatePassword(u)},E=u=>{v.value.unshift(u),pe(),r()},p=u=>{for(let w=0;w<v.value.length;w++)if(v.value[w].id===u.id){v.value[w]=u,pe(),r();break}},x=()=>{$.value=_e(A.value,JSON.stringify(v.value)),G.value=!1,i.value=[],v.value=[],A.value="",y.value.delLocalMainPassword()},U=()=>{y.value.verifyMainPassword()},D=u=>{let w=g("password.name")+": "+u.name+`\r
`;u.address&&(w+=g("password.address")+": "+u.address+`\r
`),u.userName&&(w+=g("password.userName")+": "+u.userName+`\r
`),u.password&&(w+=g("password.password")+": "+u.password+`\r
`),u.remark&&(w+=u.remark+`\r
`),w=w.substring(0,w.length-2),Ae(w)},j=u=>{for(let w=0;w<v.value.length;w++)if(v.value[w].id===u.id){v.value.splice(w,1),pe(),r(),te.success(g("index.table.delete.success"));break}},Y=u=>{A.value=u;let w=ue(u,$.value);v.value=JSON.parse(w),G.value=!0,r()},F=(u,w)=>{A.value=u,I.value=w,pe(),te.success(g("index.mainPassword.changeSuccess"))},K=()=>{k.value.openSystemSetting()},Ve=()=>{f.value.updateMainPassword()},Te=(u,w)=>{m[u]=w,u==="sortChange"&&Me(w)},Me=u=>{u==="insertTimeDesc"?(n.value.sort("insertTime","descending"),ae("insertTime",-1)):u==="insertTimeAsc"?(n.value.sort("insertTime","ascending"),ae("insertTime",1)):u==="updateTimeDesc"?(n.value.sort("updateTime","descending"),ae("updateTime",-1)):u==="updateTimeAsc"?(n.value.sort("updateTime","ascending"),ae("updateTime",1)):u==="nameAsc"?(n.value.sort("name","ascending"),ae("name",1)):u==="nameDesc"?(n.value.sort("name","descending"),ae("name",-1)):u==="strengthDesc"?(n.value.sort("strength","descending"),ae("strength",-1)):u==="strengthAsc"&&(n.value.sort("strength","ascending"),ae("strength",1)),pe()},le=u=>{let w=0;return/[0-9]/.test(u)&&w++,/[a-z]/.test(u)&&w++,/[A-Z]/.test(u)&&w++,/[^0-9a-zA-Z_]/.test(u)&&w++,u.length<6&&w>2&&(w=2),w>3?3:w},c=(u,w)=>le(u.password)>le(w.password)?1:-1,Fe=u=>{let w=0;for(let z=0;z<v.value.length;z++){if(!v.value[z].password)continue;let H=le(v.value[z].password);u===H&&w++}return w},ae=(u,w)=>{v.value.sort((z,H)=>u==="strength"?w>0?c(z,H):c(H,z):(z=z[u],H=H[u],z<H?w*-1:z>H?w*1:0))},pe=()=>{if(!G.value)return;$.value=_e(A.value,JSON.stringify(v.value));let u=_e(A.value,"password-x");q.commit("setVerifyCode",u),lt("password.json",{verifyValue:u,mainPasswordType:I.value,passwordCiphertext:$.value})},ot=()=>{at("password.json").then(u=>{if(u.verifyValue){let w=u.verifyValue;I.value=u.mainPasswordType||"common",q.commit("setVerifyCode",w),q.commit("setMainPasswordType",I.value),$.value=u.passwordCiphertext,y.value.verifyMainPassword(!0)}else G.value=!0,f.value.settingMainPassword()}).catch(u=>{console.error(u),Ze.error("error-1000："+u)})},nt=u=>{d.value=u,r()},rt=u=>{s.value=u},dt=u=>{if(!u)return"";let w=[];return Be(s.value,u,w),w},Be=(u,w,z)=>{for(let H=0;H<u.length;H++)w.includes(u[H].id)&&z.push(u[H].label),u[H].children&&u[H].children.length>0&&Be(u[H].children,w,z)},it=()=>{V.value.downloadExcelTemplate()},ut=()=>{V.value.importExcel(s.value)},mt=()=>{V.value.exportExcel(v.value,s.value)},ct=(u,w)=>{if(u.length!==0){for(let z=u.length-1;z>=0;z--)v.value.unshift(u[z]);o.value.setLabelTree(w),pe(),r()}},pt=()=>{k.value.logout()},ft=()=>h.value;return qe(()=>{let u=Re();for(let w in u)m[w]=u[w];m.language&&m.language!==J.value&&(J.value=m.language),ot()}),(u,w)=>{const z=Xe,H=me,ne=ce,re=Dt,de=Rt,Ee=At,we=Ut,ge=It,Q=Nt,he=ze,wt=$t,gt=zt,bt=Lt,_t=Le,Ge=Ie,yt=yl,vt=Ne,ht=fl,kt=st,Pt=cl,xt=dl,St=tl;return _(),W(O,null,[vl,t(vt,{id:"passwordBody"},{default:l(()=>[t(Ge,{xl:{span:16,offset:2},lg:{span:19},md:{span:19}},{default:l(()=>[t(_t,{class:"body-card",style:et({"background-color":ft()?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.4)"})},{header:l(()=>[L("div",hl,[L("div",null,[L("div",kl,[e(v)?(_(),R(z,{key:0,class:"password-table-title"},{default:l(()=>[C(S(e(v).length)+" "+S(e(g)("index.title.passwordCount")),1)]),_:1})):B("",!0),Pl,e(m).showPasswordStrength?(_(),W("div",xl,[t(z,{class:"password-table-strength"},{default:l(()=>[C(S(e(g)("index.title.strength"))+"（ ",1),t(z,{type:"success"},{default:l(()=>[C(S(e(g)("index.title.strength.strong")),1)]),_:1}),C(" : "+S(Fe(3))+" ",1),t(z,{style:{"margin-left":"5px"},type:"warning"},{default:l(()=>[C(S(e(g)("index.title.strength.medium")),1)]),_:1}),C(" : "+S(Fe(2))+" ",1),t(z,{style:{"margin-left":"5px"},type:"danger"},{default:l(()=>[C(S(e(g)("index.title.strength.weak")),1)]),_:1}),C(" : "+S(Fe(1))+"） ",1)]),_:1})])):B("",!0)])]),L("div",Sl,[L("div",null,[t(H,{modelValue:e(b),"onUpdate:modelValue":w[0]||(w[0]=N=>ie(b)?b.value=N:null),style:{"max-width":"300px"},clearable:"",placeholder:e(g)("index.title.search"),"prefix-icon":e(Kt),disabled:!e(A),onKeyup:Qe(r,["enter"])},null,8,["modelValue","placeholder","prefix-icon","disabled","onKeyup"])]),L("div",null,[t(ne,{disabled:!e(A)||!e(G),type:"primary",plain:"",onClick:w[1]||(w[1]=N=>a())},{default:l(()=>[C(S(e(g)("index.title.addPassword")),1)]),_:1},8,["disabled"])]),L("div",null,[e(A)?B("",!0):(_(),R(re,{key:0,content:e(g)("index.title.unlock"),effect:"dark",placement:"top"},{default:l(()=>[t(ne,{disabled:!e($),icon:e(Xt),onClick:U},null,8,["disabled","icon"])]),_:1},8,["content"])),e(A)?(_(),R(re,{key:1,content:e(g)("index.title.lock"),effect:"dark",placement:"top"},{default:l(()=>[t(ne,{icon:e(He),onClick:x},null,8,["icon"])]),_:1},8,["content"])):B("",!0)]),t(we,null,{dropdown:l(()=>[t(Ee,null,{default:l(()=>[t(de,{onClick:K},{default:l(()=>[C(S(e(g)("systemSetting.title")),1)]),_:1}),t(de,{divided:"",onClick:ut},{default:l(()=>[C(S(e(g)("index.title.importExport.import")),1)]),_:1}),t(de,{onClick:mt},{default:l(()=>[C(S(e(g)("index.title.importExport.export")),1)]),_:1}),t(de,{onClick:it},{default:l(()=>[C(S(e(g)("index.title.importExport.download")),1)]),_:1}),t(de,{divided:"",onClick:pt},{default:l(()=>[C(S(e(g)("index.title.logout")),1)]),_:1})]),_:1})]),default:l(()=>[t(ne,{icon:e(Zt)},null,8,["icon"])]),_:1})])])]),default:l(()=>[t(bt,{height:"calc(100vh - 150px)",style:{"background-color":"rgba(0,0,0,0)"},"header-row-style":{"background-color":"rgba(0,0,0,0)"},"header-cell-style":{"background-color":"rgba(0,0,0,0)"},"row-style":{"background-color":"rgba(0,0,0,0)"},"cell-style":{"background-color":"rgba(0,0,0,0)"},data:e(i),"highlight-current-row":"",ref_key:"tableRef",ref:n},{empty:l(()=>[t(ge,{description:e(A)?e(g)("index.table.empty"):e(g)("index.table.lock")},Se({default:l(()=>[t(ne,{onClick:U,plain:"",type:"primary"},{default:l(()=>[C(S(e(g)("index.title.unlock")),1)]),_:1})]),_:2},[e(A)?void 0:{name:"image",fn:l(()=>[t(e(He))]),key:"0"}]),1032,["description"])]),default:l(()=>[e(m).showPasswordStrength?(_(),R(Q,{key:0,sortable:"","sort-method":c,prop:"strength",width:"30px"},{default:l(N=>[le(N.row.password)===3?(_(),R(re,{key:0},{content:l(()=>[C(S(e(g)("index.title.strength")+"："+e(g)("index.title.strength.strong")),1)]),default:l(()=>[Cl]),_:1})):B("",!0),le(N.row.password)===2?(_(),R(re,{key:1},{content:l(()=>[C(S(e(g)("index.title.strength")+"："+e(g)("index.title.strength.medium")),1)]),default:l(()=>[Vl]),_:1})):B("",!0),le(N.row.password)===1?(_(),R(re,{key:2},{content:l(()=>[C(S(e(g)("index.title.strength")+"："+e(g)("index.title.strength.weak")),1)]),default:l(()=>[Tl]),_:1})):B("",!0)]),_:1})):B("",!0),t(Q,{sortable:"",label:e(g)("password.name"),"min-width":"140px",prop:"name"},null,8,["label"]),t(Q,{label:e(g)("password.address"),"min-width":"200px",prop:"address"},{default:l(N=>[e(Ht)(N.row.address)?(_(),R(he,{key:0,href:N.row.address,target:"_blank"},{default:l(()=>[C(S(N.row.address),1)]),_:2},1032,["href"])):(_(),R(z,{key:1},{default:l(()=>[C(S(N.row.address),1)]),_:2},1024))]),_:1},8,["label"]),t(Q,{label:e(g)("password.userName"),"min-width":"120px",prop:"userName"},null,8,["label"]),t(Q,{label:e(g)("password.password"),"min-width":"150px",prop:"password"},{default:l(N=>[N.row.password?(_(),W("div",Ml,[L("span",Fl,[N.row.show?B("",!0):(_(),W(O,{key:0},[C("•••••••")],64)),N.row.show?(_(),W(O,{key:1},[C(S(N.row.password),1)],64)):B("",!0)]),L("div",El,[N.row.show?B("",!0):(_(),R(e(qt),{key:0,onClick:se=>N.row.show=!N.row.show},null,8,["onClick"])),N.row.show?(_(),R(e(Qt),{key:1,onClick:se=>N.row.show=!N.row.show},null,8,["onClick"])):B("",!0),t(e(el),{onClick:se=>e(Ae)(N.row.password)},null,8,["onClick"])])])):B("",!0)]),_:1},8,["label"]),e(m).showLabel!==!1?(_(),R(Q,{key:1,label:e(g)("index.table.label"),"min-width":"130px",prop:"label"},{default:l(N=>[(_(!0),W(O,null,ee(dt(N.row.label),se=>(_(),R(wt,{style:{margin:"3px"},key:se},{default:l(()=>[C(S(se),1)]),_:2},1024))),128))]),_:1},8,["label"])):B("",!0),t(Q,{label:e(g)("password.remark"),"min-width":"100px",prop:"remark"},null,8,["label"]),e(m).showAddTime?(_(),R(Q,{key:2,sortable:"",label:e(g)("password.insertTime"),"min-width":"130px",prop:"insertTime"},null,8,["label"])):B("",!0),e(m).showUpTime?(_(),R(Q,{key:3,sortable:"",label:e(g)("password.updateTime"),"min-width":"130px",prop:"updateTime"},null,8,["label"])):B("",!0),t(Q,{"min-width":"140px",label:e(g)("index.table.operation")},{default:l(N=>[t(he,{type:"success",underline:!1,onClick:se=>D(N.row)},{default:l(()=>[C(S(e(g)("index.table.share")),1)]),_:2},1032,["onClick"]),t(he,{underline:!1,style:{"margin-left":"10px"},type:"primary",onClick:se=>P(N.row)},{default:l(()=>[C(S(e(g)("index.table.edit")),1)]),_:2},1032,["onClick"]),t(gt,{title:e(g)("index.table.operation.affirmDelete"),"confirm-button-text":e(g)("index.table.operation.affirm"),"cancel-button-text":e(g)("index.table.operation.cancel"),onConfirm:se=>j(N.row)},{reference:l(()=>[t(he,{style:{"margin-left":"10px"},underline:!1,type:"danger"},{default:l(()=>[C(S(e(g)("index.table.operation.delete")),1)]),_:1})]),_:2},1032,["title","confirm-button-text","cancel-button-text","onConfirm"])]),_:1},8,["label"])]),_:1},8,["header-row-style","header-cell-style","row-style","cell-style","data"])]),_:1},8,["style"])]),_:1}),t(Ge,{xl:{span:4},lg:{span:5},md:{span:5},class:"hidden-sm-and-down",style:{"padding-left":"15px"}},{default:l(()=>[t(yt,{ref_key:"labelTreeRef",ref:o,onLabelCheckChange:nt,onLabelTreeChange:rt},null,512)]),_:1})]),_:1}),t(ht,{ref_key:"passwordFormRef",ref:M,labelTree:e(s),onAddPassword:E,onUpdatePassword:p},null,8,["labelTree"]),t(kt,{ref_key:"mainPasswordVerifyRef",ref:y,onVerifyPass:Y},null,512),t(Pt,{ref_key:"mainPasswordSettingRef",ref:f,onMainPasswordChange:F},null,512),t(xt,{ref_key:"systemSettingRef",ref:k,onUpdateMainPassword:Ve,onSystemChangeChange:Te},null,512),t(St,{ref_key:"importExportRef",ref:V,labelTree:e(s),onImportComplete:ct},null,8,["labelTree"])],64)}}},la=tt(Dl,[["__scopeId","data-v-b5fb178d"]]);export{la as default};
