import{E as ze}from"./exceljs-6b62d6db.js";import{F as Je}from"./file-saver-38a5c18e.js";import{h as ke}from"./moment-fbc5633a.js";import{u as re}from"./vue-i18n-3214f365.js";import{E as le,a as $e,b as we,c as ge,d as Te,e as Ct,f as St,g as Me,h as Ze,i as Be,j as Ge,k as qe,l as Qe,m as Fe,n as et,o as Ye,p as We,q as Vt,r as Tt,s as tt,t as Mt,u as Ft,v as Et,w as Rt,x as Ut,y as Dt,z as At,A as It,B as Nt,C as zt,D as Lt}from"./element-plus-19fbf28c.js";import{r as T,o as v,c as H,X as j,b as lt,u as e,O as G,I as R,ac as Ee,J as l,a as B,S as t,P as S,Q as C,A as pe,R as X,aj as te,ak as at,w as Oe,_ as st,aq as $t,ar as Bt}from"./@vue-8e6a53e5.js";import{m as Gt}from"./js-md5-11f5a111.js";import{h as Re}from"./@vueuse-9ffc2ac5.js";import{d as fe,s as ae,g as xe,a as Ke,l as ot,u as Yt,b as _e,e as Pe,c as Le,r as Wt,_ as nt,p as rt,f as dt,i as jt}from"./index-7c401780.js";import{u as Ht}from"./vue-router-c2e97886.js";import{_ as Jt}from"./backImg-a3b16eec.js";import{m as Ot,u as Kt,n as Xe,o as Xt,v as Zt,h as qt,r as Qt}from"./@element-plus-169d18e8.js";import"./ali-oss-21f5c855.js";import"./@intlify-6e8dbf92.js";import"./lodash-es-f5bdeb48.js";import"./async-validator-dee29e8b.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./escape-html-cf2a8097.js";import"./normalize-wheel-es-ed76fb12.js";import"./crypto-js-d55471a7.js";import"./vuex-7c7bb3a2.js";import"./cos-js-sdk-v5-31c61e27.js";const el={__name:"ImportExport",emits:["importComplete"],setup(Z,{expose:b,emit:O}){const{t:h}=re(),V=O,r=T(),y=T(),f=T(0),k=n=>{r.value.click(),y.value=n},M=async()=>{if(r.value.files===0)return;f.value=Date.now();const n=new ze.Workbook;n.xlsx.load(r.value.files[0]).then(()=>{n.eachSheet(function(o){if(o.rowCount<2){le.error(h("importExport.data.empty")),r.value.value="";return}let s=[];for(let d=2;d<=o.rowCount;d++){let c=o.getRow(d),F=a(c.getCell(1).value),L=a(c.getCell(2).value),w=a(c.getCell(3).value),x=a(c.getCell(4).value),A=a(c.getCell(5).value),E=a(c.getCell(6).value),J=a(c.getCell(7).value),$=a(c.getCell(8).value);F&&s.push({id:f.value++,name:F,address:L,userName:w,password:x,remark:E,label:_(A),insertTime:J,updateTime:$})}V("importComplete",s,y.value),r.value.value=""})}).catch(o=>{le.error(o),r.value.value=""})},a=n=>n?typeof n=="object"?n instanceof Date?ke(n).format("YYYY-MM-DD HH:mm:ss"):n.text:n.toString():"",_=n=>{if(!n)return"";let o=[],s=n.split("、");for(let d=0;d<s.length;d++){let c=g(y.value,s[d],"");if(c)o.push(c);else{let F=[];z(y.value,s[d].split(">"),0,F);for(let L=0;L<F.length;L++)o.push(F[L])}}return Array.from(new Set(o))},g=(n,o,s)=>{for(let d=0;d<n.length;d++){let c=s?s+">"+n[d].label:n[d].label;if(o===c)return n[d].id;if(n[d].children&&n[d].children.length>0)return g(n[d].children,o,c)}},z=(n,o,s,d)=>{if(!o[s])return;for(let F=0;F<n.length;F++)if(n[F].label===o[s])return o[s+1]||d.push(n[F].id),z(n[F].children,o,s+1,d);let c={id:f.value++,label:o[s],children:[]};n.push(c),o[s+1]||d.push(c.id),z(c.children,o,s+1,d)},U=async(n,o)=>{y.value=o;const s=new ze.Workbook,d=s.addWorksheet("sheet1");d.getCell("A1").value=h("password.name"),d.getCell("B1").value=h("password.address"),d.getCell("C1").value=h("password.userName"),d.getCell("D1").value=h("password.password"),d.getCell("E1").value=h("password.label"),d.getCell("F1").value=h("password.remark"),d.getCell("G1").value=h("password.insertTime"),d.getCell("H1").value=h("password.updateTime");for(let c=0;c<n.length;c++){let F=n[c].insertTime;F||(F=ke().format("YYYY-MM-DD HH:mm:ss")),d.getCell("A"+(c+2)).value=n[c].name,d.getCell("B"+(c+2)).value=n[c].address,d.getCell("C"+(c+2)).value=n[c].userName,d.getCell("D"+(c+2)).value=n[c].password,d.getCell("E"+(c+2)).value=Y(n[c].label),d.getCell("F"+(c+2)).value=n[c].remark,d.getCell("G"+(c+2)).value=F,d.getCell("H"+(c+2)).value=n[c].updateTime}s.xlsx.writeBuffer().then(c=>{let F=new Blob([c],{type:"application/octet-stream"});Je.saveAs(F,h("importExport.exportName")+"_"+ke().format("YYYY-MM-DD HH:mm:ss")+".xlsx")})},Y=n=>{if(!n)return"";let o=[];return P(y.value,n,o,""),o.join("、")},P=(n,o,s,d)=>{for(let c=0;c<n.length;c++){let F=d?d+">"+n[c].label:n[c].label;o.includes(n[c].id)&&s.push(F),n[c].children&&n[c].children.length>0&&P(n[c].children,o,s,F)}};return b({importExcel:k,exportExcel:U,downloadExcelTemplate:()=>{const n=new ze.Workbook,o=n.addWorksheet("sheet1");o.getCell("A1").value=h("password.name"),o.getCell("B1").value=h("password.address"),o.getCell("C1").value=h("password.userName"),o.getCell("D1").value=h("password.password"),o.getCell("E1").value=h("password.label"),o.getCell("F1").value=h("password.remark"),o.getCell("G1").value=h("password.insertTime"),o.getCell("H1").value=h("password.updateTime"),n.xlsx.writeBuffer().then(s=>{let d=new Blob([s],{type:"application/octet-stream"});Je.saveAs(d,h("importExport.importTemplateName")+".xlsx")})}}),(n,o)=>(v(),H("input",{type:"file",onChange:M,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ref_key:"fileUploadInput",ref:r,style:{display:"none"}},null,544))}},tl=["width","height"],je={__name:"GesturePassword",props:{size:{type:Number,default:300},count:{type:Number,default:3},showGesture:{type:Boolean,default:!0}},emits:["complete"],setup(Z,{expose:b,emit:O}){const h=Re(),V=O,r=T();let y=Z;const f=j({padding:y.size*.18,background:h.value?"rgb(20,20,20)":"#fff",failColor:"#F56C6C",passColor:"#67C23A",point:{color:"#409EFF",size:y.size*.023,selected:{range:y.size*.07,color:"#409EFF",size:y.size*.023,madding:{color:"#409EFF",size:y.size*.07,lineWidth:1}}},line:{color:"#409EFF",width:2}}),k=T({}),M=T([]),a=T(!1),_=T("");let g=null;const z=()=>{f.background=h.value?"rgb(20,20,20)":"#fff",g=r.value.getContext("2d"),U()},U=()=>{g.fillStyle=f.background,g.fillRect(0,0,y.size,y.size),k.value=[];let w=(y.size-f.padding*2)/(y.count-1),x=1;for(let A=0;A<y.count;A++)for(let E=0;E<y.count;E++){let J=f.padding+E*w,$=f.padding+A*w,m=w/2,W={id:x,x:J,y:$,startX:J-m,endX:J+m,startY:$-m,endY:$+m,h:w,w};Y(W),k.value[x]=W,x++}},Y=w=>{let x=c(w);x&&y.showGesture&&(g.beginPath(),_.value==="fail"?g.strokeStyle=f.failColor:_.value==="pass"?g.strokeStyle=f.passColor:g.strokeStyle=f.point.selected.madding.color,g.lineWidth=f.point.selected.madding.lineWidth,g.arc(w.x,w.y,f.point.selected.madding.size,0,Math.PI*2),g.stroke()),g.beginPath(),x&&y.showGesture?(_.value==="fail"?g.fillStyle=f.failColor:_.value==="pass"?g.fillStyle=f.passColor:g.fillStyle=f.point.selected.madding.color,g.arc(w.x,w.y,f.point.selected.size,0,Math.PI*2)):(g.fillStyle=f.point.color,g.arc(w.x,w.y,f.point.size,0,Math.PI*2)),g.fill()},P=()=>{a.value=!0},D=()=>{if(!a.value)return;a.value=!1;let w=o();if(w){let x=Gt(w);V("complete",x)}U(),d()},n=w=>{_.value=w,U(),d(),w?setTimeout(()=>{_.value="",M.value=[],U()},500):(M.value=[],U())},o=()=>{let w="";for(let x=0;x<M.value.length;x++)w+=M.value[x].id+",";return w&&(w=w.substring(0,w.length-1)),w},s=w=>{let x=w.offsetX,A=w.offsetY;if(U(),d(x,A),!a.value)return;let E=F(x,A);!E||c(E)||(M.value.push(E),U(),d(x,A))},d=(w,x)=>{if(!y.showGesture)return;let A=F(w,x);if(A&&_.value===""&&(g.beginPath(),g.strokeStyle=f.point.selected.madding.color,g.lineWidth=f.point.selected.madding.lineWidth,g.arc(A.x,A.y,f.point.selected.madding.size,0,Math.PI*2),g.stroke()),M.value.length!==0){g.beginPath(),_.value==="fail"?g.strokeStyle=f.failColor:_.value==="pass"?g.strokeStyle=f.passColor:g.strokeStyle=f.line.color,g.lineWidth=f.line.width,g.lineCap="round",g.moveTo(M.value[0].x,M.value[0].y);for(let E=1;E<M.value.length;E++)g.lineTo(M.value[E].x,M.value[E].y);a.value&&w&&x&&_.value===""&&g.lineTo(w,x),g.stroke()}},c=w=>{for(let x=0;x<M.value.length;x++)if(w.id===M.value[x].id)return!0;return!1},F=(w,x)=>{for(let A in k.value){let E=k.value[A];if(w>E.startX+f.point.selected.range&&w<E.endX-f.point.selected.range&&x>E.startY+f.point.selected.range&&x<E.endY-f.point.selected.range)return E}},L=w=>{let x=w.touches[0].clientX-r.value.offsetLeft,A=w.touches[0].clientY-r.value.offsetTop;s({offsetX:x,offsetY:A})};return lt(()=>{z()}),b({setVerifyStatus:n}),(w,x)=>e(y).size?(v(),H("canvas",{key:0,width:e(y).size,height:e(y).size,ref_key:"canvasRef",ref:r,onMousedown:P,onMouseup:D,onMousemove:x[0]||(x[0]=A=>s(A)),onMouseleave:D,onTouchstart:P,onTouchend:D,onTouchmove:L},null,40,tl)):G("",!0)}},ll={style:{"text-align":"center"}},al={class:"dialog-footer"},sl={__name:"DeleteAccount",emits:["deleteAccount"],setup(Z,{expose:b,emit:O}){const{t:h}=re(),V=O,r=T(),y=j({deleteAccount:!1}),f=T(""),k=T(""),M=()=>{let z=fe(k.value,ae.state.verifyCode);if(z&&z==="password-x"){f.value==="gesture"&&r.value.setVerifyStatus("pass");let U=localStorage.getItem("databaseForm"),Y=fe(xe(),U);if(JSON.parse(Y).keyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){le.error("演示账号不能注销");return}Ke("password.json"),Ke("labelTree.json"),localStorage.removeItem("systemConfig"),le.success(h("systemSetting.deleteAccount.success")),V("deleteAccount")}else f.value==="common"?le.error(h("systemSetting.deleteAccount.mainPasswordError")):r.value.setVerifyStatus("fail")},a=()=>{f.value=ae.state.mainPasswordType,y.deleteAccount=!0},_=z=>{k.value=z,M()},g=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){g.value=document.documentElement.clientWidth<728}),b({showDeleteAccount:a}),(z,U)=>{const Y=$e,P=je,D=we,n=ge,o=Te;return v(),R(o,{fullscreen:e(g),modelValue:e(y).deleteAccount,"onUpdate:modelValue":U[1]||(U[1]=s=>e(y).deleteAccount=s),title:e(h)("systemSetting.deleteAccount"),width:"400px"},Ee({default:l(()=>[t(Y,{type:"error",closable:!1},{default:l(()=>[S(C(e(h)("systemSetting.deleteAccount.text")),1)]),_:1}),B("div",ll,[e(f)==="gesture"?(v(),R(P,{key:0,ref_key:"gesturePasswordRef",ref:r,onComplete:_},null,512)):G("",!0),e(f)==="common"?(v(),R(D,{key:1,modelValue:e(k),"onUpdate:modelValue":U[0]||(U[0]=s=>pe(k)?k.value=s:null),style:{"margin-top":"20px"}},null,8,["modelValue"])):G("",!0)])]),_:2},[e(f)==="common"?{name:"footer",fn:l(()=>[B("span",al,[t(n,{type:"danger",onClick:M},{default:l(()=>[S(C(e(h)("systemSetting.deleteAccount.affirm")),1)]),_:1})])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},ol={style:{"text-align":"center"}},nl={class:"dialog-footer"},rl={__name:"SystemSetting",emits:["updateMainPassword","deleteAccount","systemChangeChange"],setup(Z,{expose:b,emit:O}){const h=Ht(),V=Re(),{t:r,locale:y}=re(),f=O,k=T(),M=j({setting:!1}),a=j({language:"zh-cn",cacheMainPassword:!0,autoGeneratePassword:!0,darkMode:!1,sortRule:"insertTimeDesc",showPasswordStrength:!1,cacheDatabaseForm:!0,showAddTime:!0,showUpTime:!1,verifyShowGesture:!0,showLabel:!0,defaultPasswordRule:{length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}}),_=j([{key:"zh-cn",label:"简体中文"},{key:"en-us",label:"English"}]),g=j([{key:"insertTimeDesc",label:r("systemSetting.sort.insertTimeDesc")},{key:"insertTimeAsc",label:r("systemSetting.sort.insertTimeAsc")},{key:"name",label:r("systemSetting.sort.name")}]),z=j([{key:!1,label:r("systemSetting.topic.light")},{key:!0,label:r("systemSetting.topic.dark")}]),U=j([{key:!0,label:r("systemSetting.cacheMainPassword.enable")},{key:!1,label:r("systemSetting.cacheMainPassword.disabled")}]),Y=j([{key:!0,label:r("systemSetting.showAddTime.enable")},{key:!1,label:r("systemSetting.showAddTime.disabled")}]),P=j([{key:!0,label:r("systemSetting.showUpTime.enable")},{key:!1,label:r("systemSetting.showUpTime.disabled")}]),D=j([{key:!0,label:r("systemSetting.showLabel.enable")},{key:!1,label:r("systemSetting.showLabel.disabled")}]),n=j([{key:!0,label:r("mainPasswordSetting.verify.showGesture.enable")},{key:!1,label:r("mainPasswordSetting.verify.showGesture.disabled")}]),o=j([{key:!0,label:r("systemSetting.cacheDatabaseForm.enable")},{key:!1,label:r("systemSetting.cacheDatabaseForm.disabled")}]),s=j([{key:!0,label:r("passwordForm.autoGeneratePassword.enable")},{key:!1,label:r("passwordForm.autoGeneratePassword.disabled")}]),d=j([{key:!0,label:r("systemSetting.showPasswordStrength.enable")},{key:!1,label:r("systemSetting.showPasswordStrength.disabled")}]);let c=null;const F=()=>{let $=ot();if($)for(let m in $)a[m]=$[m];a.language!==y.value&&(a.language=y.value),c=JSON.stringify(a),M.setting=!0},L=()=>{M.setting=!1},w=()=>{let $=a.defaultPasswordRule;if(!$.number&&!$.symbol&&!$.lowercase&&!$.uppercase){le.error(r("systemSetting.passwordRuleVerify"));return}Yt(a);let m=JSON.parse(c);a.cacheMainPassword!==m.cacheMainPassword&&a.cacheMainPassword===!1&&localStorage.removeItem("mainPasswordCiphertext"),a.cacheDatabaseForm!==m.cacheDatabaseForm&&a.cacheDatabaseForm===!1&&localStorage.removeItem("databaseForm"),a.language!==y.value&&(y.value=a.language,console.log("系统语言设置为：",a.language)),V.value!==a.darkMode&&(V.value=a.darkMode,console.log("暗黑模式设置为：",a.darkMode)),a.sortRule!==m.sortRule&&(f("systemChangeChange","sortChange",a.sortRule),console.log("排序规则设置为：",a.sortRule)),a.showPasswordStrength!==m.showPasswordStrength&&(f("systemChangeChange","showPasswordStrength",a.showPasswordStrength),console.log("是否显示密码强度设置为：",a.showPasswordStrength)),M.setting=!1},x=()=>{localStorage.removeItem("databaseForm"),localStorage.removeItem("mainPasswordCiphertext"),ae.commit("delDatabase"),ae.commit("delDatabaseForm"),h.push("/login")},A=()=>{M.setting=!1,f("updateMainPassword")},E=()=>{M.setting=!1,k.value.showDeleteAccount()},J=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){J.value=document.documentElement.clientWidth<728}),b({logout:x,openSystemSetting:F,showUpdateMainPassword:A}),($,m)=>{const W=Ct,Q=St,q=Me,oe=Ze,de=Be,be=we,ye=Ge,se=qe,ie=ge,Ue=Qe,De=Fe,Ae=$e,Se=Te,Ie=sl;return v(),H(X,null,[t(Se,{fullscreen:e(J),modelValue:e(M).setting,"onUpdate:modelValue":m[16]||(m[16]=i=>e(M).setting=i),title:e(r)("systemSetting.title"),width:"600px"},{footer:l(()=>[B("span",nl,[t(ie,{plain:"",onClick:L},{default:l(()=>[S(C(e(r)("systemSetting.close")),1)]),_:1}),t(ie,{type:"primary",plain:"",onClick:w},{default:l(()=>[S(C(e(r)("systemSetting.save")),1)]),_:1})])]),default:l(()=>[t(De,{model:e(a),"label-width":"120px"},{default:l(()=>[t(Ue,{"tab-position":"left",style:{height:"350px"}},{default:l(()=>[t(se,{label:"常规"},{default:l(()=>[t(q,{label:e(r)("systemSetting.language")},{default:l(()=>[t(Q,{modelValue:e(a).language,"onUpdate:modelValue":m[0]||(m[0]=i=>e(a).language=i)},{default:l(()=>[(v(!0),H(X,null,te(e(_),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(r)("systemSetting.sort")},{default:l(()=>[t(Q,{modelValue:e(a).sortRule,"onUpdate:modelValue":m[1]||(m[1]=i=>e(a).sortRule=i)},{default:l(()=>[(v(!0),H(X,null,te(e(g),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(r)("passwordForm.autoGeneratePassword")},{default:l(()=>[t(Q,{modelValue:e(a).autoGeneratePassword,"onUpdate:modelValue":m[2]||(m[2]=i=>e(a).autoGeneratePassword=i)},{default:l(()=>[(v(!0),H(X,null,te(e(s),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(r)("systemSetting.defaultPasswordRule")},{default:l(()=>[t(ye,{style:{"margin-top":"15px"}},{default:l(()=>[t(de,{span:12},{default:l(()=>[t(oe,{size:"small",modelValue:e(a).defaultPasswordRule.uppercase,"onUpdate:modelValue":m[3]||(m[3]=i=>e(a).defaultPasswordRule.uppercase=i),label:e(r)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(de,{span:12},{default:l(()=>[t(oe,{size:"small",modelValue:e(a).defaultPasswordRule.lowercase,"onUpdate:modelValue":m[4]||(m[4]=i=>e(a).defaultPasswordRule.lowercase=i),label:e(r)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(de,{span:12},{default:l(()=>[t(oe,{size:"small",modelValue:e(a).defaultPasswordRule.number,"onUpdate:modelValue":m[5]||(m[5]=i=>e(a).defaultPasswordRule.number=i),label:e(r)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(de,{span:12},{default:l(()=>[t(oe,{size:"small",modelValue:e(a).defaultPasswordRule.symbol,"onUpdate:modelValue":m[6]||(m[6]=i=>e(a).defaultPasswordRule.symbol=i),label:e(r)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1}),t(de,{span:24},{default:l(()=>[B("div",null,[t(be,{size:"small",style:{position:"relative",top:"3px"},modelValue:e(a).defaultPasswordRule.length,"onUpdate:modelValue":m[7]||(m[7]=i=>e(a).defaultPasswordRule.length=i)},{prepend:l(()=>[S(C(e(r)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["label"])]),_:1}),t(se,{label:"个性化"},{default:l(()=>[t(q,{label:e(r)("systemSetting.topic")},{default:l(()=>[t(Q,{modelValue:e(a).darkMode,"onUpdate:modelValue":m[8]||(m[8]=i=>e(a).darkMode=i)},{default:l(()=>[(v(!0),H(X,null,te(e(z),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(r)("systemSetting.showPasswordStrength")},{default:l(()=>[t(Q,{modelValue:e(a).showPasswordStrength,"onUpdate:modelValue":m[9]||(m[9]=i=>e(a).showPasswordStrength=i)},{default:l(()=>[(v(!0),H(X,null,te(e(d),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(r)("systemSetting.showAddTime")},{default:l(()=>[t(Q,{modelValue:e(a).showAddTime,"onUpdate:modelValue":m[10]||(m[10]=i=>e(a).showAddTime=i)},{default:l(()=>[(v(!0),H(X,null,te(e(Y),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(r)("systemSetting.showUpTime")},{default:l(()=>[t(Q,{modelValue:e(a).showUpTime,"onUpdate:modelValue":m[11]||(m[11]=i=>e(a).showUpTime=i)},{default:l(()=>[(v(!0),H(X,null,te(e(P),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(r)("systemSetting.showLabel")},{default:l(()=>[t(Q,{modelValue:e(a).showLabel,"onUpdate:modelValue":m[12]||(m[12]=i=>e(a).showLabel=i)},{default:l(()=>[(v(!0),H(X,null,te(e(D),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),t(se,{label:"安全"},{default:l(()=>[t(q,{label:e(r)("systemSetting.cacheMainPassword")},{default:l(()=>[t(Q,{modelValue:e(a).cacheMainPassword,"onUpdate:modelValue":m[13]||(m[13]=i=>e(a).cacheMainPassword=i)},{default:l(()=>[(v(!0),H(X,null,te(e(U),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(r)("systemSetting.cacheDatabaseForm")},{default:l(()=>[t(Q,{modelValue:e(a).cacheDatabaseForm,"onUpdate:modelValue":m[14]||(m[14]=i=>e(a).cacheDatabaseForm=i)},{default:l(()=>[(v(!0),H(X,null,te(e(o),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(q,{label:e(r)("mainPasswordSetting.verify.showGesture")},{default:l(()=>[t(Q,{modelValue:e(a).verifyShowGesture,"onUpdate:modelValue":m[15]||(m[15]=i=>e(a).verifyShowGesture=i)},{default:l(()=>[(v(!0),H(X,null,te(e(n),i=>(v(),R(W,{key:i.key,label:i.label,value:i.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),t(se,{label:"其他"},{default:l(()=>[B("div",ol,[t(ie,{plain:"",onClick:A},{default:l(()=>[S(C(e(r)("systemSetting.updateMainPassword")),1)]),_:1}),t(ie,{plain:"",type:"danger",onClick:E},{default:l(()=>[S(C(e(r)("systemSetting.deleteAccount")),1)]),_:1}),t(ie,{type:"warning",plain:"",onClick:x},{default:l(()=>[S(C(e(r)("systemSetting.logout")),1)]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"]),t(Ae,{style:{"margin-top":"20px"},type:"warning"},{default:l(()=>[S(C(e(r)("systemSetting.takeEffect")),1)]),_:1})]),_:1},8,["fullscreen","modelValue","title"]),t(Ie,{ref_key:"deleteAccountRef",ref:k,onDeleteAccount:x},null,512)],64)}}},dl={style:{"text-align":"center"}},il={class:"dialog-footer"},it={__name:"MainPasswordVerify",emits:["verifyPass"],setup(Z,{expose:b,emit:O}){const{t:h}=re(),V=O,r=T(),y=T(""),f=T(""),k=j({verifyMainPassword:!1}),M=D=>{y.value=D,a()},a=()=>{let D=fe(y.value,ae.state.verifyCode);D&&D==="password-x"?(f.value==="gesture"&&r.value.setVerifyStatus("pass"),V("verifyPass",y.value),g(y.value),y.value="",k.verifyMainPassword=!1):f.value==="common"?le.error(h("mainPasswordVerify.form.verify")):r.value.setVerifyStatus("fail")},_=()=>{localStorage.removeItem("mainPasswordCiphertext")},g=D=>{if(_e("cacheMainPassword")===!1)return;let o=xe(),s=Pe(o,D);localStorage.setItem("mainPasswordCiphertext",s)},z=()=>{if(_e("cacheMainPassword")===!1)return null;let n=localStorage.getItem("mainPasswordCiphertext");if(!n)return null;let o=xe(),s=fe(o,n);return s||null},U=()=>_e("verifyShowGesture")!==!1,Y=(D=!0)=>{if(f.value=ae.state.mainPasswordType,!D){k.verifyMainPassword=!0;return}let n=z();if(!n){k.verifyMainPassword=!0;return}let o=fe(n,ae.state.verifyCode);o&&o==="password-x"?V("verifyPass",n):k.verifyMainPassword=!0},P=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){P.value=document.documentElement.clientWidth<728}),b({verifyMainPassword:Y,delLocalMainPassword:_}),(D,n)=>{const o=je,s=we,d=Me,c=Fe,F=ge,L=Te;return v(),R(L,{fullscreen:e(P),modelValue:e(k).verifyMainPassword,"onUpdate:modelValue":n[1]||(n[1]=w=>e(k).verifyMainPassword=w),title:e(h)("mainPasswordVerify.form.title"),width:"400px"},Ee({default:l(()=>[B("div",dl,[e(f)==="gesture"&&e(k).verifyMainPassword?(v(),R(o,{key:0,"show-gesture":U(),ref_key:"gesturePasswordRef",ref:r,onComplete:M},null,8,["show-gesture"])):G("",!0),e(f)==="common"&&e(k).verifyMainPassword?(v(),R(c,{key:1,style:{padding:"10px"}},{default:l(()=>[t(d,null,{default:l(()=>[t(s,{modelValue:e(y),"onUpdate:modelValue":n[0]||(n[0]=w=>pe(y)?y.value=w:null),placeholder:e(h)("mainPasswordVerify.form.mainPassword"),type:"password",onKeyup:at(a,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1})]),_:1})):G("",!0)])]),_:2},[e(f)==="common"?{name:"footer",fn:l(()=>[B("span",il,[t(F,{type:"primary",disabled:!e(y),onClick:a},{default:l(()=>[S(C(e(h)("mainPasswordVerify.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},ul={class:"dialog-footer"},ml={__name:"MainPasswordSetting",emits:["mainPasswordChange"],setup(Z,{expose:b,emit:O}){const{t:h}=re(),V=O,r=T(),y=T(),f=T("gesture"),k=T(""),M=T(""),a=j({mainPassword:!1}),_=T(""),g=n=>{_.value==="setting"?(k.value=n,_.value="affirm",y.value.setVerifyStatus("")):_.value==="affirm"&&(M.value=n,z())},z=()=>{if(k.value!==M.value){le.error(h("mainPasswordSetting.form.passwordsDiff"));return}let n=localStorage.getItem("databaseForm"),o=fe(xe(),n);if(JSON.parse(o).accessKeyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){le.error("演示账号不能修改主密码");return}f.value==="gesture"?ae.commit("setMainPasswordType","gesture"):ae.commit("setMainPasswordType","common"),V("mainPasswordChange",k.value,f.value);let d=_e("cacheMainPassword");if(d||d==null){let c=xe(),F=Pe(c,k.value);localStorage.setItem("mainPasswordCiphertext",F)}k.value="",M.value="",a.mainPassword=!1},U=()=>{_.value="setting",a.mainPassword=!0},Y=()=>{r.value.verifyMainPassword(!1)},P=()=>{f.value==="gesture"&&(_.value="setting"),k.value="",M.value=""},D=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){D.value=document.documentElement.clientWidth<728}),b({settingMainPassword:U,updateMainPassword:Y}),(n,o)=>{const s=$e,d=et,c=je,F=Ye,L=qe,w=we,x=Me,A=Fe,E=Qe,J=ge,$=Te,m=it;return v(),H(X,null,[t($,{fullscreen:e(D),modelValue:e(a).mainPassword,"onUpdate:modelValue":o[4]||(o[4]=W=>e(a).mainPassword=W),title:e(h)("mainPasswordSetting.form.setMainPassword"),width:"470px"},Ee({default:l(()=>[t(s,{type:"error",style:{position:"relative",top:"-10px"},closable:!1},{default:l(()=>[S(C(e(h)("mainPasswordSetting.forget.message")),1)]),_:1}),t(E,{modelValue:e(f),"onUpdate:modelValue":o[3]||(o[3]=W=>pe(f)?f.value=W:null),style:{"margin-top":"10px"},type:"card",onTabChange:P},{default:l(()=>[t(L,{label:e(h)("mainPasswordSetting.passwordType.gesture"),name:"gesture",style:{"text-align":"center"}},{default:l(()=>[B("div",null,[e(_)==="setting"?(v(),R(d,{key:0},{default:l(()=>[S(C(e(h)("mainPasswordSetting.gesture.first")),1)]),_:1})):G("",!0),e(_)==="affirm"?(v(),R(d,{key:1},{default:l(()=>[S(C(e(h)("mainPasswordSetting.gesture.affirm")),1)]),_:1})):G("",!0)]),e(a).mainPassword&&e(f)==="gesture"?(v(),R(c,{key:0,ref_key:"gesturePasswordRef",ref:y,onComplete:g},null,512)):G("",!0),B("div",null,[t(F,{underline:!1,style:{position:"relative",top:"-2px"},type:"primary",onClick:o[0]||(o[0]=W=>_.value="setting")},{default:l(()=>[S(C(e(h)("mainPasswordSetting.gesture.reset")),1)]),_:1})])]),_:1},8,["label"]),t(L,{label:e(h)("mainPasswordSetting.passwordType.common"),name:"common",style:{"text-align":"center"}},{default:l(()=>[t(A,{inline:!0,"label-width":"100px",style:{"margin-top":"20px"}},{default:l(()=>[t(x,{label:e(h)("mainPasswordSetting.form.newMainPassword")},{default:l(()=>[t(w,{type:"password",modelValue:e(k),"onUpdate:modelValue":o[1]||(o[1]=W=>pe(k)?k.value=W:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"]),t(x,{label:e(h)("mainPasswordSetting.form.newMainPasswordAffirm")},{default:l(()=>[t(w,{type:"password",modelValue:e(M),"onUpdate:modelValue":o[2]||(o[2]=W=>pe(M)?M.value=W:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:2},[e(f)==="common"?{name:"footer",fn:l(()=>[B("span",ul,[t(J,{type:"primary",disabled:!e(k),onClick:z},{default:l(()=>[S(C(e(h)("mainPasswordSetting.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"]),t(m,{ref_key:"mainPasswordVerifyRef",ref:r,onVerifyPass:U},null,512)],64)}}},cl={class:"dialog-footer"},pl={__name:"PasswordForm",props:{labelTree:Array},emits:["addPassword","updatePassword"],setup(Z,{expose:b,emit:O}){const h=O,{t:V}=re(),r=T(),y=j({password:!1}),f=T(""),k=j({uppercase:"ABCDEFGHJKLMNPQRSTUVWXYZ",lowercase:"abcdefghjkmnpqrstuvwxyz",number:"0123456789",symbol:"~!@#$^&*()_+.,;"}),M=()=>({id:0,name:"",address:"",userName:"",password:"",remark:"",label:"",insertTime:"",updateTime:""}),a=j(M()),_=j({length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}),g=j({name:[{required:!0,message:V("passwordForm.form.name.verify"),trigger:"blur"}]}),z=()=>{if(!_.number&&!_.symbol&&!_.lowercase&&!_.uppercase){le.error(V("systemSetting.passwordRuleVerify"));return}let o=[];_.lowercase&&o.push(k.lowercase),_.uppercase&&o.push(k.uppercase),_.symbol&&o.push(k.symbol),_.number&&o.push(k.number),a.password=Wt(o,_.length)},U=async o=>{await o.validate(s=>{s&&(y.password=!1,f.value==="add"?(a.id=Date.now(),a.insertTime=ke().format("YYYY-MM-DD HH:mm:ss"),h("addPassword",JSON.parse(JSON.stringify(a)))):(a.updateTime=ke().format("YYYY-MM-DD HH:mm:ss"),h("updatePassword",JSON.parse(JSON.stringify(a)))))})},Y=()=>{let o=_e("defaultPasswordRule");if(o)for(let s in o)_[s]=o[s]},P=()=>{Y();let o=M();for(let d in o)a[d]=o[d];_e("autoGeneratePassword")&&z(),f.value="add",y.password=!0},D=o=>{Y();for(let s in a)a[s]=o[s];f.value="update",y.password=!0},n=()=>document.documentElement.clientWidth;return b({showAddPassword:P,showUpdatePassword:D}),(o,s)=>{const d=we,c=Me,F=ge,L=Be,w=Ge,x=Ze,A=We,E=Vt,J=Fe,$=Tt;return v(),R($,{modelValue:e(y).password,"onUpdate:modelValue":s[13]||(s[13]=m=>e(y).password=m),title:e(f)==="add"?e(V)("passwordForm.form.addPassword"):e(V)("passwordForm.form.editPassword"),size:"620px",direction:n()>768?"rtl":"btt"},{footer:l(()=>[B("span",cl,[t(F,{onClick:s[12]||(s[12]=m=>U(e(r))),type:"primary"},{default:l(()=>[S(C(e(V)("passwordForm.generateForm.save")),1)]),_:1})])]),default:l(()=>[t(J,{ref_key:"passwordFormRef",ref:r,model:e(a),rules:e(g),"label-width":"70px",style:{"padding-right":"30px"}},{default:l(()=>[t(c,{label:e(V)("password.name"),prop:"name"},{default:l(()=>[t(d,{modelValue:e(a).name,"onUpdate:modelValue":s[0]||(s[0]=m=>e(a).name=m),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(c,{label:e(V)("password.address")},{default:l(()=>[t(d,{modelValue:e(a).address,"onUpdate:modelValue":s[1]||(s[1]=m=>e(a).address=m),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(c,{label:e(V)("password.userName")},{default:l(()=>[t(d,{modelValue:e(a).userName,"onUpdate:modelValue":s[2]||(s[2]=m=>e(a).userName=m),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(c,{label:e(V)("password.password")},{default:l(()=>[t(A,{style:{width:"100%"}},{default:l(()=>[t(w,null,{default:l(()=>[t(L,null,{default:l(()=>[t(d,{modelValue:e(a).password,"onUpdate:modelValue":s[4]||(s[4]=m=>e(a).password=m),clearable:""},{append:l(()=>[t(F,{onClick:s[3]||(s[3]=m=>e(Le)(e(a).password))},{default:l(()=>[S(C(e(V)("passwordForm.generateForm.password.copy")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(w,{style:{"margin-top":"15px"}},{default:l(()=>[t(L,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(_).uppercase,"onUpdate:modelValue":s[5]||(s[5]=m=>e(_).uppercase=m),label:e(V)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(L,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(_).lowercase,"onUpdate:modelValue":s[6]||(s[6]=m=>e(_).lowercase=m),label:e(V)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(L,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(_).number,"onUpdate:modelValue":s[7]||(s[7]=m=>e(_).number=m),label:e(V)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(L,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(x,{size:"small",modelValue:e(_).symbol,"onUpdate:modelValue":s[8]||(s[8]=m=>e(_).symbol=m),label:e(V)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1})]),_:1}),t(w,{style:{"margin-top":"15px"}},{default:l(()=>[t(L,{style:{"text-align":"center"}},{default:l(()=>[t(d,{modelValue:e(_).length,"onUpdate:modelValue":s[9]||(s[9]=m=>e(_).length=m),size:"small",style:{width:"120px"}},{prepend:l(()=>[S(C(e(V)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"]),t(F,{plain:"",size:"small",style:{position:"relative",top:"-5px","margin-left":"10px"},type:"success",onClick:z},{default:l(()=>[S(C(e(V)("passwordForm.generateForm.randomPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["label"]),t(c,{label:e(V)("password.label")},{default:l(()=>[t(E,{modelValue:e(a).label,"onUpdate:modelValue":s[10]||(s[10]=m=>e(a).label=m),"value-key":"id",data:Z.labelTree,"check-strictly":"",multiple:"","default-expand-all":"",placeholder:e(V)("password.label.placeholder"),filterable:""},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),t(c,{label:e(V)("password.remark")},{default:l(()=>[t(d,{type:"textarea",placeholder:e(V)("passwordForm.generateForm.remark"),rows:4,modelValue:e(a).remark,"onUpdate:modelValue":s[11]||(s[11]=m=>e(a).remark=m)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","direction"])}}};const fl={class:"label-tree-node"},wl=["onClick","onBlur"],gl={class:"label-tree-node-menu"},_l={__name:"LabelTree",emits:["labelCheckChange","labelTreeChange"],setup(Z,{expose:b,emit:O}){const h=Re(),{t:V}=re(),r=O,y=T(),f=T([]),k=T([]),M=T(!1),a=()=>{let s=y.value.getCheckedNodes();r("labelCheckChange",s)},_=(s,d)=>s?d.label.includes(s):!0,g=s=>{const d={id:Date.now(),label:V("labelTree.addLabel"),children:[]};s.children||(s.children=[]),s.children.push(d)},z=(s,d)=>{const c=s.parent,F=c.data.children||c.data,L=F.findIndex(w=>w.id===d.id);F.splice(L,1)},U=s=>!s.edit,Y=()=>{k.value.push({id:Date.now(),label:V("labelTree.firstAddLabel"),children:[]})},P=()=>{M.value&&rt("labelTree.json",{labelTree:k.value})},D=s=>{k.value=s};Oe(f,s=>{y.value.filter(s)}),Oe(k,()=>{P(),r("labelTreeChange",k.value)},{deep:!0});const n=()=>{dt("labelTree.json").then(s=>{s&&s.labelTree?k.value=s.labelTree:k.value=[],M.value=!0}).catch(s=>{tt.error(s.code)})},o=()=>h.value;return n(),b({setLabelTree:D}),(s,d)=>{const c=we,F=ge,L=Ye,w=Mt,x=Ft,A=We;return v(),R(A,{class:"body-card",style:st({"background-color":o()?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.4)"})},{header:l(()=>[S(C(e(V)("labelTree.title")),1)]),default:l(()=>[t(c,{modelValue:e(f),"onUpdate:modelValue":d[0]||(d[0]=E=>pe(f)?f.value=E:null),clearable:"",placeholder:e(V)("labelTree.search.placeholder")},null,8,["modelValue","placeholder"]),t(x,{height:"35vh"},{default:l(()=>[t(w,{data:e(k),"show-checkbox":"",ref_key:"labelTreeRef",ref:y,draggable:"","node-key":"id",style:{"margin-top":"10px","background-color":"rgba(0,0,0,0)"},onCheck:a,"filter-node-method":_,"expand-on-click-node":!1,"allow-drag":U,"default-expand-all":""},{empty:l(()=>[t(F,{size:"small",type:"primary",plain:"",onClick:Y},{default:l(()=>[S(C(e(V)("labelTree.firstAddLabel")),1)]),_:1})]),default:l(({node:E,data:J})=>[B("span",fl,[E.edit?G("",!0):(v(),H("span",{key:0,onClick:$=>E.edit=!0,onBlur:$=>E.edit=!1},C(J.label),41,wl)),E.edit?(v(),R(c,{key:1,style:{width:"60%"},ref:E.id+"_input",size:"small",onBlur:$=>E.edit=!1,modelValue:J.label,"onUpdate:modelValue":$=>J.label=$},null,8,["onBlur","modelValue","onUpdate:modelValue"])):G("",!0),B("span",gl,[t(L,{onClick:$=>g(J),type:"primary",underline:!1},{default:l(()=>[S(C(e(V)("labelTree.tree.add")),1)]),_:2},1032,["onClick"]),t(L,{onClick:$=>z(E,J),type:"danger",underline:!1,style:{"margin-left":"8px"}},{default:l(()=>[S(C(e(V)("labelTree.tree.remove")),1)]),_:2},1032,["onClick"])])])]),_:1},8,["data"])]),_:1})]),_:1},8,["style"])}}},bl=nt(_l,[["__scopeId","data-v-18737dd1"]]);const Ce=Z=>($t("data-v-0ac4ab03"),Z=Z(),Bt(),Z),yl=Ce(()=>B("img",{alt:"",class:"back-img",src:Jt},null,-1)),vl={style:{display:"flex","justify-content":"space-between"}},hl={class:"hidden-xs-only"},kl=Ce(()=>B("br",null,null,-1)),Pl={key:1},xl={style:{display:"flex","justify-content":"end"},class:"password-title-right"},Cl=Ce(()=>B("div",{class:"password-strength",style:{"background-color":"#67C23A"}},null,-1)),Sl=Ce(()=>B("div",{class:"password-strength",style:{"background-color":"#E6A23C"}},null,-1)),Vl=Ce(()=>B("div",{class:"password-strength",style:{"background-color":"#F56C6C"}},null,-1)),Tl={key:0},Ml={class:"password-text"},Fl={class:"pass-action-div"},El={__name:"IndexPage",setup(Z){const{t:b,locale:O}=re(),h=Re(),V=T(),r=T(),y=T(),f=T(),k=T(),M=T(),a=j({}),_=T(""),g=T(""),z=T(""),U=T(!1),Y=T(""),P=T([]),D=T([]),n=T([]),o=T([]),s=async()=>{if(!_.value&&!n.value){D.value=P.value;return}let u=[];for(let p=0;p<P.value.length;p++){let I=P.value[p].name||"",K=P.value[p].userName||"",ue=P.value[p].address||"",me=P.value[p].remark||"",ce=P.value[p].password||"",Ne=!_.value||I.includes(_.value)||K.includes(_.value)||ue.includes(_.value)||me.includes(_.value)||ce.includes(_.value),ve=!1;if(n.value.length>0)for(let he=0;he<n.value.length;he++){let ee=n.value[he];P.value[p].label&&P.value[p].label.includes(ee.id)&&(ve=!0)}else ve=!0;Ne&&ve&&u.push(P.value[p])}D.value=u},d=()=>{V.value.showAddPassword()},c=u=>{V.value.showUpdatePassword(u)},F=u=>{P.value.unshift(u),se(),s()},L=u=>{for(let p=0;p<P.value.length;p++)if(P.value[p].id===u.id){P.value[p]=u,se(),s();break}},w=()=>{Y.value=Pe(g.value,JSON.stringify(P.value)),U.value=!1,D.value=[],P.value=[],g.value="",r.value.delLocalMainPassword()},x=()=>{r.value.verifyMainPassword()},A=u=>{let p=b("password.name")+": "+u.name+`\r
`;u.address&&(p+=b("password.address")+": "+u.address+`\r
`),u.userName&&(p+=b("password.userName")+": "+u.userName+`\r
`),u.password&&(p+=b("password.password")+": "+u.password+`\r
`),u.remark&&(p+=u.remark+`\r
`),p=p.substring(0,p.length-2),Le(p)},E=u=>{for(let p=0;p<P.value.length;p++)if(P.value[p].id===u.id){P.value.splice(p,1),se(),s(),le.success(b("index.table.delete.success"));break}},J=u=>{g.value=u;let p=fe(u,Y.value);P.value=JSON.parse(p),U.value=!0,s()},$=(u,p)=>{g.value=u,z.value=p,se(),le.success(b("index.mainPassword.changeSuccess"))},m=()=>{f.value.openSystemSetting()},W=()=>{y.value.updateMainPassword()},Q=(u,p)=>{a[u]=p,u==="sortChange"&&q(p)},q=u=>{u==="insertTimeDesc"?ye("insertTime",-1):u==="insertTimeAsc"?ye("insertTime",1):u==="name"&&ye("name",1),se(),s()},oe=u=>{let p=0;return/[0-9]/.test(u)&&p++,/[a-z]/.test(u)&&p++,/[A-Z]/.test(u)&&p++,/[^0-9a-zA-Z_]/.test(u)&&p++,u.length<6&&p>2&&(p=2),de()>2&&p>2&&(p=2),p>3?3:p},de=u=>{let p=0;for(let I=0;I<P.value.length;I++)P.value[I].password===u&&p++;return p},be=u=>{let p=0;for(let I=0;I<P.value.length;I++){if(!P.value[I].password)continue;let K=oe(P.value[I].password);u===K&&p++}return p},ye=(u,p)=>{P.value.sort((I,K)=>(I=I[u],K=K[u],I<K?p*-1:I>K?p*1:0))},se=()=>{if(!U.value)return;Y.value=Pe(g.value,JSON.stringify(P.value));let u=Pe(g.value,"password-x");ae.commit("setVerifyCode",u),rt("password.json",{verifyValue:u,mainPasswordType:z.value,passwordCiphertext:Y.value})},ie=()=>{dt("password.json").then(u=>{if(u.verifyValue){let p=u.verifyValue;z.value=u.mainPasswordType||"common",ae.commit("setVerifyCode",p),ae.commit("setMainPasswordType",z.value),Y.value=u.passwordCiphertext,r.value.verifyMainPassword(!0)}else U.value=!0,y.value.settingMainPassword()}).catch(u=>{console.error(u),tt.error("error-1000："+u)})},Ue=u=>{n.value=u,s()},De=u=>{o.value=u},Ae=u=>{if(!u)return"";let p=[];return Se(o.value,u,p),p},Se=(u,p,I)=>{for(let K=0;K<u.length;K++)p.includes(u[K].id)&&I.push(u[K].label),u[K].children&&u[K].children.length>0&&Se(u[K].children,p,I)},Ie=()=>{k.value.downloadExcelTemplate()},i=()=>{k.value.importExcel(o.value)},ut=()=>{k.value.exportExcel(P.value,o.value)},mt=(u,p)=>{if(u.length!==0){for(let I=u.length-1;I>=0;I--)P.value.unshift(u[I]);M.value.setLabelTree(p),se(),s()}},ct=()=>{f.value.logout()},pt=()=>h.value;return lt(()=>{let u=ot();for(let p in u)a[p]=u[p];a.language&&a.language!==O.value&&(O.value=a.language),ie()}),(u,p)=>{const I=et,K=we,ue=ge,me=Et,ce=Rt,Ne=Ut,ve=Dt,he=At,ee=It,Ve=Ye,ft=Lt,wt=Nt,gt=zt,_t=We,He=Be,bt=bl,yt=Ge,vt=pl,ht=it,kt=ml,Pt=rl,xt=el;return v(),H(X,null,[yl,t(yt,{id:"passwordBody"},{default:l(()=>[t(He,{xl:{span:16,offset:2},lg:{span:19},md:{span:19}},{default:l(()=>[t(_t,{class:"body-card",style:st({"background-color":pt()?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.4)"})},{header:l(()=>[B("div",vl,[B("div",null,[B("div",hl,[e(P)?(v(),R(I,{key:0,class:"password-table-title"},{default:l(()=>[S(C(e(P).length)+" "+C(e(b)("index.title.passwordCount")),1)]),_:1})):G("",!0),kl,e(a).showPasswordStrength?(v(),H("div",Pl,[t(I,{class:"password-table-strength"},{default:l(()=>[S(C(e(b)("index.title.strength"))+"（ ",1),t(I,{type:"success"},{default:l(()=>[S(C(e(b)("index.title.strength.strong")),1)]),_:1}),S(" : "+C(be(3))+" ",1),t(I,{style:{"margin-left":"5px"},type:"warning"},{default:l(()=>[S(C(e(b)("index.title.strength.medium")),1)]),_:1}),S(" : "+C(be(2))+" ",1),t(I,{style:{"margin-left":"5px"},type:"danger"},{default:l(()=>[S(C(e(b)("index.title.strength.weak")),1)]),_:1}),S(" : "+C(be(1))+"） ",1)]),_:1})])):G("",!0)])]),B("div",xl,[B("div",null,[t(K,{modelValue:e(_),"onUpdate:modelValue":p[0]||(p[0]=N=>pe(_)?_.value=N:null),style:{"max-width":"300px"},clearable:"",placeholder:e(b)("index.title.search"),"prefix-icon":e(Ot),disabled:!e(g),onKeyup:at(s,["enter"])},null,8,["modelValue","placeholder","prefix-icon","disabled","onKeyup"])]),B("div",null,[t(ue,{disabled:!e(g)||!e(U),type:"primary",plain:"",onClick:p[1]||(p[1]=N=>d())},{default:l(()=>[S(C(e(b)("index.title.addPassword")),1)]),_:1},8,["disabled"])]),B("div",null,[e(g)?G("",!0):(v(),R(me,{key:0,content:e(b)("index.title.unlock"),effect:"dark",placement:"top"},{default:l(()=>[t(ue,{disabled:!e(Y),icon:e(Kt),onClick:x},null,8,["disabled","icon"])]),_:1},8,["content"])),e(g)?(v(),R(me,{key:1,content:e(b)("index.title.lock"),effect:"dark",placement:"top"},{default:l(()=>[t(ue,{icon:e(Xe),onClick:w},null,8,["icon"])]),_:1},8,["content"])):G("",!0)]),t(ve,null,{dropdown:l(()=>[t(Ne,null,{default:l(()=>[t(ce,{onClick:m},{default:l(()=>[S(C(e(b)("systemSetting.title")),1)]),_:1}),t(ce,{divided:"",onClick:i},{default:l(()=>[S(C(e(b)("index.title.importExport.import")),1)]),_:1}),t(ce,{onClick:ut},{default:l(()=>[S(C(e(b)("index.title.importExport.export")),1)]),_:1}),t(ce,{onClick:Ie},{default:l(()=>[S(C(e(b)("index.title.importExport.download")),1)]),_:1}),t(ce,{divided:"",onClick:ct},{default:l(()=>[S(C(e(b)("index.title.logout")),1)]),_:1})]),_:1})]),default:l(()=>[t(ue,{icon:e(Xt)},null,8,["icon"])]),_:1})])])]),default:l(()=>[t(gt,{height:"calc(100vh - 150px)",style:{"background-color":"rgba(0,0,0,0)"},"header-row-style":{"background-color":"rgba(0,0,0,0)"},"header-cell-style":{"background-color":"rgba(0,0,0,0)"},"row-style":{"background-color":"rgba(0,0,0,0)"},"cell-style":{"background-color":"rgba(0,0,0,0)"},data:e(D)},{empty:l(()=>[t(he,{description:e(g)?e(b)("index.table.empty"):e(b)("index.table.lock")},Ee({default:l(()=>[t(ue,{onClick:x,plain:"",type:"primary"},{default:l(()=>[S(C(e(b)("index.title.unlock")),1)]),_:1})]),_:2},[e(g)?void 0:{name:"image",fn:l(()=>[t(e(Xe))]),key:"0"}]),1032,["description"])]),default:l(()=>[e(a).showPasswordStrength?(v(),R(ee,{key:0,width:"30px"},{default:l(N=>[oe(N.row.password)===3?(v(),R(me,{key:0},{content:l(()=>[S(C(e(b)("index.title.strength")+"："+e(b)("index.title.strength.strong")),1)]),default:l(()=>[Cl]),_:1})):G("",!0),oe(N.row.password)===2?(v(),R(me,{key:1},{content:l(()=>[S(C(e(b)("index.title.strength")+"："+e(b)("index.title.strength.medium")),1)]),default:l(()=>[Sl]),_:1})):G("",!0),oe(N.row.password)===1?(v(),R(me,{key:2},{content:l(()=>[S(C(e(b)("index.title.strength")+"："+e(b)("index.title.strength.weak")),1)]),default:l(()=>[Vl]),_:1})):G("",!0)]),_:1})):G("",!0),t(ee,{label:e(b)("password.name"),"min-width":"140px",prop:"name"},null,8,["label"]),t(ee,{label:e(b)("password.address"),"min-width":"200px",prop:"address"},{default:l(N=>[e(jt)(N.row.address)?(v(),R(Ve,{key:0,href:N.row.address,target:"_blank"},{default:l(()=>[S(C(N.row.address),1)]),_:2},1032,["href"])):(v(),R(I,{key:1},{default:l(()=>[S(C(N.row.address),1)]),_:2},1024))]),_:1},8,["label"]),t(ee,{label:e(b)("password.userName"),"min-width":"120px",prop:"userName"},null,8,["label"]),t(ee,{label:e(b)("password.password"),"min-width":"150px"},{default:l(N=>[N.row.password?(v(),H("div",Tl,[B("span",Ml,[N.row.show?G("",!0):(v(),H(X,{key:0},[S("•••••••")],64)),N.row.show?(v(),H(X,{key:1},[S(C(N.row.password),1)],64)):G("",!0)]),B("div",Fl,[N.row.show?G("",!0):(v(),R(e(Zt),{key:0,onClick:ne=>N.row.show=!N.row.show},null,8,["onClick"])),N.row.show?(v(),R(e(qt),{key:1,onClick:ne=>N.row.show=!N.row.show},null,8,["onClick"])):G("",!0),t(e(Qt),{onClick:ne=>e(Le)(N.row.password)},null,8,["onClick"])])])):G("",!0)]),_:1},8,["label"]),e(a).showLabel!==!1?(v(),R(ee,{key:1,label:e(b)("index.table.label"),"min-width":"130px"},{default:l(N=>[(v(!0),H(X,null,te(Ae(N.row.label),ne=>(v(),R(ft,{style:{margin:"3px"},key:ne},{default:l(()=>[S(C(ne),1)]),_:2},1024))),128))]),_:1},8,["label"])):G("",!0),t(ee,{label:e(b)("password.remark"),"min-width":"100px",prop:"remark"},null,8,["label"]),e(a).showAddTime?(v(),R(ee,{key:2,label:e(b)("password.insertTime"),"min-width":"130px",prop:"insertTime"},null,8,["label"])):G("",!0),e(a).showUpTime?(v(),R(ee,{key:3,label:e(b)("password.updateTime"),"min-width":"130px",prop:"updateTime"},null,8,["label"])):G("",!0),t(ee,{"min-width":"140px",label:e(b)("index.table.operation")},{default:l(N=>[t(Ve,{type:"success",underline:!1,onClick:ne=>A(N.row)},{default:l(()=>[S(C(e(b)("index.table.share")),1)]),_:2},1032,["onClick"]),t(Ve,{underline:!1,style:{"margin-left":"10px"},type:"primary",onClick:ne=>c(N.row)},{default:l(()=>[S(C(e(b)("index.table.edit")),1)]),_:2},1032,["onClick"]),t(wt,{title:e(b)("index.table.operation.affirmDelete"),"confirm-button-text":e(b)("index.table.operation.affirm"),"cancel-button-text":e(b)("index.table.operation.cancel"),onConfirm:ne=>E(N.row)},{reference:l(()=>[t(Ve,{style:{"margin-left":"10px"},underline:!1,type:"danger"},{default:l(()=>[S(C(e(b)("index.table.operation.delete")),1)]),_:1})]),_:2},1032,["title","confirm-button-text","cancel-button-text","onConfirm"])]),_:1},8,["label"])]),_:1},8,["header-row-style","header-cell-style","row-style","cell-style","data"])]),_:1},8,["style"])]),_:1}),t(He,{xl:{span:4},lg:{span:5},md:{span:5},class:"hidden-sm-and-down",style:{"padding-left":"15px"}},{default:l(()=>[t(bt,{ref_key:"labelTreeRef",ref:M,onLabelCheckChange:Ue,onLabelTreeChange:De},null,512)]),_:1})]),_:1}),t(vt,{ref_key:"passwordFormRef",ref:V,labelTree:e(o),onAddPassword:F,onUpdatePassword:L},null,8,["labelTree"]),t(ht,{ref_key:"mainPasswordVerifyRef",ref:r,onVerifyPass:J},null,512),t(kt,{ref_key:"mainPasswordSettingRef",ref:y,onMainPasswordChange:$},null,512),t(Pt,{ref_key:"systemSettingRef",ref:f,onUpdateMainPassword:W,onSystemChangeChange:Q},null,512),t(xt,{ref_key:"importExportRef",ref:k,labelTree:e(o),onImportComplete:mt},null,8,["labelTree"])],64)}}},ta=nt(El,[["__scopeId","data-v-0ac4ab03"]]);export{ta as default};
