import{E as Se}from"./exceljs-dbdf17c5.js";import{F as Ue}from"./file-saver-14352d00.js";import{h as _e}from"./moment-fbc5633a.js";import{u as te}from"./vue-i18n-a2374498.js";import{E as G,a as De,b as de,c as ie,d as xe,e as ul,f as ml,g as ke,h as Le,j as Me,k as Fe,l as Pe,m as pl,n as Ee,o as cl,p as fl,q as Be,r as $e,s as wl,t as _l,u as gl,v as bl,w as vl,x as yl,y as hl,z as xl,A as kl}from"./element-plus-2b0d0b3f.js";import{f as M,o as k,c as J,Z as O,M as A,O as t,a as I,U as l,S as y,T as h,u as e,A as ne,F as q,a7 as oe,R as H,a8 as Ye,h as Ae,b as Pl,a9 as Cl,aw as Vl,ax as Sl}from"./@vue-b395b1c5.js";import{d as le,s as re,a as Ne,g as be,e as ge,_ as ze,p as Oe,b as je}from"./index-af5a2c29.js";import{u as Tl}from"./vue-router-32875d15.js";import{l as He,u as Ml,g as ve,c as Te,r as Fl,i as El}from"./global-cb9f1136.js";import{p as Rl}from"./@vueuse-eaf6c8a7.js";import{M as Ul,Q as Al,R as Ie,S as Nl,v as Il,h as Dl,T as Ll}from"./@element-plus-acb39d11.js";import"./ali-oss-85314bd4.js";import"./@intlify-6e8dbf92.js";import"./lodash-es-21c98b27.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-99793a03.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-900e7f0d.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-72671fae.js";import"./vuex-b47bdb47.js";import"./js-md5-80305e46.js";import"./crypto-js-0173151c.js";const Bl={__name:"ImportExport",emits:["importComplete"],setup(K,{expose:f,emit:j}){const{t:c}=te(),x=j,u=M(),g=M(),P=M(0),N=s=>{u.value.click(),g.value=s},C=async()=>{if(u.value.files===0)return;P.value=Date.now();const s=new Se.Workbook;s.xlsx.load(u.value.files[0]).then(()=>{s.eachSheet(function(r){if(r.rowCount<2){G.error(c("importExport.data.empty")),u.value.value="";return}let n=[];for(let d=2;d<=r.rowCount;d++){let m=r.getRow(d),b=a(m.getCell(1).value),w=a(m.getCell(2).value),B=a(m.getCell(3).value),U=a(m.getCell(4).value),L=a(m.getCell(5).value),z=a(m.getCell(6).value),W=a(m.getCell(7).value),ae=a(m.getCell(8).value);b&&n.push({id:P.value++,name:b,address:w,userName:B,password:U,remark:z,label:v(L),insertTime:W,updateTime:ae})}x("importComplete",n,g.value),u.value.value=""})}).catch(r=>{G.error(r),u.value.value=""})},a=s=>s?typeof s=="object"?s instanceof Date?_e(s).format("YYYY-MM-DD HH:mm:ss"):s.text:s.toString():"",v=s=>{if(!s)return"";let r=[],n=s.split("、");for(let d=0;d<n.length;d++){let m=R(g.value,n[d],"");if(m)r.push(m);else{let b=[];V(g.value,n[d].split(">"),0,b);for(let w=0;w<b.length;w++)r.push(b[w])}}return Array.from(new Set(r))},R=(s,r,n)=>{for(let d=0;d<s.length;d++){let m=n?n+">"+s[d].label:s[d].label;if(r===m)return s[d].id;if(s[d].children&&s[d].children.length>0)return R(s[d].children,r,m)}},V=(s,r,n,d)=>{if(!r[n])return;for(let b=0;b<s.length;b++)if(s[b].label===r[n])return r[n+1]||d.push(s[b].id),V(s[b].children,r,n+1,d);let m={id:P.value++,label:r[n],children:[]};s.push(m),r[n+1]||d.push(m.id),V(m.children,r,n+1,d)},p=async(s,r)=>{g.value=r;const n=new Se.Workbook,d=n.addWorksheet("sheet1");d.getCell("A1").value=c("password.name"),d.getCell("B1").value=c("password.address"),d.getCell("C1").value=c("password.userName"),d.getCell("D1").value=c("password.password"),d.getCell("E1").value=c("password.label"),d.getCell("F1").value=c("password.remark"),d.getCell("G1").value=c("password.insertTime"),d.getCell("H1").value=c("password.updateTime");for(let m=0;m<s.length;m++){let b=s[m].insertTime;b||(b=_e().format("YYYY-MM-DD HH:mm:ss")),d.getCell("A"+(m+2)).value=s[m].name,d.getCell("B"+(m+2)).value=s[m].address,d.getCell("C"+(m+2)).value=s[m].userName,d.getCell("D"+(m+2)).value=s[m].password,d.getCell("E"+(m+2)).value=S(s[m].label),d.getCell("F"+(m+2)).value=s[m].remark,d.getCell("G"+(m+2)).value=b,d.getCell("H"+(m+2)).value=s[m].updateTime}n.xlsx.writeBuffer().then(m=>{let b=new Blob([m],{type:"application/octet-stream"});Ue.saveAs(b,c("importExport.exportName")+"_"+_e().format("YYYY-MM-DD HH:mm:ss")+".xlsx")})},S=s=>{if(!s)return"";let r=[];return D(g.value,s,r,""),r.join("、")},D=(s,r,n,d)=>{for(let m=0;m<s.length;m++){let b=d?d+">"+s[m].label:s[m].label;r.includes(s[m].id)&&n.push(b),s[m].children&&s[m].children.length>0&&D(s[m].children,r,n,b)}};return f({importExcel:N,exportExcel:p,downloadExcelTemplate:()=>{const s=new Se.Workbook,r=s.addWorksheet("sheet1");r.getCell("A1").value=c("password.name"),r.getCell("B1").value=c("password.address"),r.getCell("C1").value=c("password.userName"),r.getCell("D1").value=c("password.password"),r.getCell("E1").value=c("password.label"),r.getCell("F1").value=c("password.remark"),r.getCell("G1").value=c("password.insertTime"),r.getCell("H1").value=c("password.updateTime"),s.xlsx.writeBuffer().then(n=>{let d=new Blob([n],{type:"application/octet-stream"});Ue.saveAs(d,c("importExport.importTemplateName")+".xlsx")})}}),(s,r)=>(k(),J("input",{type:"file",onChange:C,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ref_key:"fileUploadInput",ref:u,style:{display:"none"}},null,544))}},$l={class:"dialog-footer"},Yl={__name:"DeleteAccount",emits:["deleteAccount"],setup(K,{expose:f,emit:j}){const{t:c}=te(),x=j,u=O({deleteAccount:!1}),g=M(""),P=()=>{let C=le(g.value,re.state.verifyCode);C&&C==="password-x"?(Ne("password.json"),Ne("groupTree.json"),localStorage.removeItem("systemConfig"),G.success(c("systemSetting.deleteAccount.success")),x("deleteAccount")):G.error(c("systemSetting.deleteAccount.mainPasswordError"))};return f({showDeleteAccount:()=>{u.deleteAccount=!0}}),(C,a)=>{const v=De,R=de,V=ie,p=xe;return k(),A(p,{modelValue:e(u).deleteAccount,"onUpdate:modelValue":a[1]||(a[1]=S=>e(u).deleteAccount=S),title:e(c)("systemSetting.deleteAccount"),width:"400px"},{footer:t(()=>[I("span",$l,[l(V,{type:"danger",onClick:P},{default:t(()=>[y(h(e(c)("systemSetting.deleteAccount.affirm")),1)]),_:1})])]),default:t(()=>[l(v,{type:"danger"},{default:t(()=>[y(h(e(c)("systemSetting.deleteAccount.text")),1)]),_:1}),l(R,{modelValue:e(g),"onUpdate:modelValue":a[0]||(a[0]=S=>ne(g)?g.value=S:null),style:{"margin-top":"20px"}},null,8,["modelValue"])]),_:1},8,["modelValue","title"])}}},zl={class:"dialog-footer"},Ol={__name:"SystemSetting",emits:["updateMainPassword","deleteAccount","systemChangeChange"],setup(K,{expose:f,emit:j}){const c=Tl(),x=Rl(),{t:u,locale:g}=te(),P=j,N=M(),C=O({setting:!1}),a=O({language:"zh-cn",cacheMainPassword:!0,autoGeneratePassword:!0,darkMode:!1,sortRule:"insertTimeDesc",showPasswordStrength:!1,defaultPasswordRule:{length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}}),v=O([{key:"zh-cn",label:"简体中文"},{key:"en-us",label:"English"}]),R=O([{key:"insertTimeDesc",label:u("systemSetting.sort.insertTimeDesc")},{key:"insertTimeAsc",label:u("systemSetting.sort.insertTimeAsc")},{key:"name",label:u("systemSetting.sort.name")}]),V=O([{key:!1,label:u("systemSetting.topic.light")},{key:!0,label:u("systemSetting.topic.dark")}]),p=O([{key:!0,label:u("systemSetting.cacheMainPassword.enable")},{key:!1,label:u("systemSetting.cacheMainPassword.disabled")}]),S=O([{key:!0,label:u("passwordForm.autoGeneratePassword.enable")},{key:!1,label:u("passwordForm.autoGeneratePassword.disabled")}]),D=O([{key:!0,label:u("systemSetting.showPasswordStrength.enable")},{key:!1,label:u("systemSetting.showPasswordStrength.disabled")}]);let Y=null;const s=()=>{let b=He();if(b)for(let w in b)a[w]=b[w];a.language!==g.value&&(a.language=g.value),Y=JSON.stringify(a),C.setting=!0},r=()=>{let b=a.defaultPasswordRule;if(!b.number&&!b.symbol&&!b.lowercase&&!b.uppercase){G.error(u("systemSetting.passwordRuleVerify"));return}Ml(a),a.cacheMainPassword===!1&&localStorage.removeItem("mainPasswordCiphertext");let w=JSON.parse(Y);a.language!==g.value&&(g.value=a.language,console.log("系统语言设置为：",a.language)),x.value!==a.darkMode&&(x.value=a.darkMode,console.log("暗黑模式设置为：",a.darkMode)),a.sortRule!==w.sortRule&&(P("systemChangeChange","sortChange",a.sortRule),console.log("排序规则设置为：",a.sortRule)),a.showPasswordStrength!==w.showPasswordStrength&&(P("systemChangeChange","showPasswordStrength",a.showPasswordStrength),console.log("是否显示密码强度设置为：",a.showPasswordStrength)),C.setting=!1},n=()=>{localStorage.removeItem("ossForm"),localStorage.removeItem("mainPasswordCiphertext"),re.commit("delOss"),c.push("/login")},d=()=>{let b=localStorage.getItem("ossForm"),w=le(be(),b);if(JSON.parse(w).accessKeyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){G.error("演示账号不能修改主密码");return}C.setting=!1,P("updateMainPassword")},m=()=>{let b=localStorage.getItem("ossForm"),w=le(be(),b);if(JSON.parse(w).accessKeyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){G.error("演示账号不能注销");return}C.setting=!1,N.value.showDeleteAccount()};return f({openSystemSetting:s,showUpdateMainPassword:d}),(b,w)=>{const B=ul,U=ml,L=ke,z=Le,W=Me,ae=de,F=Fe,ue=ie,me=Pe,Ve=xe,ce=Yl;return k(),J(q,null,[l(Ve,{modelValue:e(C).setting,"onUpdate:modelValue":w[11]||(w[11]=_=>e(C).setting=_),title:e(u)("systemSetting.title"),width:"600px"},{footer:t(()=>[I("span",zl,[l(ue,{type:"primary",onClick:r},{default:t(()=>[y(h(e(u)("systemSetting.save")),1)]),_:1})])]),default:t(()=>[l(me,{model:e(a),"label-width":"150px"},{default:t(()=>[l(L,{label:e(u)("systemSetting.language")},{default:t(()=>[l(U,{modelValue:e(a).language,"onUpdate:modelValue":w[0]||(w[0]=_=>e(a).language=_)},{default:t(()=>[(k(!0),J(q,null,oe(e(v),_=>(k(),A(B,{key:_.key,label:_.label,value:_.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(L,{label:e(u)("systemSetting.sort")},{default:t(()=>[l(U,{modelValue:e(a).sortRule,"onUpdate:modelValue":w[1]||(w[1]=_=>e(a).sortRule=_)},{default:t(()=>[(k(!0),J(q,null,oe(e(R),_=>(k(),A(B,{key:_.key,label:_.label,value:_.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(L,{label:e(u)("systemSetting.topic")},{default:t(()=>[l(U,{modelValue:e(a).darkMode,"onUpdate:modelValue":w[2]||(w[2]=_=>e(a).darkMode=_)},{default:t(()=>[(k(!0),J(q,null,oe(e(V),_=>(k(),A(B,{key:_.key,label:_.label,value:_.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(L,{label:e(u)("systemSetting.cacheMainPassword")},{default:t(()=>[l(U,{modelValue:e(a).cacheMainPassword,"onUpdate:modelValue":w[3]||(w[3]=_=>e(a).cacheMainPassword=_)},{default:t(()=>[(k(!0),J(q,null,oe(e(p),_=>(k(),A(B,{key:_.key,label:_.label,value:_.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(L,{label:e(u)("passwordForm.autoGeneratePassword")},{default:t(()=>[l(U,{modelValue:e(a).autoGeneratePassword,"onUpdate:modelValue":w[4]||(w[4]=_=>e(a).autoGeneratePassword=_)},{default:t(()=>[(k(!0),J(q,null,oe(e(S),_=>(k(),A(B,{key:_.key,label:_.label,value:_.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(L,{label:e(u)("systemSetting.showPasswordStrength")},{default:t(()=>[l(U,{modelValue:e(a).showPasswordStrength,"onUpdate:modelValue":w[5]||(w[5]=_=>e(a).showPasswordStrength=_)},{default:t(()=>[(k(!0),J(q,null,oe(e(D),_=>(k(),A(B,{key:_.key,label:_.label,value:_.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(L,{label:e(u)("systemSetting.defaultPasswordRule")},{default:t(()=>[l(F,{style:{"margin-top":"15px"}},{default:t(()=>[l(W,{span:8},{default:t(()=>[l(z,{size:"small",modelValue:e(a).defaultPasswordRule.uppercase,"onUpdate:modelValue":w[6]||(w[6]=_=>e(a).defaultPasswordRule.uppercase=_),label:e(u)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),l(W,{span:8},{default:t(()=>[l(z,{size:"small",modelValue:e(a).defaultPasswordRule.lowercase,"onUpdate:modelValue":w[7]||(w[7]=_=>e(a).defaultPasswordRule.lowercase=_),label:e(u)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),l(W,{span:8},{default:t(()=>[l(z,{size:"small",modelValue:e(a).defaultPasswordRule.number,"onUpdate:modelValue":w[8]||(w[8]=_=>e(a).defaultPasswordRule.number=_),label:e(u)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),l(W,{span:8},{default:t(()=>[l(z,{size:"small",modelValue:e(a).defaultPasswordRule.symbol,"onUpdate:modelValue":w[9]||(w[9]=_=>e(a).defaultPasswordRule.symbol=_),label:e(u)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1}),l(W,{span:8},{default:t(()=>[I("div",null,[l(ae,{size:"small",style:{position:"relative",top:"3px"},modelValue:e(a).defaultPasswordRule.length,"onUpdate:modelValue":w[10]||(w[10]=_=>e(a).defaultPasswordRule.length=_)},{prepend:t(()=>[y(h(e(u)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["label"]),l(L,null,{default:t(()=>[l(ue,{plain:"",onClick:d},{default:t(()=>[y(h(e(u)("systemSetting.updateMainPassword")),1)]),_:1}),l(ue,{plain:"",type:"danger",onClick:m},{default:t(()=>[y(h(e(u)("systemSetting.deleteAccount")),1)]),_:1}),l(ue,{type:"warning",plain:"",onClick:n},{default:t(()=>[y(h(e(u)("systemSetting.logout")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(ce,{ref_key:"deleteAccountRef",ref:N,onDeleteAccount:n},null,512)],64)}}},jl={class:"dialog-footer"},Hl={__name:"MainPasswordSetting",emits:["mainPasswordChange"],setup(K,{expose:f,emit:j}){const{t:c}=te(),x=j,u=M(""),g=M(""),P=M(""),N=O({mainPassword:!1}),C=M(""),a=()=>{if(C.value==="update"){let p=le(u.value,re.state.verifyCode);if(!p||p!=="password-x"){G.error(c("mainPasswordSetting.form.mainPasswordError"));return}}if(g.value!==P.value){G.error(c("mainPasswordSetting.form.passwordsDiff"));return}x("mainPasswordChange",g.value);let V=ve("cacheMainPassword");if(V||V==null){let p=be(),S=ge(p,g.value);localStorage.setItem("mainPasswordCiphertext",S)}u.value="",g.value="",P.value="",N.mainPassword=!1};return f({initMainPassword:()=>{C.value="init",N.mainPassword=!0},showUpdateMainPassword:()=>{C.value="update",N.mainPassword=!0}}),(V,p)=>{const S=de,D=ke,Y=Pe,s=pl,r=ie,n=xe;return k(),A(n,{modelValue:e(N).mainPassword,"onUpdate:modelValue":p[3]||(p[3]=d=>e(N).mainPassword=d),title:e(c)("mainPasswordSetting.form.setMainPassword"),width:"430px","close-on-click-modal":e(C)==="update","close-on-press-escape":e(C)==="update","show-close":e(C)==="update"},{footer:t(()=>[I("span",jl,[l(r,{type:"primary",disabled:!e(g),onClick:a},{default:t(()=>[y(h(e(c)("mainPasswordSetting.form.save")),1)]),_:1},8,["disabled"])])]),default:t(()=>[l(Y,{inline:!0,"label-width":"100px",style:{"margin-top":"20px"}},{default:t(()=>[e(C)==="update"?(k(),A(D,{key:0,label:e(c)("mainPasswordSetting.form.currentPassword")},{default:t(()=>[l(S,{type:"password",modelValue:e(u),"onUpdate:modelValue":p[0]||(p[0]=d=>ne(u)?u.value=d:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"])):H("",!0),l(D,{label:e(c)("mainPasswordSetting.form.newMainPassword")},{default:t(()=>[l(S,{type:"password",modelValue:e(g),"onUpdate:modelValue":p[1]||(p[1]=d=>ne(g)?g.value=d:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"]),l(D,{label:e(c)("mainPasswordSetting.form.newMainPasswordAffirm")},{default:t(()=>[l(S,{type:"password",modelValue:e(P),"onUpdate:modelValue":p[2]||(p[2]=d=>ne(P)?P.value=d:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),l(s,{type:"error",style:{position:"relative",top:"10px"},closable:!1},{default:t(()=>[y(h(e(c)("mainPasswordSetting.forget.message")),1)]),_:1})]),_:1},8,["modelValue","title","close-on-click-modal","close-on-press-escape","show-close"])}}},Jl={class:"dialog-footer"},Gl={__name:"MainPasswordVerify",emits:["verifyPass"],setup(K,{expose:f,emit:j}){const{t:c}=te(),x=j,u=M(""),g=O({verifyMainPassword:!1}),P=()=>{let R=le(u.value,re.state.verifyCode);R&&R==="password-x"?(x("verifyPass",u.value),C(u.value),u.value="",g.verifyMainPassword=!1):G.error(c("mainPasswordVerify.form.verify"))},N=()=>{localStorage.removeItem("mainPasswordCiphertext")},C=R=>{if(ve("cacheMainPassword")===!1)return;let p=be(),S=ge(p,R);localStorage.setItem("mainPasswordCiphertext",S)},a=()=>{if(ve("cacheMainPassword")===!1)return null;let V=localStorage.getItem("mainPasswordCiphertext");if(!V)return null;let p=be(),S=le(p,V);return S||null};return f({verifyMainPassword:()=>{let R=a();if(!R){g.verifyMainPassword=!0;return}let V=le(R,re.state.verifyCode);V&&V==="password-x"?x("verifyPass",R):g.verifyMainPassword=!0},delLocalMainPassword:N}),(R,V)=>{const p=de,S=ke,D=Pe,Y=ie,s=xe;return k(),A(s,{modelValue:e(g).verifyMainPassword,"onUpdate:modelValue":V[1]||(V[1]=r=>e(g).verifyMainPassword=r),title:e(c)("mainPasswordVerify.form.title"),width:"400px"},{footer:t(()=>[I("span",Jl,[l(Y,{type:"primary",disabled:!e(u),onClick:P},{default:t(()=>[y(h(e(c)("mainPasswordVerify.form.save")),1)]),_:1},8,["disabled"])])]),default:t(()=>[l(D,{style:{padding:"10px"}},{default:t(()=>[l(S,null,{default:t(()=>[l(p,{modelValue:e(u),"onUpdate:modelValue":V[0]||(V[0]=r=>ne(u)?u.value=r:null),placeholder:e(c)("mainPasswordVerify.form.mainPassword"),type:"password",onKeyup:Ye(P,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])}}},Kl={class:"dialog-footer"},Wl={__name:"PasswordForm",props:{labelTree:Array},emits:["addPassword","updatePassword"],setup(K,{expose:f,emit:j}){const c=j,{t:x}=te(),u=M(),g=O({password:!1}),P=M(""),N=O({uppercase:"ABCDEFGHJKLMNPQRSTUVWXYZ",lowercase:"abcdefghjkmnpqrstuvwxyz",number:"0123456789",symbol:"~!@#$^&*()_+.,;"}),C=()=>({id:0,name:"",address:"",userName:"",password:"",remark:"",label:"",insertTime:"",updateTime:""}),a=O(C()),v=O({length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}),R=O({name:[{required:!0,message:x("passwordForm.form.name.verify"),trigger:"blur"}]}),V=()=>{if(!v.number&&!v.symbol&&!v.lowercase&&!v.uppercase){G.error(x("systemSetting.passwordRuleVerify"));return}let r=[];v.lowercase&&r.push(N.lowercase),v.uppercase&&r.push(N.uppercase),v.symbol&&r.push(N.symbol),v.number&&r.push(N.number),a.password=Fl(r,v.length)},p=async r=>{await r.validate(n=>{n&&(g.password=!1,P.value==="add"?(a.id=Date.now(),a.insertTime=_e().format("YYYY-MM-DD HH:mm:ss"),c("addPassword",JSON.parse(JSON.stringify(a)))):(a.updateTime=_e().format("YYYY-MM-DD HH:mm:ss"),c("updatePassword",JSON.parse(JSON.stringify(a)))))})},S=()=>{let r=ve("defaultPasswordRule");if(r)for(let n in r)v[n]=r[n]},D=()=>{S();let r=C();for(let d in r)a[d]=r[d];ve("autoGeneratePassword")&&V(),P.value="add",g.password=!0},Y=r=>{S();for(let n in a)a[n]=r[n];P.value="update",g.password=!0},s=()=>document.documentElement.clientWidth;return f({showAddPassword:D,showUpdatePassword:Y}),(r,n)=>{const d=de,m=ke,b=ie,w=Me,B=Fe,U=Le,L=Ee,z=cl,W=Pe,ae=fl;return k(),A(ae,{modelValue:e(g).password,"onUpdate:modelValue":n[13]||(n[13]=F=>e(g).password=F),title:e(P)==="add"?e(x)("passwordForm.form.addPassword"):e(x)("passwordForm.form.editPassword"),size:"620px",direction:s()>768?"rtl":"btt"},{footer:t(()=>[I("span",Kl,[l(b,{onClick:n[12]||(n[12]=F=>p(e(u))),type:"primary"},{default:t(()=>[y(h(e(x)("passwordForm.generateForm.save")),1)]),_:1})])]),default:t(()=>[l(W,{ref_key:"passwordFormRef",ref:u,model:e(a),rules:e(R),"label-width":"70px",style:{"padding-right":"30px"}},{default:t(()=>[l(m,{label:e(x)("password.name"),prop:"name"},{default:t(()=>[l(d,{modelValue:e(a).name,"onUpdate:modelValue":n[0]||(n[0]=F=>e(a).name=F),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),l(m,{label:e(x)("password.address")},{default:t(()=>[l(d,{modelValue:e(a).address,"onUpdate:modelValue":n[1]||(n[1]=F=>e(a).address=F),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),l(m,{label:e(x)("password.userName")},{default:t(()=>[l(d,{modelValue:e(a).userName,"onUpdate:modelValue":n[2]||(n[2]=F=>e(a).userName=F),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),l(m,{label:e(x)("password.password")},{default:t(()=>[l(L,{style:{width:"100%"}},{default:t(()=>[l(B,null,{default:t(()=>[l(w,null,{default:t(()=>[l(d,{modelValue:e(a).password,"onUpdate:modelValue":n[4]||(n[4]=F=>e(a).password=F),clearable:""},{append:t(()=>[l(b,{onClick:n[3]||(n[3]=F=>e(Te)(e(a).password))},{default:t(()=>[y(h(e(x)("passwordForm.generateForm.password.copy")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(B,{style:{"margin-top":"15px"}},{default:t(()=>[l(w,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:t(()=>[l(U,{size:"small",modelValue:e(v).uppercase,"onUpdate:modelValue":n[5]||(n[5]=F=>e(v).uppercase=F),label:e(x)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),l(w,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:t(()=>[l(U,{size:"small",modelValue:e(v).lowercase,"onUpdate:modelValue":n[6]||(n[6]=F=>e(v).lowercase=F),label:e(x)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),l(w,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:t(()=>[l(U,{size:"small",modelValue:e(v).number,"onUpdate:modelValue":n[7]||(n[7]=F=>e(v).number=F),label:e(x)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),l(w,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:t(()=>[l(U,{size:"small",modelValue:e(v).symbol,"onUpdate:modelValue":n[8]||(n[8]=F=>e(v).symbol=F),label:e(x)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1})]),_:1}),l(B,{style:{"margin-top":"15px"}},{default:t(()=>[l(w,{style:{"text-align":"center"}},{default:t(()=>[l(d,{modelValue:e(v).length,"onUpdate:modelValue":n[9]||(n[9]=F=>e(v).length=F),size:"small",style:{width:"120px"}},{prepend:t(()=>[y(h(e(x)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"]),l(b,{plain:"",size:"small",style:{position:"relative",top:"-5px","margin-left":"10px"},type:"success",onClick:V},{default:t(()=>[y(h(e(x)("passwordForm.generateForm.randomPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["label"]),l(m,{label:e(x)("password.label")},{default:t(()=>[l(z,{modelValue:e(a).label,"onUpdate:modelValue":n[10]||(n[10]=F=>e(a).label=F),"value-key":"id",data:K.labelTree,"check-strictly":"",multiple:"","default-expand-all":"",placeholder:e(x)("password.label.placeholder"),filterable:""},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),l(m,{label:e(x)("password.remark")},{default:t(()=>[l(d,{type:"textarea",placeholder:e(x)("passwordForm.generateForm.remark"),rows:4,modelValue:e(a).remark,"onUpdate:modelValue":n[11]||(n[11]=F=>e(a).remark=F)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","direction"])}}};const Zl={class:"label-tree-node"},ql=["onClick","onBlur"],Ql={class:"label-tree-node-menu"},Xl={__name:"LabelTree",emits:["labelCheckChange","labelTreeChange"],setup(K,{expose:f,emit:j}){const{t:c}=te(),x=j,u=M(),g=M([]),P=M([]),N=M(!1),C=()=>{let s=u.value.getCheckedNodes();x("labelCheckChange",s)},a=(s,r)=>s?r.label.includes(s):!0,v=s=>{const r={id:Date.now(),label:c("labelTree.addLabel"),children:[]};s.children||(s.children=[]),s.children.push(r)},R=(s,r)=>{const n=s.parent,d=n.data.children||n.data,m=d.findIndex(b=>b.id===r.id);d.splice(m,1)},V=s=>!s.edit,p=()=>{P.value.push({id:Date.now(),label:c("labelTree.firstAddLabel"),children:[]})},S=()=>{N.value&&Oe("labelTree.json",{labelTree:P.value})},D=s=>{P.value=s};return Ae(g,s=>{u.value.filter(s)}),Ae(P,()=>{S(),x("labelTreeChange",P.value)},{deep:!0}),(()=>{je("labelTree.json").then(s=>{s&&s.labelTree?P.value=s.labelTree:P.value=[],N.value=!0}).catch(s=>{Be.error(s.code)})})(),f({setLabelTree:D}),(s,r)=>{const n=de,d=ie,m=$e,b=wl,w=_l,B=Ee;return k(),A(B,null,{header:t(()=>[y(h(e(c)("labelTree.title")),1)]),default:t(()=>[l(n,{modelValue:e(g),"onUpdate:modelValue":r[0]||(r[0]=U=>ne(g)?g.value=U:null),clearable:"",placeholder:e(c)("labelTree.search.placeholder")},null,8,["modelValue","placeholder"]),l(w,{height:"35vh"},{default:t(()=>[l(b,{data:e(P),"show-checkbox":"",ref_key:"labelTreeRef",ref:u,draggable:"","node-key":"id",style:{"margin-top":"10px"},onCheck:C,"filter-node-method":a,"expand-on-click-node":!1,"allow-drag":V,"default-expand-all":""},{empty:t(()=>[l(d,{size:"small",type:"primary",plain:"",onClick:p},{default:t(()=>[y(h(e(c)("labelTree.firstAddLabel")),1)]),_:1})]),default:t(({node:U,data:L})=>[I("span",Zl,[U.edit?H("",!0):(k(),J("span",{key:0,onClick:z=>U.edit=!0,onBlur:z=>U.edit=!1},h(L.label),41,ql)),U.edit?(k(),A(n,{key:1,style:{width:"60%"},ref:U.id+"_input",size:"small",onBlur:z=>U.edit=!1,modelValue:L.label,"onUpdate:modelValue":z=>L.label=z},null,8,["onBlur","modelValue","onUpdate:modelValue"])):H("",!0),I("span",Ql,[l(m,{onClick:z=>v(L),type:"primary",underline:!1},{default:t(()=>[y(h(e(c)("labelTree.tree.add")),1)]),_:2},1032,["onClick"]),l(m,{onClick:z=>R(U,L),type:"danger",underline:!1,style:{"margin-left":"8px"}},{default:t(()=>[y(h(e(c)("labelTree.tree.remove")),1)]),_:2},1032,["onClick"])])])]),_:1},8,["data"])]),_:1})]),_:1})}}},et=ze(Xl,[["__scopeId","data-v-d0d02bb6"]]);const Ce=K=>(Vl("data-v-ae1df88e"),K=K(),Sl(),K),lt={style:{display:"flex","justify-content":"space-between"}},tt={class:"hidden-xs-only"},at=Ce(()=>I("br",null,null,-1)),st={key:1},ot={style:{display:"flex","justify-content":"end"},class:"password-title-right"},nt=Ce(()=>I("div",{class:"password-strength",style:{"background-color":"#67C23A"}},null,-1)),rt=Ce(()=>I("div",{class:"password-strength",style:{"background-color":"#E6A23C"}},null,-1)),dt=Ce(()=>I("div",{class:"password-strength",style:{"background-color":"#F56C6C"}},null,-1)),it={key:0},ut={class:"password-text"},mt={class:"pass-action-div"},pt={__name:"IndexPage",setup(K){const{t:f,locale:j}=te(),c=M(),x=M(),u=M(),g=M(),P=M(),N=M(),C=O({}),a=M(""),v=M(""),R=M(!1),V=M(""),p=M([]),S=M([]),D=M([]),Y=M([]),s=async()=>{if(!a.value&&!D.value){S.value=p.value;return}let o=[];for(let i=0;i<p.value.length;i++){let T=p.value[i].name||"",$=p.value[i].userName||"",Z=p.value[i].address||"",se=p.value[i].remark||"",X=p.value[i].password||"",ye=!a.value||T.includes(a.value)||$.includes(a.value)||Z.includes(a.value)||se.includes(a.value)||X.includes(a.value),fe=!1;if(D.value.length>0)for(let we=0;we<D.value.length;we++){let Q=D.value[we];p.value[i].label&&p.value[i].label.includes(Q.id)&&(fe=!0)}else fe=!0;ye&&fe&&o.push(p.value[i])}S.value=o},r=()=>{c.value.showAddPassword()},n=o=>{c.value.showUpdatePassword(o)},d=o=>{p.value.unshift(o),pe(),s()},m=o=>{for(let i=0;i<p.value.length;i++)if(p.value[i].id===o.id){p.value[i]=o,pe(),s();break}},b=()=>{V.value=ge(v.value,JSON.stringify(p.value)),R.value=!1,S.value=[],p.value=[],v.value="",x.value.delLocalMainPassword()},w=()=>{x.value.verifyMainPassword()},B=o=>{let i=f("password.name")+": "+o.name+`\r
`;o.address&&(i+=f("password.address")+": "+o.address+`\r
`),o.userName&&(i+=f("password.userName")+": "+o.userName+`\r
`),o.password&&(i+=f("password.password")+": "+o.password+`\r
`),o.remark&&(i+=o.remark+`\r
`),i=i.substring(0,i.length-2),Te(i)},U=o=>{for(let i=0;i<p.value.length;i++)if(p.value[i].id===o.id){p.value.splice(i,1),pe(),s(),G.success(f("index.table.delete.success"));break}},L=o=>{v.value=o;let i=le(o,V.value);p.value=JSON.parse(i),R.value=!0,s()},z=o=>{v.value=o,pe(),G.success(f("index.mainPassword.changeSuccess"))},W=()=>{g.value.openSystemSetting()},ae=()=>{u.value.showUpdateMainPassword()},F=(o,i)=>{C[o]=i,o==="sortChange"&&ue(i)},ue=o=>{o==="insertTimeDesc"?_("insertTime",-1):o==="insertTimeAsc"?_("insertTime",1):o==="name"&&_("name",1),pe(),s()},me=o=>{let i=0;return/[0-9]/.test(o)&&i++,/[a-z]/.test(o)&&i++,/[A-Z]/.test(o)&&i++,/[^0-9a-zA-Z_]/.test(o)&&i++,o.length<6&&i>2&&(i=2),Ve()>2&&i>2&&(i=2),i>3?3:i},Ve=o=>{let i=0;for(let T=0;T<p.value.length;T++)p.value[T].password===o&&i++;return i},ce=o=>{let i=0;for(let T=0;T<p.value.length;T++){if(!p.value[T].password)continue;let $=me(p.value[T].password);o===$&&i++}return i},_=(o,i)=>{p.value.sort((T,$)=>(T=T[o],$=$[o],T<$?i*-1:T>$?i*1:0))},pe=()=>{if(!R.value)return;V.value=ge(v.value,JSON.stringify(p.value));let o=ge(v.value,"password-x");re.commit("setVerifyCode",o),Oe("password.json",{verifyValue:o,passwordCiphertext:V.value})},Je=()=>{je("password.json").then(o=>{if(o.verifyValue){let i=o.verifyValue;re.commit("setVerifyCode",i),V.value=o.passwordCiphertext,x.value.verifyMainPassword()}else R.value=!0,u.value.initMainPassword()}).catch(o=>{console.error(o),Be.error("error-1000："+o)})},Ge=o=>{D.value=o,s()},Ke=o=>{Y.value=o},We=o=>{if(!o)return"";let i=[];return Re(Y.value,o,i),i},Re=(o,i,T)=>{for(let $=0;$<o.length;$++)i.includes(o[$].id)&&T.push(o[$].label),o[$].children&&o[$].children.length>0&&Re(o[$].children,i,T)},Ze=()=>{P.value.downloadExcelTemplate()},qe=()=>{P.value.importExcel(Y.value)},Qe=()=>{P.value.exportExcel(p.value,Y.value)},Xe=(o,i)=>{if(o.length!==0){for(let T=o.length-1;T>=0;T--)p.value.unshift(o[T]);N.value.setLabelTree(i),pe(),s()}};return Pl(()=>{let o=He();for(let i in o)C[i]=o[i];C.language&&C.language!==j.value&&(j.value=C.language),Je()}),(o,i)=>{const T=De,$=de,Z=ie,se=gl,X=Me,ye=Fe,fe=bl,we=vl,Q=yl,he=$e,el=kl,ll=hl,tl=xl,al=Ee,sl=et,ol=Wl,nl=Gl,rl=Hl,dl=Ol,il=Bl;return k(),J(q,null,[l(ye,{id:"passwordBody"},{default:t(()=>[l(X,{xl:{span:16,offset:2},lg:{span:19},md:{span:19}},{default:t(()=>[l(al,null,{header:t(()=>[I("div",lt,[I("div",null,[I("div",tt,[e(p)?(k(),A(T,{key:0,class:"password-table-title"},{default:t(()=>[y(h(e(p).length)+" "+h(e(f)("index.title.passwordCount")),1)]),_:1})):H("",!0),at,e(C).showPasswordStrength?(k(),J("div",st,[l(T,{class:"password-table-strength"},{default:t(()=>[y(h(e(f)("index.title.strength"))+"（ ",1),l(T,{type:"success"},{default:t(()=>[y(h(e(f)("index.title.strength.strong")),1)]),_:1}),y(" : "+h(ce(3))+" ",1),l(T,{style:{"margin-left":"5px"},type:"warning"},{default:t(()=>[y(h(e(f)("index.title.strength.medium")),1)]),_:1}),y(" : "+h(ce(2))+" ",1),l(T,{style:{"margin-left":"5px"},type:"danger"},{default:t(()=>[y(h(e(f)("index.title.strength.weak")),1)]),_:1}),y(" : "+h(ce(1))+"） ",1)]),_:1})])):H("",!0)])]),I("div",ot,[I("div",null,[l($,{modelValue:e(a),"onUpdate:modelValue":i[0]||(i[0]=E=>ne(a)?a.value=E:null),style:{"max-width":"300px"},clearable:"",placeholder:e(f)("index.title.search"),"prefix-icon":e(Ul),disabled:!e(v),onKeyup:Ye(s,["enter"])},null,8,["modelValue","placeholder","prefix-icon","disabled","onKeyup"])]),I("div",null,[l(Z,{disabled:!e(v)||!e(R),type:"primary",plain:"",onClick:i[1]||(i[1]=E=>r())},{default:t(()=>[y(h(e(f)("index.title.addPassword")),1)]),_:1},8,["disabled"])]),I("div",null,[l(se,{content:e(f)("index.title.unlock"),effect:"dark",placement:"top"},{default:t(()=>[e(v)?H("",!0):(k(),A(Z,{key:0,disabled:!e(V),icon:e(Al),onClick:w},null,8,["disabled","icon"]))]),_:1},8,["content"]),l(se,{content:e(f)("index.title.lock"),effect:"dark",placement:"top"},{default:t(()=>[e(v)?(k(),A(Z,{key:0,icon:e(Ie),onClick:b},null,8,["icon"])):H("",!0)]),_:1},8,["content"])]),I("div",null,[l(fe,{placement:"bottom",width:150,trigger:"click"},{reference:t(()=>[l(Z,{icon:e(Nl)},null,8,["icon"])]),default:t(()=>[l(ye,null,{default:t(()=>[l(X,null,{default:t(()=>[l(Z,{onClick:W,style:{width:"100%"},text:""},{default:t(()=>[y("系统设置")]),_:1})]),_:1}),l(X,null,{default:t(()=>[l(Z,{onClick:qe,style:{width:"100%"},text:""},{default:t(()=>[y(h(e(f)("index.title.importExport.import")),1)]),_:1})]),_:1}),l(X,null,{default:t(()=>[l(Z,{onClick:Qe,style:{width:"100%"},text:""},{default:t(()=>[y(h(e(f)("index.title.importExport.export")),1)]),_:1})]),_:1}),l(X,null,{default:t(()=>[l(Z,{onClick:Ze,style:{width:"100%"},text:""},{default:t(()=>[y(h(e(f)("index.title.importExport.download")),1)]),_:1})]),_:1})]),_:1})]),_:1})])])])]),default:t(()=>[l(tl,{height:"calc(100vh - 150px)",data:e(S)},{empty:t(()=>[l(we,{description:e(v)?e(f)("index.table.empty"):e(f)("index.table.lock")},Cl({default:t(()=>[l(Z,{onClick:w,plain:"",type:"primary"},{default:t(()=>[y(h(e(f)("index.title.unlock")),1)]),_:1})]),_:2},[e(v)?void 0:{name:"image",fn:t(()=>[l(e(Ie))]),key:"0"}]),1032,["description"])]),default:t(()=>[e(C).showPasswordStrength?(k(),A(Q,{key:0,width:"30px"},{default:t(E=>[me(E.row.password)===3?(k(),A(se,{key:0},{content:t(()=>[y(h(e(f)("index.title.strength")+"："+e(f)("index.title.strength.strong")),1)]),default:t(()=>[nt]),_:1})):H("",!0),me(E.row.password)===2?(k(),A(se,{key:1},{content:t(()=>[y(h(e(f)("index.title.strength")+"："+e(f)("index.title.strength.medium")),1)]),default:t(()=>[rt]),_:1})):H("",!0),me(E.row.password)===1?(k(),A(se,{key:2},{content:t(()=>[y(h(e(f)("index.title.strength")+"："+e(f)("index.title.strength.weak")),1)]),default:t(()=>[dt]),_:1})):H("",!0)]),_:1})):H("",!0),l(Q,{label:e(f)("password.name"),"min-width":"140px",prop:"name"},null,8,["label"]),l(Q,{label:e(f)("password.address"),"min-width":"200px",prop:"address"},{default:t(E=>[e(El)(E.row.address)?(k(),A(he,{key:0,href:E.row.address,target:"_blank"},{default:t(()=>[y(h(E.row.address),1)]),_:2},1032,["href"])):(k(),A(T,{key:1},{default:t(()=>[y(h(E.row.address),1)]),_:2},1024))]),_:1},8,["label"]),l(Q,{label:e(f)("password.userName"),"min-width":"120px",prop:"userName"},null,8,["label"]),l(Q,{label:e(f)("password.password"),"min-width":"200px"},{default:t(E=>[E.row.password?(k(),J("div",it,[I("span",ut,[E.row.show?H("",!0):(k(),J(q,{key:0},[y("•••••••")],64)),E.row.show?(k(),J(q,{key:1},[y(h(E.row.password),1)],64)):H("",!0)]),I("div",mt,[E.row.show?H("",!0):(k(),A(e(Il),{key:0,onClick:ee=>E.row.show=!E.row.show},null,8,["onClick"])),E.row.show?(k(),A(e(Dl),{key:1,onClick:ee=>E.row.show=!E.row.show},null,8,["onClick"])):H("",!0),l(e(Ll),{onClick:ee=>e(Te)(E.row.password)},null,8,["onClick"])])])):H("",!0)]),_:1},8,["label"]),l(Q,{label:e(f)("index.table.label"),"min-width":"130px"},{default:t(E=>[(k(!0),J(q,null,oe(We(E.row.label),ee=>(k(),A(el,{style:{margin:"3px"},key:ee},{default:t(()=>[y(h(ee),1)]),_:2},1024))),128))]),_:1},8,["label"]),l(Q,{label:e(f)("password.remark"),"min-width":"100px",prop:"remark"},null,8,["label"]),l(Q,{"min-width":"140px",label:e(f)("index.table.operation")},{default:t(E=>[l(he,{type:"success",underline:!1,onClick:ee=>B(E.row)},{default:t(()=>[y(h(e(f)("index.table.share")),1)]),_:2},1032,["onClick"]),l(he,{underline:!1,style:{"margin-left":"10px"},type:"primary",onClick:ee=>n(E.row)},{default:t(()=>[y(h(e(f)("index.table.edit")),1)]),_:2},1032,["onClick"]),l(ll,{title:e(f)("index.table.operation.affirmDelete"),"confirm-button-text":e(f)("index.table.operation.affirm"),"cancel-button-text":e(f)("index.table.operation.cancel"),onConfirm:ee=>U(E.row)},{reference:t(()=>[l(he,{style:{"margin-left":"10px"},underline:!1,type:"danger"},{default:t(()=>[y(h(e(f)("index.table.operation.delete")),1)]),_:1})]),_:2},1032,["title","confirm-button-text","cancel-button-text","onConfirm"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})]),_:1}),l(X,{xl:{span:4},lg:{span:5},md:{span:5},class:"hidden-sm-and-down",style:{"padding-left":"15px"}},{default:t(()=>[l(sl,{ref_key:"labelTreeRef",ref:N,onLabelCheckChange:Ge,onLabelTreeChange:Ke},null,512)]),_:1})]),_:1}),l(ol,{ref_key:"passwordFormRef",ref:c,labelTree:e(Y),onAddPassword:d,onUpdatePassword:m},null,8,["labelTree"]),l(nl,{ref_key:"mainPasswordVerifyRef",ref:x,onVerifyPass:L},null,512),l(rl,{ref_key:"mainPasswordSettingRef",ref:u,onMainPasswordChange:z},null,512),l(dl,{ref_key:"systemSettingRef",ref:g,onUpdateMainPassword:ae,onSystemChangeChange:F},null,512),l(il,{ref_key:"importExportRef",ref:P,labelTree:e(Y),onImportComplete:Xe},null,8,["labelTree"])],64)}}},Lt=ze(pt,[["__scopeId","data-v-ae1df88e"]]);export{Lt as default};
