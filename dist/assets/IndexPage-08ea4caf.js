import{E as De}from"./exceljs-6b62d6db.js";import{F as Ge}from"./file-saver-38a5c18e.js";import{h as ye}from"./moment-fbc5633a.js";import{u as ne}from"./vue-i18n-3214f365.js";import{E as ee,a as He,b as ce,c as pe,d as Pe,e as kt,f as Pt,g as xe,h as Je,i as Ie,j as Ne,k as Oe,l as Ke,m as Ce,n as Xe,o as ze,p as Le,q as xt,r as Ct,s as Ze,t as St,u as Vt,v as Tt,w as Mt,x as Ft,y as Et,z as Rt,A as Ut,B as Dt,C as At,D as It}from"./element-plus-19fbf28c.js";import{r as T,o as v,c as J,X as H,b as qe,u as e,O as W,I as U,ac as Se,J as l,a as G,S as t,P as S,Q as C,A as ue,R as X,aj as le,ak as Qe,w as Ye,aq as Nt,ar as zt}from"./@vue-8e6a53e5.js";import{m as Lt}from"./js-md5-11f5a111.js";import{h as et}from"./@vueuse-9ffc2ac5.js";import{d as me,s as te,g as he,a as We,l as tt,u as $t,b as we,e as ve,c as Ae,r as Bt,_ as lt,p as at,f as st,i as Gt}from"./index-c34fcd0e.js";import{u as Yt}from"./vue-router-c2e97886.js";import{m as Wt,u as jt,n as je,o as Ht,v as Jt,h as Ot,r as Kt}from"./@element-plus-169d18e8.js";import"./ali-oss-21f5c855.js";import"./@intlify-6e8dbf92.js";import"./lodash-es-f5bdeb48.js";import"./async-validator-dee29e8b.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./escape-html-cf2a8097.js";import"./normalize-wheel-es-ed76fb12.js";import"./crypto-js-d55471a7.js";import"./vuex-7c7bb3a2.js";import"./cos-js-sdk-v5-31c61e27.js";const Xt={__name:"ImportExport",emits:["importComplete"],setup(Z,{expose:b,emit:O}){const{t:g}=ne(),E=O,d=T(),_=T(),i=T(0),V=s=>{d.value.click(),_.value=s},P=async()=>{if(d.value.files===0)return;i.value=Date.now();const s=new De.Workbook;s.xlsx.load(d.value.files[0]).then(()=>{s.eachSheet(function(o){if(o.rowCount<2){ee.error(g("importExport.data.empty")),d.value.value="";return}let n=[];for(let u=2;u<=o.rowCount;u++){let p=o.getRow(u),F=a(p.getCell(1).value),$=a(p.getCell(2).value),w=a(p.getCell(3).value),h=a(p.getCell(4).value),A=a(p.getCell(5).value),R=a(p.getCell(6).value),y=a(p.getCell(7).value),B=a(p.getCell(8).value);F&&n.push({id:i.value++,name:F,address:$,userName:w,password:h,remark:R,label:f(A),insertTime:y,updateTime:B})}E("importComplete",n,_.value),d.value.value=""})}).catch(o=>{ee.error(o),d.value.value=""})},a=s=>s?typeof s=="object"?s instanceof Date?ye(s).format("YYYY-MM-DD HH:mm:ss"):s.text:s.toString():"",f=s=>{if(!s)return"";let o=[],n=s.split("、");for(let u=0;u<n.length;u++){let p=k(_.value,n[u],"");if(p)o.push(p);else{let F=[];z(_.value,n[u].split(">"),0,F);for(let $=0;$<F.length;$++)o.push(F[$])}}return Array.from(new Set(o))},k=(s,o,n)=>{for(let u=0;u<s.length;u++){let p=n?n+">"+s[u].label:s[u].label;if(o===p)return s[u].id;if(s[u].children&&s[u].children.length>0)return k(s[u].children,o,p)}},z=(s,o,n,u)=>{if(!o[n])return;for(let F=0;F<s.length;F++)if(s[F].label===o[n])return o[n+1]||u.push(s[F].id),z(s[F].children,o,n+1,u);let p={id:i.value++,label:o[n],children:[]};s.push(p),o[n+1]||u.push(p.id),z(p.children,o,n+1,u)},D=async(s,o)=>{_.value=o;const n=new De.Workbook,u=n.addWorksheet("sheet1");u.getCell("A1").value=g("password.name"),u.getCell("B1").value=g("password.address"),u.getCell("C1").value=g("password.userName"),u.getCell("D1").value=g("password.password"),u.getCell("E1").value=g("password.label"),u.getCell("F1").value=g("password.remark"),u.getCell("G1").value=g("password.insertTime"),u.getCell("H1").value=g("password.updateTime");for(let p=0;p<s.length;p++){let F=s[p].insertTime;F||(F=ye().format("YYYY-MM-DD HH:mm:ss")),u.getCell("A"+(p+2)).value=s[p].name,u.getCell("B"+(p+2)).value=s[p].address,u.getCell("C"+(p+2)).value=s[p].userName,u.getCell("D"+(p+2)).value=s[p].password,u.getCell("E"+(p+2)).value=x(s[p].label),u.getCell("F"+(p+2)).value=s[p].remark,u.getCell("G"+(p+2)).value=F,u.getCell("H"+(p+2)).value=s[p].updateTime}n.xlsx.writeBuffer().then(p=>{let F=new Blob([p],{type:"application/octet-stream"});Ge.saveAs(F,g("importExport.exportName")+"_"+ye().format("YYYY-MM-DD HH:mm:ss")+".xlsx")})},x=s=>{if(!s)return"";let o=[];return j(_.value,s,o,""),o.join("、")},j=(s,o,n,u)=>{for(let p=0;p<s.length;p++){let F=u?u+">"+s[p].label:s[p].label;o.includes(s[p].id)&&n.push(F),s[p].children&&s[p].children.length>0&&j(s[p].children,o,n,F)}};return b({importExcel:V,exportExcel:D,downloadExcelTemplate:()=>{const s=new De.Workbook,o=s.addWorksheet("sheet1");o.getCell("A1").value=g("password.name"),o.getCell("B1").value=g("password.address"),o.getCell("C1").value=g("password.userName"),o.getCell("D1").value=g("password.password"),o.getCell("E1").value=g("password.label"),o.getCell("F1").value=g("password.remark"),o.getCell("G1").value=g("password.insertTime"),o.getCell("H1").value=g("password.updateTime"),s.xlsx.writeBuffer().then(n=>{let u=new Blob([n],{type:"application/octet-stream"});Ge.saveAs(u,g("importExport.importTemplateName")+".xlsx")})}}),(s,o)=>(v(),J("input",{type:"file",onChange:P,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ref_key:"fileUploadInput",ref:d,style:{display:"none"}},null,544))}},Zt=["width","height"],$e={__name:"GesturePassword",props:{size:{type:Number,default:300},count:{type:Number,default:3},showGesture:{type:Boolean,default:!0}},emits:["complete"],setup(Z,{expose:b,emit:O}){const g=et(),E=O,d=T();let _=Z;const i=H({padding:_.size*.18,background:g.value?"rgb(20,20,20)":"#fff",failColor:"#F56C6C",passColor:"#67C23A",point:{color:"#409EFF",size:_.size*.023,selected:{range:_.size*.07,color:"#409EFF",size:_.size*.023,madding:{color:"#409EFF",size:_.size*.07,lineWidth:1}}},line:{color:"#409EFF",width:2}}),V=T({}),P=T([]),a=T(!1),f=T("");let k=null;const z=()=>{i.background=g.value?"rgb(20,20,20)":"#fff",k=d.value.getContext("2d"),D()},D=()=>{k.fillStyle=i.background,k.fillRect(0,0,_.size,_.size),V.value=[];let w=(_.size-i.padding*2)/(_.count-1),h=1;for(let A=0;A<_.count;A++)for(let R=0;R<_.count;R++){let y=i.padding+R*w,B=i.padding+A*w,M=w/2,Y={id:h,x:y,y:B,startX:y-M,endX:y+M,startY:B-M,endY:B+M,h:w,w};x(Y),V.value[h]=Y,h++}},x=w=>{let h=p(w);h&&_.showGesture&&(k.beginPath(),f.value==="fail"?k.strokeStyle=i.failColor:f.value==="pass"?k.strokeStyle=i.passColor:k.strokeStyle=i.point.selected.madding.color,k.lineWidth=i.point.selected.madding.lineWidth,k.arc(w.x,w.y,i.point.selected.madding.size,0,Math.PI*2),k.stroke()),k.beginPath(),h&&_.showGesture?(f.value==="fail"?k.fillStyle=i.failColor:f.value==="pass"?k.fillStyle=i.passColor:k.fillStyle=i.point.selected.madding.color,k.arc(w.x,w.y,i.point.selected.size,0,Math.PI*2)):(k.fillStyle=i.point.color,k.arc(w.x,w.y,i.point.size,0,Math.PI*2)),k.fill()},j=()=>{a.value=!0},I=()=>{if(!a.value)return;a.value=!1;let w=o();if(w){let h=Lt(w);E("complete",h)}D(),u()},s=w=>{f.value=w,D(),u(),w?setTimeout(()=>{f.value="",P.value=[],D()},500):(P.value=[],D())},o=()=>{let w="";for(let h=0;h<P.value.length;h++)w+=P.value[h].id+",";return w&&(w=w.substring(0,w.length-1)),w},n=w=>{let h=w.offsetX,A=w.offsetY;if(D(),u(h,A),!a.value)return;let R=F(h,A);!R||p(R)||(P.value.push(R),D(),u(h,A))},u=(w,h)=>{if(!_.showGesture)return;let A=F(w,h);if(A&&f.value===""&&(k.beginPath(),k.strokeStyle=i.point.selected.madding.color,k.lineWidth=i.point.selected.madding.lineWidth,k.arc(A.x,A.y,i.point.selected.madding.size,0,Math.PI*2),k.stroke()),P.value.length!==0){k.beginPath(),f.value==="fail"?k.strokeStyle=i.failColor:f.value==="pass"?k.strokeStyle=i.passColor:k.strokeStyle=i.line.color,k.lineWidth=i.line.width,k.lineCap="round",k.moveTo(P.value[0].x,P.value[0].y);for(let R=1;R<P.value.length;R++)k.lineTo(P.value[R].x,P.value[R].y);a.value&&w&&h&&f.value===""&&k.lineTo(w,h),k.stroke()}},p=w=>{for(let h=0;h<P.value.length;h++)if(w.id===P.value[h].id)return!0;return!1},F=(w,h)=>{for(let A in V.value){let R=V.value[A];if(w>R.startX+i.point.selected.range&&w<R.endX-i.point.selected.range&&h>R.startY+i.point.selected.range&&h<R.endY-i.point.selected.range)return R}},$=w=>{let h=w.touches[0].clientX-d.value.offsetLeft,A=w.touches[0].clientY-d.value.offsetTop;n({offsetX:h,offsetY:A})};return qe(()=>{z()}),b({setVerifyStatus:s}),(w,h)=>e(_).size?(v(),J("canvas",{key:0,width:e(_).size,height:e(_).size,ref_key:"canvasRef",ref:d,onMousedown:j,onMouseup:I,onMousemove:h[0]||(h[0]=A=>n(A)),onMouseleave:I,onTouchstart:j,onTouchend:I,onTouchmove:$},null,40,Zt)):W("",!0)}},qt={style:{"text-align":"center"}},Qt={class:"dialog-footer"},el={__name:"DeleteAccount",emits:["deleteAccount"],setup(Z,{expose:b,emit:O}){const{t:g}=ne(),E=O,d=T(),_=H({deleteAccount:!1}),i=T(""),V=T(""),P=()=>{let z=me(V.value,te.state.verifyCode);if(z&&z==="password-x"){i.value==="gesture"&&d.value.setVerifyStatus("pass");let D=localStorage.getItem("databaseForm"),x=me(he(),D);if(JSON.parse(x).keyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){ee.error("演示账号不能注销");return}We("password.json"),We("labelTree.json"),localStorage.removeItem("systemConfig"),ee.success(g("systemSetting.deleteAccount.success")),E("deleteAccount")}else i.value==="common"?ee.error(g("systemSetting.deleteAccount.mainPasswordError")):d.value.setVerifyStatus("fail")},a=()=>{i.value=te.state.mainPasswordType,_.deleteAccount=!0},f=z=>{V.value=z,P()},k=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){k.value=document.documentElement.clientWidth<728}),b({showDeleteAccount:a}),(z,D)=>{const x=He,j=$e,I=ce,s=pe,o=Pe;return v(),U(o,{fullscreen:e(k),modelValue:e(_).deleteAccount,"onUpdate:modelValue":D[1]||(D[1]=n=>e(_).deleteAccount=n),title:e(g)("systemSetting.deleteAccount"),width:"400px"},Se({default:l(()=>[t(x,{type:"error",closable:!1},{default:l(()=>[S(C(e(g)("systemSetting.deleteAccount.text")),1)]),_:1}),G("div",qt,[e(i)==="gesture"?(v(),U(j,{key:0,ref_key:"gesturePasswordRef",ref:d,onComplete:f},null,512)):W("",!0),e(i)==="common"?(v(),U(I,{key:1,modelValue:e(V),"onUpdate:modelValue":D[0]||(D[0]=n=>ue(V)?V.value=n:null),style:{"margin-top":"20px"}},null,8,["modelValue"])):W("",!0)])]),_:2},[e(i)==="common"?{name:"footer",fn:l(()=>[G("span",Qt,[t(s,{type:"danger",onClick:P},{default:l(()=>[S(C(e(g)("systemSetting.deleteAccount.affirm")),1)]),_:1})])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},tl={style:{"text-align":"center"}},ll={class:"dialog-footer"},al={__name:"SystemSetting",emits:["updateMainPassword","deleteAccount","systemChangeChange"],setup(Z,{expose:b,emit:O}){const g=Yt(),E=et(),{t:d,locale:_}=ne(),i=O,V=T(),P=H({setting:!1}),a=H({language:"zh-cn",cacheMainPassword:!0,autoGeneratePassword:!0,darkMode:!1,sortRule:"insertTimeDesc",showPasswordStrength:!1,cacheDatabaseForm:!0,showAddTime:!0,showUpTime:!1,verifyShowGesture:!0,defaultPasswordRule:{length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}}),f=H([{key:"zh-cn",label:"简体中文"},{key:"en-us",label:"English"}]),k=H([{key:"insertTimeDesc",label:d("systemSetting.sort.insertTimeDesc")},{key:"insertTimeAsc",label:d("systemSetting.sort.insertTimeAsc")},{key:"name",label:d("systemSetting.sort.name")}]),z=H([{key:!1,label:d("systemSetting.topic.light")},{key:!0,label:d("systemSetting.topic.dark")}]),D=H([{key:!0,label:d("systemSetting.cacheMainPassword.enable")},{key:!1,label:d("systemSetting.cacheMainPassword.disabled")}]),x=H([{key:!0,label:d("systemSetting.showAddTime.enable")},{key:!1,label:d("systemSetting.showAddTime.disabled")}]),j=H([{key:!0,label:d("systemSetting.showUpTime.enable")},{key:!1,label:d("systemSetting.showUpTime.disabled")}]),I=H([{key:!0,label:d("mainPasswordSetting.verify.showGesture.enable")},{key:!1,label:d("mainPasswordSetting.verify.showGesture.disabled")}]),s=H([{key:!0,label:d("systemSetting.cacheDatabaseForm.enable")},{key:!1,label:d("systemSetting.cacheDatabaseForm.disabled")}]),o=H([{key:!0,label:d("passwordForm.autoGeneratePassword.enable")},{key:!1,label:d("passwordForm.autoGeneratePassword.disabled")}]),n=H([{key:!0,label:d("systemSetting.showPasswordStrength.enable")},{key:!1,label:d("systemSetting.showPasswordStrength.disabled")}]);let u=null;const p=()=>{let R=tt();if(R)for(let y in R)a[y]=R[y];a.language!==_.value&&(a.language=_.value),u=JSON.stringify(a),P.setting=!0},F=R=>{let y=a.defaultPasswordRule;if(!y.number&&!y.symbol&&!y.lowercase&&!y.uppercase){ee.error(d("systemSetting.passwordRuleVerify"));return}$t(a);let B=JSON.parse(u);a.cacheMainPassword!==B.cacheMainPassword&&a.cacheMainPassword===!1&&localStorage.removeItem("mainPasswordCiphertext"),a.cacheDatabaseForm!==B.cacheDatabaseForm&&a.cacheDatabaseForm===!1&&localStorage.removeItem("databaseForm"),a.language!==_.value&&(_.value=a.language,console.log("系统语言设置为：",a.language)),E.value!==a.darkMode&&(E.value=a.darkMode,console.log("暗黑模式设置为：",a.darkMode)),a.sortRule!==B.sortRule&&(i("systemChangeChange","sortChange",a.sortRule),console.log("排序规则设置为：",a.sortRule)),a.showPasswordStrength!==B.showPasswordStrength&&(i("systemChangeChange","showPasswordStrength",a.showPasswordStrength),console.log("是否显示密码强度设置为：",a.showPasswordStrength)),R&&(P.setting=!1)},$=()=>{localStorage.removeItem("databaseForm"),localStorage.removeItem("mainPasswordCiphertext"),te.commit("delDatabase"),te.commit("delDatabaseForm"),g.push("/login")},w=()=>{P.setting=!1,i("updateMainPassword")},h=()=>{P.setting=!1,V.value.showDeleteAccount()},A=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){A.value=document.documentElement.clientWidth<728}),b({logout:$,openSystemSetting:p,showUpdateMainPassword:w}),(R,y)=>{const B=kt,M=Pt,Y=xe,fe=Je,ae=Ie,Te=ce,ge=Ne,se=Oe,q=pe,Me=Ke,Fe=Ce,Ee=Pe,Re=el;return v(),J(X,null,[t(Ee,{fullscreen:e(A),modelValue:e(P).setting,"onUpdate:modelValue":y[17]||(y[17]=m=>e(P).setting=m),title:e(d)("systemSetting.title"),width:"600px"},{footer:l(()=>[G("span",ll,[t(q,{type:"primary",plain:"",onClick:y[15]||(y[15]=m=>F(!1))},{default:l(()=>[S(C(e(d)("systemSetting.apply")),1)]),_:1}),t(q,{type:"primary",plain:"",onClick:y[16]||(y[16]=m=>F(!0))},{default:l(()=>[S(C(e(d)("systemSetting.save")),1)]),_:1})])]),default:l(()=>[t(Fe,{model:e(a),"label-width":"150px"},{default:l(()=>[t(Me,{"tab-position":"left",style:{height:"350px"}},{default:l(()=>[t(se,{label:"常规"},{default:l(()=>[t(Y,{label:e(d)("systemSetting.language")},{default:l(()=>[t(M,{modelValue:e(a).language,"onUpdate:modelValue":y[0]||(y[0]=m=>e(a).language=m)},{default:l(()=>[(v(!0),J(X,null,le(e(f),m=>(v(),U(B,{key:m.key,label:m.label,value:m.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(Y,{label:e(d)("systemSetting.sort")},{default:l(()=>[t(M,{modelValue:e(a).sortRule,"onUpdate:modelValue":y[1]||(y[1]=m=>e(a).sortRule=m)},{default:l(()=>[(v(!0),J(X,null,le(e(k),m=>(v(),U(B,{key:m.key,label:m.label,value:m.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(Y,{label:e(d)("passwordForm.autoGeneratePassword")},{default:l(()=>[t(M,{modelValue:e(a).autoGeneratePassword,"onUpdate:modelValue":y[2]||(y[2]=m=>e(a).autoGeneratePassword=m)},{default:l(()=>[(v(!0),J(X,null,le(e(o),m=>(v(),U(B,{key:m.key,label:m.label,value:m.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(Y,{label:e(d)("systemSetting.defaultPasswordRule")},{default:l(()=>[t(ge,{style:{"margin-top":"15px"}},{default:l(()=>[t(ae,{span:12},{default:l(()=>[t(fe,{size:"small",modelValue:e(a).defaultPasswordRule.uppercase,"onUpdate:modelValue":y[3]||(y[3]=m=>e(a).defaultPasswordRule.uppercase=m),label:e(d)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(ae,{span:12},{default:l(()=>[t(fe,{size:"small",modelValue:e(a).defaultPasswordRule.lowercase,"onUpdate:modelValue":y[4]||(y[4]=m=>e(a).defaultPasswordRule.lowercase=m),label:e(d)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(ae,{span:12},{default:l(()=>[t(fe,{size:"small",modelValue:e(a).defaultPasswordRule.number,"onUpdate:modelValue":y[5]||(y[5]=m=>e(a).defaultPasswordRule.number=m),label:e(d)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(ae,{span:12},{default:l(()=>[t(fe,{size:"small",modelValue:e(a).defaultPasswordRule.symbol,"onUpdate:modelValue":y[6]||(y[6]=m=>e(a).defaultPasswordRule.symbol=m),label:e(d)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1}),t(ae,{span:12},{default:l(()=>[G("div",null,[t(Te,{size:"small",style:{position:"relative",top:"3px"},modelValue:e(a).defaultPasswordRule.length,"onUpdate:modelValue":y[7]||(y[7]=m=>e(a).defaultPasswordRule.length=m)},{prepend:l(()=>[S(C(e(d)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["label"])]),_:1}),t(se,{label:"个性化"},{default:l(()=>[t(Y,{label:e(d)("systemSetting.topic")},{default:l(()=>[t(M,{modelValue:e(a).darkMode,"onUpdate:modelValue":y[8]||(y[8]=m=>e(a).darkMode=m)},{default:l(()=>[(v(!0),J(X,null,le(e(z),m=>(v(),U(B,{key:m.key,label:m.label,value:m.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(Y,{label:e(d)("systemSetting.showPasswordStrength")},{default:l(()=>[t(M,{modelValue:e(a).showPasswordStrength,"onUpdate:modelValue":y[9]||(y[9]=m=>e(a).showPasswordStrength=m)},{default:l(()=>[(v(!0),J(X,null,le(e(n),m=>(v(),U(B,{key:m.key,label:m.label,value:m.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(Y,{label:e(d)("systemSetting.showAddTime")},{default:l(()=>[t(M,{modelValue:e(a).showAddTime,"onUpdate:modelValue":y[10]||(y[10]=m=>e(a).showAddTime=m)},{default:l(()=>[(v(!0),J(X,null,le(e(x),m=>(v(),U(B,{key:m.key,label:m.label,value:m.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(Y,{label:e(d)("systemSetting.showUpTime")},{default:l(()=>[t(M,{modelValue:e(a).showUpTime,"onUpdate:modelValue":y[11]||(y[11]=m=>e(a).showUpTime=m)},{default:l(()=>[(v(!0),J(X,null,le(e(j),m=>(v(),U(B,{key:m.key,label:m.label,value:m.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),t(se,{label:"安全"},{default:l(()=>[t(Y,{label:e(d)("systemSetting.cacheMainPassword")},{default:l(()=>[t(M,{modelValue:e(a).cacheMainPassword,"onUpdate:modelValue":y[12]||(y[12]=m=>e(a).cacheMainPassword=m)},{default:l(()=>[(v(!0),J(X,null,le(e(D),m=>(v(),U(B,{key:m.key,label:m.label,value:m.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(Y,{label:e(d)("systemSetting.cacheDatabaseForm")},{default:l(()=>[t(M,{modelValue:e(a).cacheDatabaseForm,"onUpdate:modelValue":y[13]||(y[13]=m=>e(a).cacheDatabaseForm=m)},{default:l(()=>[(v(!0),J(X,null,le(e(s),m=>(v(),U(B,{key:m.key,label:m.label,value:m.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(Y,{label:e(d)("mainPasswordSetting.verify.showGesture")},{default:l(()=>[t(M,{modelValue:e(a).verifyShowGesture,"onUpdate:modelValue":y[14]||(y[14]=m=>e(a).verifyShowGesture=m)},{default:l(()=>[(v(!0),J(X,null,le(e(I),m=>(v(),U(B,{key:m.key,label:m.label,value:m.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),t(se,{label:"其他"},{default:l(()=>[G("div",tl,[t(q,{plain:"",onClick:w},{default:l(()=>[S(C(e(d)("systemSetting.updateMainPassword")),1)]),_:1}),t(q,{plain:"",type:"danger",onClick:h},{default:l(()=>[S(C(e(d)("systemSetting.deleteAccount")),1)]),_:1}),t(q,{type:"warning",plain:"",onClick:$},{default:l(()=>[S(C(e(d)("systemSetting.logout")),1)]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["fullscreen","modelValue","title"]),t(Re,{ref_key:"deleteAccountRef",ref:V,onDeleteAccount:$},null,512)],64)}}},sl={style:{"text-align":"center"}},ol={class:"dialog-footer"},ot={__name:"MainPasswordVerify",emits:["verifyPass"],setup(Z,{expose:b,emit:O}){const{t:g}=ne(),E=O,d=T(),_=T(""),i=T(""),V=H({verifyMainPassword:!1}),P=I=>{_.value=I,a()},a=()=>{let I=me(_.value,te.state.verifyCode);I&&I==="password-x"?(i.value==="gesture"&&d.value.setVerifyStatus("pass"),E("verifyPass",_.value),k(_.value),_.value="",V.verifyMainPassword=!1):i.value==="common"?ee.error(g("mainPasswordVerify.form.verify")):d.value.setVerifyStatus("fail")},f=()=>{localStorage.removeItem("mainPasswordCiphertext")},k=I=>{if(we("cacheMainPassword")===!1)return;let o=he(),n=ve(o,I);localStorage.setItem("mainPasswordCiphertext",n)},z=()=>{if(we("cacheMainPassword")===!1)return null;let s=localStorage.getItem("mainPasswordCiphertext");if(!s)return null;let o=he(),n=me(o,s);return n||null},D=()=>we("verifyShowGesture")!==!1,x=(I=!0)=>{if(i.value=te.state.mainPasswordType,!I){V.verifyMainPassword=!0;return}let s=z();if(!s){V.verifyMainPassword=!0;return}let o=me(s,te.state.verifyCode);o&&o==="password-x"?E("verifyPass",s):V.verifyMainPassword=!0},j=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){j.value=document.documentElement.clientWidth<728}),b({verifyMainPassword:x,delLocalMainPassword:f}),(I,s)=>{const o=$e,n=ce,u=xe,p=Ce,F=pe,$=Pe;return v(),U($,{fullscreen:e(j),modelValue:e(V).verifyMainPassword,"onUpdate:modelValue":s[1]||(s[1]=w=>e(V).verifyMainPassword=w),title:e(g)("mainPasswordVerify.form.title"),width:"400px"},Se({default:l(()=>[G("div",sl,[e(i)==="gesture"&&e(V).verifyMainPassword?(v(),U(o,{key:0,"show-gesture":D(),ref_key:"gesturePasswordRef",ref:d,onComplete:P},null,8,["show-gesture"])):W("",!0),e(i)==="common"&&e(V).verifyMainPassword?(v(),U(p,{key:1,style:{padding:"10px"}},{default:l(()=>[t(u,null,{default:l(()=>[t(n,{modelValue:e(_),"onUpdate:modelValue":s[0]||(s[0]=w=>ue(_)?_.value=w:null),placeholder:e(g)("mainPasswordVerify.form.mainPassword"),type:"password",onKeyup:Qe(a,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1})]),_:1})):W("",!0)])]),_:2},[e(i)==="common"?{name:"footer",fn:l(()=>[G("span",ol,[t(F,{type:"primary",disabled:!e(_),onClick:a},{default:l(()=>[S(C(e(g)("mainPasswordVerify.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},nl={class:"dialog-footer"},rl={__name:"MainPasswordSetting",emits:["mainPasswordChange"],setup(Z,{expose:b,emit:O}){const{t:g}=ne(),E=O,d=T(),_=T(),i=T("gesture"),V=T(""),P=T(""),a=H({mainPassword:!1}),f=T(""),k=s=>{f.value==="setting"?(V.value=s,f.value="affirm",_.value.setVerifyStatus("")):f.value==="affirm"&&(P.value=s,z())},z=()=>{if(V.value!==P.value){ee.error(g("mainPasswordSetting.form.passwordsDiff"));return}let s=localStorage.getItem("databaseForm"),o=me(he(),s);if(JSON.parse(o).accessKeyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){ee.error("演示账号不能修改主密码");return}i.value==="gesture"?te.commit("setMainPasswordType","gesture"):te.commit("setMainPasswordType","common"),E("mainPasswordChange",V.value,i.value);let u=we("cacheMainPassword");if(u||u==null){let p=he(),F=ve(p,V.value);localStorage.setItem("mainPasswordCiphertext",F)}V.value="",P.value="",a.mainPassword=!1},D=()=>{f.value="setting",a.mainPassword=!0},x=()=>{d.value.verifyMainPassword(!1)},j=()=>{i.value==="gesture"&&(f.value="setting"),V.value="",P.value=""},I=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){I.value=document.documentElement.clientWidth<728}),b({settingMainPassword:D,updateMainPassword:x}),(s,o)=>{const n=He,u=Xe,p=$e,F=ze,$=Oe,w=ce,h=xe,A=Ce,R=Ke,y=pe,B=Pe,M=ot;return v(),J(X,null,[t(B,{fullscreen:e(I),modelValue:e(a).mainPassword,"onUpdate:modelValue":o[4]||(o[4]=Y=>e(a).mainPassword=Y),title:e(g)("mainPasswordSetting.form.setMainPassword"),width:"470px"},Se({default:l(()=>[t(n,{type:"error",style:{position:"relative",top:"-10px"},closable:!1},{default:l(()=>[S(C(e(g)("mainPasswordSetting.forget.message")),1)]),_:1}),t(R,{modelValue:e(i),"onUpdate:modelValue":o[3]||(o[3]=Y=>ue(i)?i.value=Y:null),style:{"margin-top":"10px"},type:"card",onTabChange:j},{default:l(()=>[t($,{label:e(g)("mainPasswordSetting.passwordType.gesture"),name:"gesture",style:{"text-align":"center"}},{default:l(()=>[G("div",null,[e(f)==="setting"?(v(),U(u,{key:0},{default:l(()=>[S(C(e(g)("mainPasswordSetting.gesture.first")),1)]),_:1})):W("",!0),e(f)==="affirm"?(v(),U(u,{key:1},{default:l(()=>[S(C(e(g)("mainPasswordSetting.gesture.affirm")),1)]),_:1})):W("",!0)]),e(a).mainPassword&&e(i)==="gesture"?(v(),U(p,{key:0,ref_key:"gesturePasswordRef",ref:_,onComplete:k},null,512)):W("",!0),G("div",null,[t(F,{underline:!1,style:{position:"relative",top:"-2px"},type:"primary",onClick:o[0]||(o[0]=Y=>f.value="setting")},{default:l(()=>[S(C(e(g)("mainPasswordSetting.gesture.reset")),1)]),_:1})])]),_:1},8,["label"]),t($,{label:e(g)("mainPasswordSetting.passwordType.common"),name:"common",style:{"text-align":"center"}},{default:l(()=>[t(A,{inline:!0,"label-width":"100px",style:{"margin-top":"20px"}},{default:l(()=>[t(h,{label:e(g)("mainPasswordSetting.form.newMainPassword")},{default:l(()=>[t(w,{type:"password",modelValue:e(V),"onUpdate:modelValue":o[1]||(o[1]=Y=>ue(V)?V.value=Y:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"]),t(h,{label:e(g)("mainPasswordSetting.form.newMainPasswordAffirm")},{default:l(()=>[t(w,{type:"password",modelValue:e(P),"onUpdate:modelValue":o[2]||(o[2]=Y=>ue(P)?P.value=Y:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:2},[e(i)==="common"?{name:"footer",fn:l(()=>[G("span",nl,[t(y,{type:"primary",disabled:!e(V),onClick:z},{default:l(()=>[S(C(e(g)("mainPasswordSetting.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"]),t(M,{ref_key:"mainPasswordVerifyRef",ref:d,onVerifyPass:D},null,512)],64)}}},dl={class:"dialog-footer"},il={__name:"PasswordForm",props:{labelTree:Array},emits:["addPassword","updatePassword"],setup(Z,{expose:b,emit:O}){const g=O,{t:E}=ne(),d=T(),_=H({password:!1}),i=T(""),V=H({uppercase:"ABCDEFGHJKLMNPQRSTUVWXYZ",lowercase:"abcdefghjkmnpqrstuvwxyz",number:"0123456789",symbol:"~!@#$^&*()_+.,;"}),P=()=>({id:0,name:"",address:"",userName:"",password:"",remark:"",label:"",insertTime:"",updateTime:""}),a=H(P()),f=H({length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}),k=H({name:[{required:!0,message:E("passwordForm.form.name.verify"),trigger:"blur"}]}),z=()=>{if(!f.number&&!f.symbol&&!f.lowercase&&!f.uppercase){ee.error(E("systemSetting.passwordRuleVerify"));return}let o=[];f.lowercase&&o.push(V.lowercase),f.uppercase&&o.push(V.uppercase),f.symbol&&o.push(V.symbol),f.number&&o.push(V.number),a.password=Bt(o,f.length)},D=async o=>{await o.validate(n=>{n&&(_.password=!1,i.value==="add"?(a.id=Date.now(),a.insertTime=ye().format("YYYY-MM-DD HH:mm:ss"),g("addPassword",JSON.parse(JSON.stringify(a)))):(a.updateTime=ye().format("YYYY-MM-DD HH:mm:ss"),g("updatePassword",JSON.parse(JSON.stringify(a)))))})},x=()=>{let o=we("defaultPasswordRule");if(o)for(let n in o)f[n]=o[n]},j=()=>{x();let o=P();for(let u in o)a[u]=o[u];we("autoGeneratePassword")&&z(),i.value="add",_.password=!0},I=o=>{x();for(let n in a)a[n]=o[n];i.value="update",_.password=!0},s=()=>document.documentElement.clientWidth;return b({showAddPassword:j,showUpdatePassword:I}),(o,n)=>{const u=ce,p=xe,F=pe,$=Ie,w=Ne,h=Je,A=Le,R=xt,y=Ce,B=Ct;return v(),U(B,{modelValue:e(_).password,"onUpdate:modelValue":n[13]||(n[13]=M=>e(_).password=M),title:e(i)==="add"?e(E)("passwordForm.form.addPassword"):e(E)("passwordForm.form.editPassword"),size:"620px",direction:s()>768?"rtl":"btt"},{footer:l(()=>[G("span",dl,[t(F,{onClick:n[12]||(n[12]=M=>D(e(d))),type:"primary"},{default:l(()=>[S(C(e(E)("passwordForm.generateForm.save")),1)]),_:1})])]),default:l(()=>[t(y,{ref_key:"passwordFormRef",ref:d,model:e(a),rules:e(k),"label-width":"70px",style:{"padding-right":"30px"}},{default:l(()=>[t(p,{label:e(E)("password.name"),prop:"name"},{default:l(()=>[t(u,{modelValue:e(a).name,"onUpdate:modelValue":n[0]||(n[0]=M=>e(a).name=M),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(E)("password.address")},{default:l(()=>[t(u,{modelValue:e(a).address,"onUpdate:modelValue":n[1]||(n[1]=M=>e(a).address=M),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(E)("password.userName")},{default:l(()=>[t(u,{modelValue:e(a).userName,"onUpdate:modelValue":n[2]||(n[2]=M=>e(a).userName=M),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(E)("password.password")},{default:l(()=>[t(A,{style:{width:"100%"}},{default:l(()=>[t(w,null,{default:l(()=>[t($,null,{default:l(()=>[t(u,{modelValue:e(a).password,"onUpdate:modelValue":n[4]||(n[4]=M=>e(a).password=M),clearable:""},{append:l(()=>[t(F,{onClick:n[3]||(n[3]=M=>e(Ae)(e(a).password))},{default:l(()=>[S(C(e(E)("passwordForm.generateForm.password.copy")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(w,{style:{"margin-top":"15px"}},{default:l(()=>[t($,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(h,{size:"small",modelValue:e(f).uppercase,"onUpdate:modelValue":n[5]||(n[5]=M=>e(f).uppercase=M),label:e(E)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t($,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(h,{size:"small",modelValue:e(f).lowercase,"onUpdate:modelValue":n[6]||(n[6]=M=>e(f).lowercase=M),label:e(E)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t($,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(h,{size:"small",modelValue:e(f).number,"onUpdate:modelValue":n[7]||(n[7]=M=>e(f).number=M),label:e(E)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t($,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(h,{size:"small",modelValue:e(f).symbol,"onUpdate:modelValue":n[8]||(n[8]=M=>e(f).symbol=M),label:e(E)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1})]),_:1}),t(w,{style:{"margin-top":"15px"}},{default:l(()=>[t($,{style:{"text-align":"center"}},{default:l(()=>[t(u,{modelValue:e(f).length,"onUpdate:modelValue":n[9]||(n[9]=M=>e(f).length=M),size:"small",style:{width:"120px"}},{prepend:l(()=>[S(C(e(E)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"]),t(F,{plain:"",size:"small",style:{position:"relative",top:"-5px","margin-left":"10px"},type:"success",onClick:z},{default:l(()=>[S(C(e(E)("passwordForm.generateForm.randomPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["label"]),t(p,{label:e(E)("password.label")},{default:l(()=>[t(R,{modelValue:e(a).label,"onUpdate:modelValue":n[10]||(n[10]=M=>e(a).label=M),"value-key":"id",data:Z.labelTree,"check-strictly":"",multiple:"","default-expand-all":"",placeholder:e(E)("password.label.placeholder"),filterable:""},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),t(p,{label:e(E)("password.remark")},{default:l(()=>[t(u,{type:"textarea",placeholder:e(E)("passwordForm.generateForm.remark"),rows:4,modelValue:e(a).remark,"onUpdate:modelValue":n[11]||(n[11]=M=>e(a).remark=M)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","direction"])}}};const ul={class:"label-tree-node"},ml=["onClick","onBlur"],cl={class:"label-tree-node-menu"},pl={__name:"LabelTree",emits:["labelCheckChange","labelTreeChange"],setup(Z,{expose:b,emit:O}){const{t:g}=ne(),E=O,d=T(),_=T([]),i=T([]),V=T(!1),P=()=>{let s=d.value.getCheckedNodes();E("labelCheckChange",s)},a=(s,o)=>s?o.label.includes(s):!0,f=s=>{const o={id:Date.now(),label:g("labelTree.addLabel"),children:[]};s.children||(s.children=[]),s.children.push(o)},k=(s,o)=>{const n=s.parent,u=n.data.children||n.data,p=u.findIndex(F=>F.id===o.id);u.splice(p,1)},z=s=>!s.edit,D=()=>{i.value.push({id:Date.now(),label:g("labelTree.firstAddLabel"),children:[]})},x=()=>{V.value&&at("labelTree.json",{labelTree:i.value})},j=s=>{i.value=s};return Ye(_,s=>{d.value.filter(s)}),Ye(i,()=>{x(),E("labelTreeChange",i.value)},{deep:!0}),(()=>{st("labelTree.json").then(s=>{s&&s.labelTree?i.value=s.labelTree:i.value=[],V.value=!0}).catch(s=>{Ze.error(s.code)})})(),b({setLabelTree:j}),(s,o)=>{const n=ce,u=pe,p=ze,F=St,$=Vt,w=Le;return v(),U(w,null,{header:l(()=>[S(C(e(g)("labelTree.title")),1)]),default:l(()=>[t(n,{modelValue:e(_),"onUpdate:modelValue":o[0]||(o[0]=h=>ue(_)?_.value=h:null),clearable:"",placeholder:e(g)("labelTree.search.placeholder")},null,8,["modelValue","placeholder"]),t($,{height:"35vh"},{default:l(()=>[t(F,{data:e(i),"show-checkbox":"",ref_key:"labelTreeRef",ref:d,draggable:"","node-key":"id",style:{"margin-top":"10px"},onCheck:P,"filter-node-method":a,"expand-on-click-node":!1,"allow-drag":z,"default-expand-all":""},{empty:l(()=>[t(u,{size:"small",type:"primary",plain:"",onClick:D},{default:l(()=>[S(C(e(g)("labelTree.firstAddLabel")),1)]),_:1})]),default:l(({node:h,data:A})=>[G("span",ul,[h.edit?W("",!0):(v(),J("span",{key:0,onClick:R=>h.edit=!0,onBlur:R=>h.edit=!1},C(A.label),41,ml)),h.edit?(v(),U(n,{key:1,style:{width:"60%"},ref:h.id+"_input",size:"small",onBlur:R=>h.edit=!1,modelValue:A.label,"onUpdate:modelValue":R=>A.label=R},null,8,["onBlur","modelValue","onUpdate:modelValue"])):W("",!0),G("span",cl,[t(p,{onClick:R=>f(A),type:"primary",underline:!1},{default:l(()=>[S(C(e(g)("labelTree.tree.add")),1)]),_:2},1032,["onClick"]),t(p,{onClick:R=>k(h,A),type:"danger",underline:!1,style:{"margin-left":"8px"}},{default:l(()=>[S(C(e(g)("labelTree.tree.remove")),1)]),_:2},1032,["onClick"])])])]),_:1},8,["data"])]),_:1})]),_:1})}}},fl=lt(pl,[["__scopeId","data-v-e3fc3f54"]]);const Ve=Z=>(Nt("data-v-030e35db"),Z=Z(),zt(),Z),wl={style:{display:"flex","justify-content":"space-between"}},gl={class:"hidden-xs-only"},_l=Ve(()=>G("br",null,null,-1)),bl={key:1},yl={style:{display:"flex","justify-content":"end"},class:"password-title-right"},vl=Ve(()=>G("div",{class:"password-strength",style:{"background-color":"#67C23A"}},null,-1)),hl=Ve(()=>G("div",{class:"password-strength",style:{"background-color":"#E6A23C"}},null,-1)),kl=Ve(()=>G("div",{class:"password-strength",style:{"background-color":"#F56C6C"}},null,-1)),Pl={key:0},xl={class:"password-text"},Cl={class:"pass-action-div"},Sl={__name:"IndexPage",setup(Z){const{t:b,locale:O}=ne(),g=T(),E=T(),d=T(),_=T(),i=T(),V=T(),P=H({}),a=T(""),f=T(""),k=T(""),z=T(!1),D=T(""),x=T([]),j=T([]),I=T([]),s=T([]),o=async()=>{if(!a.value&&!I.value){j.value=x.value;return}let r=[];for(let c=0;c<x.value.length;c++){let N=x.value[c].name||"",K=x.value[c].userName||"",re=x.value[c].address||"",de=x.value[c].remark||"",ie=x.value[c].password||"",Ue=!a.value||N.includes(a.value)||K.includes(a.value)||re.includes(a.value)||de.includes(a.value)||ie.includes(a.value),_e=!1;if(I.value.length>0)for(let be=0;be<I.value.length;be++){let Q=I.value[be];x.value[c].label&&x.value[c].label.includes(Q.id)&&(_e=!0)}else _e=!0;Ue&&_e&&r.push(x.value[c])}j.value=r},n=()=>{g.value.showAddPassword()},u=r=>{g.value.showUpdatePassword(r)},p=r=>{x.value.unshift(r),q(),o()},F=r=>{for(let c=0;c<x.value.length;c++)if(x.value[c].id===r.id){x.value[c]=r,q(),o();break}},$=()=>{D.value=ve(f.value,JSON.stringify(x.value)),z.value=!1,j.value=[],x.value=[],f.value="",E.value.delLocalMainPassword()},w=()=>{E.value.verifyMainPassword()},h=r=>{let c=b("password.name")+": "+r.name+`\r
`;r.address&&(c+=b("password.address")+": "+r.address+`\r
`),r.userName&&(c+=b("password.userName")+": "+r.userName+`\r
`),r.password&&(c+=b("password.password")+": "+r.password+`\r
`),r.remark&&(c+=r.remark+`\r
`),c=c.substring(0,c.length-2),Ae(c)},A=r=>{for(let c=0;c<x.value.length;c++)if(x.value[c].id===r.id){x.value.splice(c,1),q(),o(),ee.success(b("index.table.delete.success"));break}},R=r=>{f.value=r;let c=me(r,D.value);x.value=JSON.parse(c),z.value=!0,o()},y=(r,c)=>{f.value=r,k.value=c,q(),ee.success(b("index.mainPassword.changeSuccess"))},B=()=>{_.value.openSystemSetting()},M=()=>{d.value.updateMainPassword()},Y=(r,c)=>{P[r]=c,r==="sortChange"&&fe(c)},fe=r=>{r==="insertTimeDesc"?se("insertTime",-1):r==="insertTimeAsc"?se("insertTime",1):r==="name"&&se("name",1),q(),o()},ae=r=>{let c=0;return/[0-9]/.test(r)&&c++,/[a-z]/.test(r)&&c++,/[A-Z]/.test(r)&&c++,/[^0-9a-zA-Z_]/.test(r)&&c++,r.length<6&&c>2&&(c=2),Te()>2&&c>2&&(c=2),c>3?3:c},Te=r=>{let c=0;for(let N=0;N<x.value.length;N++)x.value[N].password===r&&c++;return c},ge=r=>{let c=0;for(let N=0;N<x.value.length;N++){if(!x.value[N].password)continue;let K=ae(x.value[N].password);r===K&&c++}return c},se=(r,c)=>{x.value.sort((N,K)=>(N=N[r],K=K[r],N<K?c*-1:N>K?c*1:0))},q=()=>{if(!z.value)return;D.value=ve(f.value,JSON.stringify(x.value));let r=ve(f.value,"password-x");te.commit("setVerifyCode",r),at("password.json",{verifyValue:r,mainPasswordType:k.value,passwordCiphertext:D.value})},Me=()=>{st("password.json").then(r=>{if(r.verifyValue){let c=r.verifyValue;k.value=r.mainPasswordType||"common",te.commit("setVerifyCode",c),te.commit("setMainPasswordType",k.value),D.value=r.passwordCiphertext,E.value.verifyMainPassword(!0)}else z.value=!0,d.value.settingMainPassword()}).catch(r=>{console.error(r),Ze.error("error-1000："+r)})},Fe=r=>{I.value=r,o()},Ee=r=>{s.value=r},Re=r=>{if(!r)return"";let c=[];return m(s.value,r,c),c},m=(r,c,N)=>{for(let K=0;K<r.length;K++)c.includes(r[K].id)&&N.push(r[K].label),r[K].children&&r[K].children.length>0&&m(r[K].children,c,N)},nt=()=>{i.value.downloadExcelTemplate()},rt=()=>{i.value.importExcel(s.value)},dt=()=>{i.value.exportExcel(x.value,s.value)},it=(r,c)=>{if(r.length!==0){for(let N=r.length-1;N>=0;N--)x.value.unshift(r[N]);V.value.setLabelTree(c),q(),o()}},ut=()=>{_.value.logout()};return qe(()=>{let r=tt();for(let c in r)P[c]=r[c];P.language&&P.language!==O.value&&(O.value=P.language),Me()}),(r,c)=>{const N=Xe,K=ce,re=pe,de=Tt,ie=Mt,Ue=Ft,_e=Et,be=Rt,Q=Ut,ke=ze,mt=It,ct=Dt,pt=At,ft=Le,Be=Ie,wt=fl,gt=Ne,_t=il,bt=ot,yt=rl,vt=al,ht=Xt;return v(),J(X,null,[t(gt,{id:"passwordBody"},{default:l(()=>[t(Be,{xl:{span:16,offset:2},lg:{span:19},md:{span:19}},{default:l(()=>[t(ft,null,{header:l(()=>[G("div",wl,[G("div",null,[G("div",gl,[e(x)?(v(),U(N,{key:0,class:"password-table-title"},{default:l(()=>[S(C(e(x).length)+" "+C(e(b)("index.title.passwordCount")),1)]),_:1})):W("",!0),_l,e(P).showPasswordStrength?(v(),J("div",bl,[t(N,{class:"password-table-strength"},{default:l(()=>[S(C(e(b)("index.title.strength"))+"（ ",1),t(N,{type:"success"},{default:l(()=>[S(C(e(b)("index.title.strength.strong")),1)]),_:1}),S(" : "+C(ge(3))+" ",1),t(N,{style:{"margin-left":"5px"},type:"warning"},{default:l(()=>[S(C(e(b)("index.title.strength.medium")),1)]),_:1}),S(" : "+C(ge(2))+" ",1),t(N,{style:{"margin-left":"5px"},type:"danger"},{default:l(()=>[S(C(e(b)("index.title.strength.weak")),1)]),_:1}),S(" : "+C(ge(1))+"） ",1)]),_:1})])):W("",!0)])]),G("div",yl,[G("div",null,[t(K,{modelValue:e(a),"onUpdate:modelValue":c[0]||(c[0]=L=>ue(a)?a.value=L:null),style:{"max-width":"300px"},clearable:"",placeholder:e(b)("index.title.search"),"prefix-icon":e(Wt),disabled:!e(f),onKeyup:Qe(o,["enter"])},null,8,["modelValue","placeholder","prefix-icon","disabled","onKeyup"])]),G("div",null,[t(re,{disabled:!e(f)||!e(z),type:"primary",plain:"",onClick:c[1]||(c[1]=L=>n())},{default:l(()=>[S(C(e(b)("index.title.addPassword")),1)]),_:1},8,["disabled"])]),G("div",null,[e(f)?W("",!0):(v(),U(de,{key:0,content:e(b)("index.title.unlock"),effect:"dark",placement:"top"},{default:l(()=>[t(re,{disabled:!e(D),icon:e(jt),onClick:w},null,8,["disabled","icon"])]),_:1},8,["content"])),e(f)?(v(),U(de,{key:1,content:e(b)("index.title.lock"),effect:"dark",placement:"top"},{default:l(()=>[t(re,{icon:e(je),onClick:$},null,8,["icon"])]),_:1},8,["content"])):W("",!0)]),t(_e,null,{dropdown:l(()=>[t(Ue,null,{default:l(()=>[t(ie,{onClick:B},{default:l(()=>[S(C(e(b)("systemSetting.title")),1)]),_:1}),t(ie,{divided:"",onClick:rt},{default:l(()=>[S(C(e(b)("index.title.importExport.import")),1)]),_:1}),t(ie,{onClick:dt},{default:l(()=>[S(C(e(b)("index.title.importExport.export")),1)]),_:1}),t(ie,{onClick:nt},{default:l(()=>[S(C(e(b)("index.title.importExport.download")),1)]),_:1}),t(ie,{divided:"",onClick:ut},{default:l(()=>[S(C(e(b)("index.title.logout")),1)]),_:1})]),_:1})]),default:l(()=>[t(re,{icon:e(Ht)},null,8,["icon"])]),_:1})])])]),default:l(()=>[t(pt,{height:"calc(100vh - 150px)",data:e(j)},{empty:l(()=>[t(be,{description:e(f)?e(b)("index.table.empty"):e(b)("index.table.lock")},Se({default:l(()=>[t(re,{onClick:w,plain:"",type:"primary"},{default:l(()=>[S(C(e(b)("index.title.unlock")),1)]),_:1})]),_:2},[e(f)?void 0:{name:"image",fn:l(()=>[t(e(je))]),key:"0"}]),1032,["description"])]),default:l(()=>[e(P).showPasswordStrength?(v(),U(Q,{key:0,width:"30px"},{default:l(L=>[ae(L.row.password)===3?(v(),U(de,{key:0},{content:l(()=>[S(C(e(b)("index.title.strength")+"："+e(b)("index.title.strength.strong")),1)]),default:l(()=>[vl]),_:1})):W("",!0),ae(L.row.password)===2?(v(),U(de,{key:1},{content:l(()=>[S(C(e(b)("index.title.strength")+"："+e(b)("index.title.strength.medium")),1)]),default:l(()=>[hl]),_:1})):W("",!0),ae(L.row.password)===1?(v(),U(de,{key:2},{content:l(()=>[S(C(e(b)("index.title.strength")+"："+e(b)("index.title.strength.weak")),1)]),default:l(()=>[kl]),_:1})):W("",!0)]),_:1})):W("",!0),t(Q,{label:e(b)("password.name"),"min-width":"140px",prop:"name"},null,8,["label"]),t(Q,{label:e(b)("password.address"),"min-width":"200px",prop:"address"},{default:l(L=>[e(Gt)(L.row.address)?(v(),U(ke,{key:0,href:L.row.address,target:"_blank"},{default:l(()=>[S(C(L.row.address),1)]),_:2},1032,["href"])):(v(),U(N,{key:1},{default:l(()=>[S(C(L.row.address),1)]),_:2},1024))]),_:1},8,["label"]),t(Q,{label:e(b)("password.userName"),"min-width":"120px",prop:"userName"},null,8,["label"]),t(Q,{label:e(b)("password.password"),"min-width":"200px"},{default:l(L=>[L.row.password?(v(),J("div",Pl,[G("span",xl,[L.row.show?W("",!0):(v(),J(X,{key:0},[S("•••••••")],64)),L.row.show?(v(),J(X,{key:1},[S(C(L.row.password),1)],64)):W("",!0)]),G("div",Cl,[L.row.show?W("",!0):(v(),U(e(Jt),{key:0,onClick:oe=>L.row.show=!L.row.show},null,8,["onClick"])),L.row.show?(v(),U(e(Ot),{key:1,onClick:oe=>L.row.show=!L.row.show},null,8,["onClick"])):W("",!0),t(e(Kt),{onClick:oe=>e(Ae)(L.row.password)},null,8,["onClick"])])])):W("",!0)]),_:1},8,["label"]),t(Q,{label:e(b)("index.table.label"),"min-width":"130px"},{default:l(L=>[(v(!0),J(X,null,le(Re(L.row.label),oe=>(v(),U(mt,{style:{margin:"3px"},key:oe},{default:l(()=>[S(C(oe),1)]),_:2},1024))),128))]),_:1},8,["label"]),t(Q,{label:e(b)("password.remark"),"min-width":"100px",prop:"remark"},null,8,["label"]),e(P).showAddTime?(v(),U(Q,{key:1,label:e(b)("password.insertTime"),"min-width":"130px",prop:"insertTime"},null,8,["label"])):W("",!0),e(P).showUpTime?(v(),U(Q,{key:2,label:e(b)("password.updateTime"),"min-width":"130px",prop:"updateTime"},null,8,["label"])):W("",!0),t(Q,{"min-width":"140px",label:e(b)("index.table.operation")},{default:l(L=>[t(ke,{type:"success",underline:!1,onClick:oe=>h(L.row)},{default:l(()=>[S(C(e(b)("index.table.share")),1)]),_:2},1032,["onClick"]),t(ke,{underline:!1,style:{"margin-left":"10px"},type:"primary",onClick:oe=>u(L.row)},{default:l(()=>[S(C(e(b)("index.table.edit")),1)]),_:2},1032,["onClick"]),t(ct,{title:e(b)("index.table.operation.affirmDelete"),"confirm-button-text":e(b)("index.table.operation.affirm"),"cancel-button-text":e(b)("index.table.operation.cancel"),onConfirm:oe=>A(L.row)},{reference:l(()=>[t(ke,{style:{"margin-left":"10px"},underline:!1,type:"danger"},{default:l(()=>[S(C(e(b)("index.table.operation.delete")),1)]),_:1})]),_:2},1032,["title","confirm-button-text","cancel-button-text","onConfirm"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})]),_:1}),t(Be,{xl:{span:4},lg:{span:5},md:{span:5},class:"hidden-sm-and-down",style:{"padding-left":"15px"}},{default:l(()=>[t(wt,{ref_key:"labelTreeRef",ref:V,onLabelCheckChange:Fe,onLabelTreeChange:Ee},null,512)]),_:1})]),_:1}),t(_t,{ref_key:"passwordFormRef",ref:g,labelTree:e(s),onAddPassword:p,onUpdatePassword:F},null,8,["labelTree"]),t(bt,{ref_key:"mainPasswordVerifyRef",ref:E,onVerifyPass:R},null,512),t(yt,{ref_key:"mainPasswordSettingRef",ref:d,onMainPasswordChange:y},null,512),t(vt,{ref_key:"systemSettingRef",ref:_,onUpdateMainPassword:M,onSystemChangeChange:Y},null,512),t(ht,{ref_key:"importExportRef",ref:i,labelTree:e(s),onImportComplete:it},null,8,["labelTree"])],64)}}},Kl=lt(Sl,[["__scopeId","data-v-030e35db"]]);export{Kl as default};
