import{E as Ne}from"./exceljs-6b62d6db.js";import{F as He}from"./file-saver-38a5c18e.js";import{h as ke}from"./moment-fbc5633a.js";import{u as re}from"./vue-i18n-3214f365.js";import{E as le,a as ze,b as fe,c as we,d as Te,e as kt,f as Pt,g as Me,h as Xe,i as $e,j as Be,k as Ze,l as qe,m as Fe,n as Qe,o as Ge,p as Ye,q as xt,r as Ct,s as et,t as St,u as Vt,v as Tt,w as Mt,x as Ft,y as Et,z as Rt,A as Ut,B as Dt,C as At,D as It}from"./element-plus-19fbf28c.js";import{r as T,o as v,c as j,X as W,b as tt,u as e,O as $,I as E,ac as Ee,J as l,a as z,S as t,P as S,Q as C,A as ce,R as X,aj as te,ak as lt,w as Je,aq as Nt,ar as Lt}from"./@vue-8e6a53e5.js";import{m as zt}from"./js-md5-11f5a111.js";import{h as at}from"./@vueuse-9ffc2ac5.js";import{d as pe,s as ae,g as xe,a as Oe,l as st,u as $t,b as be,e as Pe,c as Le,r as Bt,_ as ot,p as nt,f as rt,i as Gt}from"./index-733e4fd7.js";import{u as Yt}from"./vue-router-c2e97886.js";import{_ as Wt}from"./backImg-a3b16eec.js";import{m as jt,u as Ht,n as Ke,o as Jt,v as Ot,h as Kt,r as Xt}from"./@element-plus-169d18e8.js";import"./ali-oss-21f5c855.js";import"./@intlify-6e8dbf92.js";import"./lodash-es-f5bdeb48.js";import"./async-validator-dee29e8b.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./escape-html-cf2a8097.js";import"./normalize-wheel-es-ed76fb12.js";import"./crypto-js-d55471a7.js";import"./vuex-7c7bb3a2.js";import"./cos-js-sdk-v5-31c61e27.js";const Zt={__name:"ImportExport",emits:["importComplete"],setup(q,{expose:y,emit:J}){const{t:g}=re(),M=J,r=T(),b=T(),u=T(0),V=s=>{r.value.click(),b.value=s},P=async()=>{if(r.value.files===0)return;u.value=Date.now();const s=new Ne.Workbook;s.xlsx.load(r.value.files[0]).then(()=>{s.eachSheet(function(o){if(o.rowCount<2){le.error(g("importExport.data.empty")),r.value.value="";return}let n=[];for(let c=2;c<=o.rowCount;c++){let p=o.getRow(c),F=a(p.getCell(1).value),B=a(p.getCell(2).value),_=a(p.getCell(3).value),h=a(p.getCell(4).value),D=a(p.getCell(5).value),R=a(p.getCell(6).value),Z=a(p.getCell(7).value),H=a(p.getCell(8).value);F&&n.push({id:u.value++,name:F,address:B,userName:_,password:h,remark:R,label:w(D),insertTime:Z,updateTime:H})}M("importComplete",n,b.value),r.value.value=""})}).catch(o=>{le.error(o),r.value.value=""})},a=s=>s?typeof s=="object"?s instanceof Date?ke(s).format("YYYY-MM-DD HH:mm:ss"):s.text:s.toString():"",w=s=>{if(!s)return"";let o=[],n=s.split("、");for(let c=0;c<n.length;c++){let p=k(b.value,n[c],"");if(p)o.push(p);else{let F=[];N(b.value,n[c].split(">"),0,F);for(let B=0;B<F.length;B++)o.push(F[B])}}return Array.from(new Set(o))},k=(s,o,n)=>{for(let c=0;c<s.length;c++){let p=n?n+">"+s[c].label:s[c].label;if(o===p)return s[c].id;if(s[c].children&&s[c].children.length>0)return k(s[c].children,o,p)}},N=(s,o,n,c)=>{if(!o[n])return;for(let F=0;F<s.length;F++)if(s[F].label===o[n])return o[n+1]||c.push(s[F].id),N(s[F].children,o,n+1,c);let p={id:u.value++,label:o[n],children:[]};s.push(p),o[n+1]||c.push(p.id),N(p.children,o,n+1,c)},U=async(s,o)=>{b.value=o;const n=new Ne.Workbook,c=n.addWorksheet("sheet1");c.getCell("A1").value=g("password.name"),c.getCell("B1").value=g("password.address"),c.getCell("C1").value=g("password.userName"),c.getCell("D1").value=g("password.password"),c.getCell("E1").value=g("password.label"),c.getCell("F1").value=g("password.remark"),c.getCell("G1").value=g("password.insertTime"),c.getCell("H1").value=g("password.updateTime");for(let p=0;p<s.length;p++){let F=s[p].insertTime;F||(F=ke().format("YYYY-MM-DD HH:mm:ss")),c.getCell("A"+(p+2)).value=s[p].name,c.getCell("B"+(p+2)).value=s[p].address,c.getCell("C"+(p+2)).value=s[p].userName,c.getCell("D"+(p+2)).value=s[p].password,c.getCell("E"+(p+2)).value=x(s[p].label),c.getCell("F"+(p+2)).value=s[p].remark,c.getCell("G"+(p+2)).value=F,c.getCell("H"+(p+2)).value=s[p].updateTime}n.xlsx.writeBuffer().then(p=>{let F=new Blob([p],{type:"application/octet-stream"});He.saveAs(F,g("importExport.exportName")+"_"+ke().format("YYYY-MM-DD HH:mm:ss")+".xlsx")})},x=s=>{if(!s)return"";let o=[];return Y(b.value,s,o,""),o.join("、")},Y=(s,o,n,c)=>{for(let p=0;p<s.length;p++){let F=c?c+">"+s[p].label:s[p].label;o.includes(s[p].id)&&n.push(F),s[p].children&&s[p].children.length>0&&Y(s[p].children,o,n,F)}};return y({importExcel:V,exportExcel:U,downloadExcelTemplate:()=>{const s=new Ne.Workbook,o=s.addWorksheet("sheet1");o.getCell("A1").value=g("password.name"),o.getCell("B1").value=g("password.address"),o.getCell("C1").value=g("password.userName"),o.getCell("D1").value=g("password.password"),o.getCell("E1").value=g("password.label"),o.getCell("F1").value=g("password.remark"),o.getCell("G1").value=g("password.insertTime"),o.getCell("H1").value=g("password.updateTime"),s.xlsx.writeBuffer().then(n=>{let c=new Blob([n],{type:"application/octet-stream"});He.saveAs(c,g("importExport.importTemplateName")+".xlsx")})}}),(s,o)=>(v(),j("input",{type:"file",onChange:P,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ref_key:"fileUploadInput",ref:r,style:{display:"none"}},null,544))}},qt=["width","height"],We={__name:"GesturePassword",props:{size:{type:Number,default:300},count:{type:Number,default:3},showGesture:{type:Boolean,default:!0}},emits:["complete"],setup(q,{expose:y,emit:J}){const g=at(),M=J,r=T();let b=q;const u=W({padding:b.size*.18,background:g.value?"rgb(20,20,20)":"#fff",failColor:"#F56C6C",passColor:"#67C23A",point:{color:"#409EFF",size:b.size*.023,selected:{range:b.size*.07,color:"#409EFF",size:b.size*.023,madding:{color:"#409EFF",size:b.size*.07,lineWidth:1}}},line:{color:"#409EFF",width:2}}),V=T({}),P=T([]),a=T(!1),w=T("");let k=null;const N=()=>{u.background=g.value?"rgb(20,20,20)":"#fff",k=r.value.getContext("2d"),U()},U=()=>{k.fillStyle=u.background,k.fillRect(0,0,b.size,b.size),V.value=[];let _=(b.size-u.padding*2)/(b.count-1),h=1;for(let D=0;D<b.count;D++)for(let R=0;R<b.count;R++){let Z=u.padding+R*_,H=u.padding+D*_,m=_/2,G={id:h,x:Z,y:H,startX:Z-m,endX:Z+m,startY:H-m,endY:H+m,h:_,w:_};x(G),V.value[h]=G,h++}},x=_=>{let h=p(_);h&&b.showGesture&&(k.beginPath(),w.value==="fail"?k.strokeStyle=u.failColor:w.value==="pass"?k.strokeStyle=u.passColor:k.strokeStyle=u.point.selected.madding.color,k.lineWidth=u.point.selected.madding.lineWidth,k.arc(_.x,_.y,u.point.selected.madding.size,0,Math.PI*2),k.stroke()),k.beginPath(),h&&b.showGesture?(w.value==="fail"?k.fillStyle=u.failColor:w.value==="pass"?k.fillStyle=u.passColor:k.fillStyle=u.point.selected.madding.color,k.arc(_.x,_.y,u.point.selected.size,0,Math.PI*2)):(k.fillStyle=u.point.color,k.arc(_.x,_.y,u.point.size,0,Math.PI*2)),k.fill()},Y=()=>{a.value=!0},A=()=>{if(!a.value)return;a.value=!1;let _=o();if(_){let h=zt(_);M("complete",h)}U(),c()},s=_=>{w.value=_,U(),c(),_?setTimeout(()=>{w.value="",P.value=[],U()},500):(P.value=[],U())},o=()=>{let _="";for(let h=0;h<P.value.length;h++)_+=P.value[h].id+",";return _&&(_=_.substring(0,_.length-1)),_},n=_=>{let h=_.offsetX,D=_.offsetY;if(U(),c(h,D),!a.value)return;let R=F(h,D);!R||p(R)||(P.value.push(R),U(),c(h,D))},c=(_,h)=>{if(!b.showGesture)return;let D=F(_,h);if(D&&w.value===""&&(k.beginPath(),k.strokeStyle=u.point.selected.madding.color,k.lineWidth=u.point.selected.madding.lineWidth,k.arc(D.x,D.y,u.point.selected.madding.size,0,Math.PI*2),k.stroke()),P.value.length!==0){k.beginPath(),w.value==="fail"?k.strokeStyle=u.failColor:w.value==="pass"?k.strokeStyle=u.passColor:k.strokeStyle=u.line.color,k.lineWidth=u.line.width,k.lineCap="round",k.moveTo(P.value[0].x,P.value[0].y);for(let R=1;R<P.value.length;R++)k.lineTo(P.value[R].x,P.value[R].y);a.value&&_&&h&&w.value===""&&k.lineTo(_,h),k.stroke()}},p=_=>{for(let h=0;h<P.value.length;h++)if(_.id===P.value[h].id)return!0;return!1},F=(_,h)=>{for(let D in V.value){let R=V.value[D];if(_>R.startX+u.point.selected.range&&_<R.endX-u.point.selected.range&&h>R.startY+u.point.selected.range&&h<R.endY-u.point.selected.range)return R}},B=_=>{let h=_.touches[0].clientX-r.value.offsetLeft,D=_.touches[0].clientY-r.value.offsetTop;n({offsetX:h,offsetY:D})};return tt(()=>{N()}),y({setVerifyStatus:s}),(_,h)=>e(b).size?(v(),j("canvas",{key:0,width:e(b).size,height:e(b).size,ref_key:"canvasRef",ref:r,onMousedown:Y,onMouseup:A,onMousemove:h[0]||(h[0]=D=>n(D)),onMouseleave:A,onTouchstart:Y,onTouchend:A,onTouchmove:B},null,40,qt)):$("",!0)}},Qt={style:{"text-align":"center"}},el={class:"dialog-footer"},tl={__name:"DeleteAccount",emits:["deleteAccount"],setup(q,{expose:y,emit:J}){const{t:g}=re(),M=J,r=T(),b=W({deleteAccount:!1}),u=T(""),V=T(""),P=()=>{let N=pe(V.value,ae.state.verifyCode);if(N&&N==="password-x"){u.value==="gesture"&&r.value.setVerifyStatus("pass");let U=localStorage.getItem("databaseForm"),x=pe(xe(),U);if(JSON.parse(x).keyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){le.error("演示账号不能注销");return}Oe("password.json"),Oe("labelTree.json"),localStorage.removeItem("systemConfig"),le.success(g("systemSetting.deleteAccount.success")),M("deleteAccount")}else u.value==="common"?le.error(g("systemSetting.deleteAccount.mainPasswordError")):r.value.setVerifyStatus("fail")},a=()=>{u.value=ae.state.mainPasswordType,b.deleteAccount=!0},w=N=>{V.value=N,P()},k=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){k.value=document.documentElement.clientWidth<728}),y({showDeleteAccount:a}),(N,U)=>{const x=ze,Y=We,A=fe,s=we,o=Te;return v(),E(o,{fullscreen:e(k),modelValue:e(b).deleteAccount,"onUpdate:modelValue":U[1]||(U[1]=n=>e(b).deleteAccount=n),title:e(g)("systemSetting.deleteAccount"),width:"400px"},Ee({default:l(()=>[t(x,{type:"error",closable:!1},{default:l(()=>[S(C(e(g)("systemSetting.deleteAccount.text")),1)]),_:1}),z("div",Qt,[e(u)==="gesture"?(v(),E(Y,{key:0,ref_key:"gesturePasswordRef",ref:r,onComplete:w},null,512)):$("",!0),e(u)==="common"?(v(),E(A,{key:1,modelValue:e(V),"onUpdate:modelValue":U[0]||(U[0]=n=>ce(V)?V.value=n:null),style:{"margin-top":"20px"}},null,8,["modelValue"])):$("",!0)])]),_:2},[e(u)==="common"?{name:"footer",fn:l(()=>[z("span",el,[t(s,{type:"danger",onClick:P},{default:l(()=>[S(C(e(g)("systemSetting.deleteAccount.affirm")),1)]),_:1})])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},ll={style:{"text-align":"center"}},al={class:"dialog-footer"},sl={__name:"SystemSetting",emits:["updateMainPassword","deleteAccount","systemChangeChange"],setup(q,{expose:y,emit:J}){const g=Yt(),M=at(),{t:r,locale:b}=re(),u=J,V=T(),P=W({setting:!1}),a=W({language:"zh-cn",cacheMainPassword:!0,autoGeneratePassword:!0,darkMode:!1,sortRule:"insertTimeDesc",showPasswordStrength:!1,cacheDatabaseForm:!0,showAddTime:!0,showUpTime:!1,verifyShowGesture:!0,showLabel:!0,defaultPasswordRule:{length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}}),w=W([{key:"zh-cn",label:"简体中文"},{key:"en-us",label:"English"}]),k=W([{key:"insertTimeDesc",label:r("systemSetting.sort.insertTimeDesc")},{key:"insertTimeAsc",label:r("systemSetting.sort.insertTimeAsc")},{key:"name",label:r("systemSetting.sort.name")}]),N=W([{key:!1,label:r("systemSetting.topic.light")},{key:!0,label:r("systemSetting.topic.dark")}]),U=W([{key:!0,label:r("systemSetting.cacheMainPassword.enable")},{key:!1,label:r("systemSetting.cacheMainPassword.disabled")}]),x=W([{key:!0,label:r("systemSetting.showAddTime.enable")},{key:!1,label:r("systemSetting.showAddTime.disabled")}]),Y=W([{key:!0,label:r("systemSetting.showUpTime.enable")},{key:!1,label:r("systemSetting.showUpTime.disabled")}]),A=W([{key:!0,label:r("systemSetting.showLabel.enable")},{key:!1,label:r("systemSetting.showLabel.disabled")}]),s=W([{key:!0,label:r("mainPasswordSetting.verify.showGesture.enable")},{key:!1,label:r("mainPasswordSetting.verify.showGesture.disabled")}]),o=W([{key:!0,label:r("systemSetting.cacheDatabaseForm.enable")},{key:!1,label:r("systemSetting.cacheDatabaseForm.disabled")}]),n=W([{key:!0,label:r("passwordForm.autoGeneratePassword.enable")},{key:!1,label:r("passwordForm.autoGeneratePassword.disabled")}]),c=W([{key:!0,label:r("systemSetting.showPasswordStrength.enable")},{key:!1,label:r("systemSetting.showPasswordStrength.disabled")}]);let p=null;const F=()=>{let H=st();if(H)for(let m in H)a[m]=H[m];a.language!==b.value&&(a.language=b.value),p=JSON.stringify(a),P.setting=!0},B=()=>{P.setting=!1},_=()=>{let H=a.defaultPasswordRule;if(!H.number&&!H.symbol&&!H.lowercase&&!H.uppercase){le.error(r("systemSetting.passwordRuleVerify"));return}$t(a);let m=JSON.parse(p);a.cacheMainPassword!==m.cacheMainPassword&&a.cacheMainPassword===!1&&localStorage.removeItem("mainPasswordCiphertext"),a.cacheDatabaseForm!==m.cacheDatabaseForm&&a.cacheDatabaseForm===!1&&localStorage.removeItem("databaseForm"),a.language!==b.value&&(b.value=a.language,console.log("系统语言设置为：",a.language)),M.value!==a.darkMode&&(M.value=a.darkMode,console.log("暗黑模式设置为：",a.darkMode)),a.sortRule!==m.sortRule&&(u("systemChangeChange","sortChange",a.sortRule),console.log("排序规则设置为：",a.sortRule)),a.showPasswordStrength!==m.showPasswordStrength&&(u("systemChangeChange","showPasswordStrength",a.showPasswordStrength),console.log("是否显示密码强度设置为：",a.showPasswordStrength)),P.setting=!1},h=()=>{localStorage.removeItem("databaseForm"),localStorage.removeItem("mainPasswordCiphertext"),ae.commit("delDatabase"),ae.commit("delDatabaseForm"),g.push("/login")},D=()=>{P.setting=!1,u("updateMainPassword")},R=()=>{P.setting=!1,V.value.showDeleteAccount()},Z=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){Z.value=document.documentElement.clientWidth<728}),y({logout:h,openSystemSetting:F,showUpdateMainPassword:D}),(H,m)=>{const G=kt,Q=Pt,K=Me,ge=Xe,se=$e,ye=fe,oe=Be,_e=Ze,de=we,Re=qe,Ue=Fe,Se=ze,De=Te,Ae=tl;return v(),j(X,null,[t(De,{fullscreen:e(Z),modelValue:e(P).setting,"onUpdate:modelValue":m[16]||(m[16]=d=>e(P).setting=d),title:e(r)("systemSetting.title"),width:"600px"},{footer:l(()=>[z("span",al,[t(de,{plain:"",onClick:B},{default:l(()=>[S(C(e(r)("systemSetting.close")),1)]),_:1}),t(de,{type:"primary",plain:"",onClick:_},{default:l(()=>[S(C(e(r)("systemSetting.save")),1)]),_:1})])]),default:l(()=>[t(Ue,{model:e(a),"label-width":"120px"},{default:l(()=>[t(Re,{"tab-position":"left",style:{height:"350px"}},{default:l(()=>[t(_e,{label:"常规"},{default:l(()=>[t(K,{label:e(r)("systemSetting.language")},{default:l(()=>[t(Q,{modelValue:e(a).language,"onUpdate:modelValue":m[0]||(m[0]=d=>e(a).language=d)},{default:l(()=>[(v(!0),j(X,null,te(e(w),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(K,{label:e(r)("systemSetting.sort")},{default:l(()=>[t(Q,{modelValue:e(a).sortRule,"onUpdate:modelValue":m[1]||(m[1]=d=>e(a).sortRule=d)},{default:l(()=>[(v(!0),j(X,null,te(e(k),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(K,{label:e(r)("passwordForm.autoGeneratePassword")},{default:l(()=>[t(Q,{modelValue:e(a).autoGeneratePassword,"onUpdate:modelValue":m[2]||(m[2]=d=>e(a).autoGeneratePassword=d)},{default:l(()=>[(v(!0),j(X,null,te(e(n),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(K,{label:e(r)("systemSetting.defaultPasswordRule")},{default:l(()=>[t(oe,{style:{"margin-top":"15px"}},{default:l(()=>[t(se,{span:12},{default:l(()=>[t(ge,{size:"small",modelValue:e(a).defaultPasswordRule.uppercase,"onUpdate:modelValue":m[3]||(m[3]=d=>e(a).defaultPasswordRule.uppercase=d),label:e(r)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(se,{span:12},{default:l(()=>[t(ge,{size:"small",modelValue:e(a).defaultPasswordRule.lowercase,"onUpdate:modelValue":m[4]||(m[4]=d=>e(a).defaultPasswordRule.lowercase=d),label:e(r)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(se,{span:12},{default:l(()=>[t(ge,{size:"small",modelValue:e(a).defaultPasswordRule.number,"onUpdate:modelValue":m[5]||(m[5]=d=>e(a).defaultPasswordRule.number=d),label:e(r)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(se,{span:12},{default:l(()=>[t(ge,{size:"small",modelValue:e(a).defaultPasswordRule.symbol,"onUpdate:modelValue":m[6]||(m[6]=d=>e(a).defaultPasswordRule.symbol=d),label:e(r)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1}),t(se,{span:24},{default:l(()=>[z("div",null,[t(ye,{size:"small",style:{position:"relative",top:"3px"},modelValue:e(a).defaultPasswordRule.length,"onUpdate:modelValue":m[7]||(m[7]=d=>e(a).defaultPasswordRule.length=d)},{prepend:l(()=>[S(C(e(r)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["label"])]),_:1}),t(_e,{label:"个性化"},{default:l(()=>[t(K,{label:e(r)("systemSetting.topic")},{default:l(()=>[t(Q,{modelValue:e(a).darkMode,"onUpdate:modelValue":m[8]||(m[8]=d=>e(a).darkMode=d)},{default:l(()=>[(v(!0),j(X,null,te(e(N),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(K,{label:e(r)("systemSetting.showPasswordStrength")},{default:l(()=>[t(Q,{modelValue:e(a).showPasswordStrength,"onUpdate:modelValue":m[9]||(m[9]=d=>e(a).showPasswordStrength=d)},{default:l(()=>[(v(!0),j(X,null,te(e(c),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(K,{label:e(r)("systemSetting.showAddTime")},{default:l(()=>[t(Q,{modelValue:e(a).showAddTime,"onUpdate:modelValue":m[10]||(m[10]=d=>e(a).showAddTime=d)},{default:l(()=>[(v(!0),j(X,null,te(e(x),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(K,{label:e(r)("systemSetting.showUpTime")},{default:l(()=>[t(Q,{modelValue:e(a).showUpTime,"onUpdate:modelValue":m[11]||(m[11]=d=>e(a).showUpTime=d)},{default:l(()=>[(v(!0),j(X,null,te(e(Y),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(K,{label:e(r)("systemSetting.showLabel")},{default:l(()=>[t(Q,{modelValue:e(a).showLabel,"onUpdate:modelValue":m[12]||(m[12]=d=>e(a).showLabel=d)},{default:l(()=>[(v(!0),j(X,null,te(e(A),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),t(_e,{label:"安全"},{default:l(()=>[t(K,{label:e(r)("systemSetting.cacheMainPassword")},{default:l(()=>[t(Q,{modelValue:e(a).cacheMainPassword,"onUpdate:modelValue":m[13]||(m[13]=d=>e(a).cacheMainPassword=d)},{default:l(()=>[(v(!0),j(X,null,te(e(U),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(K,{label:e(r)("systemSetting.cacheDatabaseForm")},{default:l(()=>[t(Q,{modelValue:e(a).cacheDatabaseForm,"onUpdate:modelValue":m[14]||(m[14]=d=>e(a).cacheDatabaseForm=d)},{default:l(()=>[(v(!0),j(X,null,te(e(o),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(K,{label:e(r)("mainPasswordSetting.verify.showGesture")},{default:l(()=>[t(Q,{modelValue:e(a).verifyShowGesture,"onUpdate:modelValue":m[15]||(m[15]=d=>e(a).verifyShowGesture=d)},{default:l(()=>[(v(!0),j(X,null,te(e(s),d=>(v(),E(G,{key:d.key,label:d.label,value:d.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),t(_e,{label:"其他"},{default:l(()=>[z("div",ll,[t(de,{plain:"",onClick:D},{default:l(()=>[S(C(e(r)("systemSetting.updateMainPassword")),1)]),_:1}),t(de,{plain:"",type:"danger",onClick:R},{default:l(()=>[S(C(e(r)("systemSetting.deleteAccount")),1)]),_:1}),t(de,{type:"warning",plain:"",onClick:h},{default:l(()=>[S(C(e(r)("systemSetting.logout")),1)]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"]),t(Se,{style:{"margin-top":"20px"},type:"warning"},{default:l(()=>[S(C(e(r)("systemSetting.takeEffect")),1)]),_:1})]),_:1},8,["fullscreen","modelValue","title"]),t(Ae,{ref_key:"deleteAccountRef",ref:V,onDeleteAccount:h},null,512)],64)}}},ol={style:{"text-align":"center"}},nl={class:"dialog-footer"},dt={__name:"MainPasswordVerify",emits:["verifyPass"],setup(q,{expose:y,emit:J}){const{t:g}=re(),M=J,r=T(),b=T(""),u=T(""),V=W({verifyMainPassword:!1}),P=A=>{b.value=A,a()},a=()=>{let A=pe(b.value,ae.state.verifyCode);A&&A==="password-x"?(u.value==="gesture"&&r.value.setVerifyStatus("pass"),M("verifyPass",b.value),k(b.value),b.value="",V.verifyMainPassword=!1):u.value==="common"?le.error(g("mainPasswordVerify.form.verify")):r.value.setVerifyStatus("fail")},w=()=>{localStorage.removeItem("mainPasswordCiphertext")},k=A=>{if(be("cacheMainPassword")===!1)return;let o=xe(),n=Pe(o,A);localStorage.setItem("mainPasswordCiphertext",n)},N=()=>{if(be("cacheMainPassword")===!1)return null;let s=localStorage.getItem("mainPasswordCiphertext");if(!s)return null;let o=xe(),n=pe(o,s);return n||null},U=()=>be("verifyShowGesture")!==!1,x=(A=!0)=>{if(u.value=ae.state.mainPasswordType,!A){V.verifyMainPassword=!0;return}let s=N();if(!s){V.verifyMainPassword=!0;return}let o=pe(s,ae.state.verifyCode);o&&o==="password-x"?M("verifyPass",s):V.verifyMainPassword=!0},Y=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){Y.value=document.documentElement.clientWidth<728}),y({verifyMainPassword:x,delLocalMainPassword:w}),(A,s)=>{const o=We,n=fe,c=Me,p=Fe,F=we,B=Te;return v(),E(B,{fullscreen:e(Y),modelValue:e(V).verifyMainPassword,"onUpdate:modelValue":s[1]||(s[1]=_=>e(V).verifyMainPassword=_),title:e(g)("mainPasswordVerify.form.title"),width:"400px"},Ee({default:l(()=>[z("div",ol,[e(u)==="gesture"&&e(V).verifyMainPassword?(v(),E(o,{key:0,"show-gesture":U(),ref_key:"gesturePasswordRef",ref:r,onComplete:P},null,8,["show-gesture"])):$("",!0),e(u)==="common"&&e(V).verifyMainPassword?(v(),E(p,{key:1,style:{padding:"10px"}},{default:l(()=>[t(c,null,{default:l(()=>[t(n,{modelValue:e(b),"onUpdate:modelValue":s[0]||(s[0]=_=>ce(b)?b.value=_:null),placeholder:e(g)("mainPasswordVerify.form.mainPassword"),type:"password",onKeyup:lt(a,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1})]),_:1})):$("",!0)])]),_:2},[e(u)==="common"?{name:"footer",fn:l(()=>[z("span",nl,[t(F,{type:"primary",disabled:!e(b),onClick:a},{default:l(()=>[S(C(e(g)("mainPasswordVerify.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},rl={class:"dialog-footer"},dl={__name:"MainPasswordSetting",emits:["mainPasswordChange"],setup(q,{expose:y,emit:J}){const{t:g}=re(),M=J,r=T(),b=T(),u=T("gesture"),V=T(""),P=T(""),a=W({mainPassword:!1}),w=T(""),k=s=>{w.value==="setting"?(V.value=s,w.value="affirm",b.value.setVerifyStatus("")):w.value==="affirm"&&(P.value=s,N())},N=()=>{if(V.value!==P.value){le.error(g("mainPasswordSetting.form.passwordsDiff"));return}let s=localStorage.getItem("databaseForm"),o=pe(xe(),s);if(JSON.parse(o).accessKeyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){le.error("演示账号不能修改主密码");return}u.value==="gesture"?ae.commit("setMainPasswordType","gesture"):ae.commit("setMainPasswordType","common"),M("mainPasswordChange",V.value,u.value);let c=be("cacheMainPassword");if(c||c==null){let p=xe(),F=Pe(p,V.value);localStorage.setItem("mainPasswordCiphertext",F)}V.value="",P.value="",a.mainPassword=!1},U=()=>{w.value="setting",a.mainPassword=!0},x=()=>{r.value.verifyMainPassword(!1)},Y=()=>{u.value==="gesture"&&(w.value="setting"),V.value="",P.value=""},A=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){A.value=document.documentElement.clientWidth<728}),y({settingMainPassword:U,updateMainPassword:x}),(s,o)=>{const n=ze,c=Qe,p=We,F=Ge,B=Ze,_=fe,h=Me,D=Fe,R=qe,Z=we,H=Te,m=dt;return v(),j(X,null,[t(H,{fullscreen:e(A),modelValue:e(a).mainPassword,"onUpdate:modelValue":o[4]||(o[4]=G=>e(a).mainPassword=G),title:e(g)("mainPasswordSetting.form.setMainPassword"),width:"470px"},Ee({default:l(()=>[t(n,{type:"error",style:{position:"relative",top:"-10px"},closable:!1},{default:l(()=>[S(C(e(g)("mainPasswordSetting.forget.message")),1)]),_:1}),t(R,{modelValue:e(u),"onUpdate:modelValue":o[3]||(o[3]=G=>ce(u)?u.value=G:null),style:{"margin-top":"10px"},type:"card",onTabChange:Y},{default:l(()=>[t(B,{label:e(g)("mainPasswordSetting.passwordType.gesture"),name:"gesture",style:{"text-align":"center"}},{default:l(()=>[z("div",null,[e(w)==="setting"?(v(),E(c,{key:0},{default:l(()=>[S(C(e(g)("mainPasswordSetting.gesture.first")),1)]),_:1})):$("",!0),e(w)==="affirm"?(v(),E(c,{key:1},{default:l(()=>[S(C(e(g)("mainPasswordSetting.gesture.affirm")),1)]),_:1})):$("",!0)]),e(a).mainPassword&&e(u)==="gesture"?(v(),E(p,{key:0,ref_key:"gesturePasswordRef",ref:b,onComplete:k},null,512)):$("",!0),z("div",null,[t(F,{underline:!1,style:{position:"relative",top:"-2px"},type:"primary",onClick:o[0]||(o[0]=G=>w.value="setting")},{default:l(()=>[S(C(e(g)("mainPasswordSetting.gesture.reset")),1)]),_:1})])]),_:1},8,["label"]),t(B,{label:e(g)("mainPasswordSetting.passwordType.common"),name:"common",style:{"text-align":"center"}},{default:l(()=>[t(D,{inline:!0,"label-width":"100px",style:{"margin-top":"20px"}},{default:l(()=>[t(h,{label:e(g)("mainPasswordSetting.form.newMainPassword")},{default:l(()=>[t(_,{type:"password",modelValue:e(V),"onUpdate:modelValue":o[1]||(o[1]=G=>ce(V)?V.value=G:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"]),t(h,{label:e(g)("mainPasswordSetting.form.newMainPasswordAffirm")},{default:l(()=>[t(_,{type:"password",modelValue:e(P),"onUpdate:modelValue":o[2]||(o[2]=G=>ce(P)?P.value=G:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:2},[e(u)==="common"?{name:"footer",fn:l(()=>[z("span",rl,[t(Z,{type:"primary",disabled:!e(V),onClick:N},{default:l(()=>[S(C(e(g)("mainPasswordSetting.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"]),t(m,{ref_key:"mainPasswordVerifyRef",ref:r,onVerifyPass:U},null,512)],64)}}},il={class:"dialog-footer"},ul={__name:"PasswordForm",props:{labelTree:Array},emits:["addPassword","updatePassword"],setup(q,{expose:y,emit:J}){const g=J,{t:M}=re(),r=T(),b=W({password:!1}),u=T(""),V=W({uppercase:"ABCDEFGHJKLMNPQRSTUVWXYZ",lowercase:"abcdefghjkmnpqrstuvwxyz",number:"0123456789",symbol:"~!@#$^&*()_+.,;"}),P=()=>({id:0,name:"",address:"",userName:"",password:"",remark:"",label:"",insertTime:"",updateTime:""}),a=W(P()),w=W({length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}),k=W({name:[{required:!0,message:M("passwordForm.form.name.verify"),trigger:"blur"}]}),N=()=>{if(!w.number&&!w.symbol&&!w.lowercase&&!w.uppercase){le.error(M("systemSetting.passwordRuleVerify"));return}let o=[];w.lowercase&&o.push(V.lowercase),w.uppercase&&o.push(V.uppercase),w.symbol&&o.push(V.symbol),w.number&&o.push(V.number),a.password=Bt(o,w.length)},U=async o=>{await o.validate(n=>{n&&(b.password=!1,u.value==="add"?(a.id=Date.now(),a.insertTime=ke().format("YYYY-MM-DD HH:mm:ss"),g("addPassword",JSON.parse(JSON.stringify(a)))):(a.updateTime=ke().format("YYYY-MM-DD HH:mm:ss"),g("updatePassword",JSON.parse(JSON.stringify(a)))))})},x=()=>{let o=be("defaultPasswordRule");if(o)for(let n in o)w[n]=o[n]},Y=()=>{x();let o=P();for(let c in o)a[c]=o[c];be("autoGeneratePassword")&&N(),u.value="add",b.password=!0},A=o=>{x();for(let n in a)a[n]=o[n];u.value="update",b.password=!0},s=()=>document.documentElement.clientWidth;return y({showAddPassword:Y,showUpdatePassword:A}),(o,n)=>{const c=fe,p=Me,F=we,B=$e,_=Be,h=Xe,D=Ye,R=xt,Z=Fe,H=Ct;return v(),E(H,{modelValue:e(b).password,"onUpdate:modelValue":n[13]||(n[13]=m=>e(b).password=m),title:e(u)==="add"?e(M)("passwordForm.form.addPassword"):e(M)("passwordForm.form.editPassword"),size:"620px",direction:s()>768?"rtl":"btt"},{footer:l(()=>[z("span",il,[t(F,{onClick:n[12]||(n[12]=m=>U(e(r))),type:"primary"},{default:l(()=>[S(C(e(M)("passwordForm.generateForm.save")),1)]),_:1})])]),default:l(()=>[t(Z,{ref_key:"passwordFormRef",ref:r,model:e(a),rules:e(k),"label-width":"70px",style:{"padding-right":"30px"}},{default:l(()=>[t(p,{label:e(M)("password.name"),prop:"name"},{default:l(()=>[t(c,{modelValue:e(a).name,"onUpdate:modelValue":n[0]||(n[0]=m=>e(a).name=m),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(M)("password.address")},{default:l(()=>[t(c,{modelValue:e(a).address,"onUpdate:modelValue":n[1]||(n[1]=m=>e(a).address=m),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(M)("password.userName")},{default:l(()=>[t(c,{modelValue:e(a).userName,"onUpdate:modelValue":n[2]||(n[2]=m=>e(a).userName=m),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(M)("password.password")},{default:l(()=>[t(D,{style:{width:"100%"}},{default:l(()=>[t(_,null,{default:l(()=>[t(B,null,{default:l(()=>[t(c,{modelValue:e(a).password,"onUpdate:modelValue":n[4]||(n[4]=m=>e(a).password=m),clearable:""},{append:l(()=>[t(F,{onClick:n[3]||(n[3]=m=>e(Le)(e(a).password))},{default:l(()=>[S(C(e(M)("passwordForm.generateForm.password.copy")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(_,{style:{"margin-top":"15px"}},{default:l(()=>[t(B,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(h,{size:"small",modelValue:e(w).uppercase,"onUpdate:modelValue":n[5]||(n[5]=m=>e(w).uppercase=m),label:e(M)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(B,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(h,{size:"small",modelValue:e(w).lowercase,"onUpdate:modelValue":n[6]||(n[6]=m=>e(w).lowercase=m),label:e(M)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(B,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(h,{size:"small",modelValue:e(w).number,"onUpdate:modelValue":n[7]||(n[7]=m=>e(w).number=m),label:e(M)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(B,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(h,{size:"small",modelValue:e(w).symbol,"onUpdate:modelValue":n[8]||(n[8]=m=>e(w).symbol=m),label:e(M)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1})]),_:1}),t(_,{style:{"margin-top":"15px"}},{default:l(()=>[t(B,{style:{"text-align":"center"}},{default:l(()=>[t(c,{modelValue:e(w).length,"onUpdate:modelValue":n[9]||(n[9]=m=>e(w).length=m),size:"small",style:{width:"120px"}},{prepend:l(()=>[S(C(e(M)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"]),t(F,{plain:"",size:"small",style:{position:"relative",top:"-5px","margin-left":"10px"},type:"success",onClick:N},{default:l(()=>[S(C(e(M)("passwordForm.generateForm.randomPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["label"]),t(p,{label:e(M)("password.label")},{default:l(()=>[t(R,{modelValue:e(a).label,"onUpdate:modelValue":n[10]||(n[10]=m=>e(a).label=m),"value-key":"id",data:q.labelTree,"check-strictly":"",multiple:"","default-expand-all":"",placeholder:e(M)("password.label.placeholder"),filterable:""},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),t(p,{label:e(M)("password.remark")},{default:l(()=>[t(c,{type:"textarea",placeholder:e(M)("passwordForm.generateForm.remark"),rows:4,modelValue:e(a).remark,"onUpdate:modelValue":n[11]||(n[11]=m=>e(a).remark=m)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","direction"])}}};const ml={class:"label-tree-node"},cl=["onClick","onBlur"],pl={class:"label-tree-node-menu"},fl={__name:"LabelTree",emits:["labelCheckChange","labelTreeChange"],setup(q,{expose:y,emit:J}){const{t:g}=re(),M=J,r=T(),b=T([]),u=T([]),V=T(!1),P=()=>{let s=r.value.getCheckedNodes();M("labelCheckChange",s)},a=(s,o)=>s?o.label.includes(s):!0,w=s=>{const o={id:Date.now(),label:g("labelTree.addLabel"),children:[]};s.children||(s.children=[]),s.children.push(o)},k=(s,o)=>{const n=s.parent,c=n.data.children||n.data,p=c.findIndex(F=>F.id===o.id);c.splice(p,1)},N=s=>!s.edit,U=()=>{u.value.push({id:Date.now(),label:g("labelTree.firstAddLabel"),children:[]})},x=()=>{V.value&&nt("labelTree.json",{labelTree:u.value})},Y=s=>{u.value=s};return Je(b,s=>{r.value.filter(s)}),Je(u,()=>{x(),M("labelTreeChange",u.value)},{deep:!0}),(()=>{rt("labelTree.json").then(s=>{s&&s.labelTree?u.value=s.labelTree:u.value=[],V.value=!0}).catch(s=>{et.error(s.code)})})(),y({setLabelTree:Y}),(s,o)=>{const n=fe,c=we,p=Ge,F=St,B=Vt,_=Ye;return v(),E(_,{class:"body-card"},{header:l(()=>[S(C(e(g)("labelTree.title")),1)]),default:l(()=>[t(n,{modelValue:e(b),"onUpdate:modelValue":o[0]||(o[0]=h=>ce(b)?b.value=h:null),clearable:"",placeholder:e(g)("labelTree.search.placeholder")},null,8,["modelValue","placeholder"]),t(B,{height:"35vh"},{default:l(()=>[t(F,{data:e(u),"show-checkbox":"",ref_key:"labelTreeRef",ref:r,draggable:"","node-key":"id",style:{"margin-top":"10px","background-color":"rgba(0,0,0,0)"},onCheck:P,"filter-node-method":a,"expand-on-click-node":!1,"allow-drag":N,"default-expand-all":""},{empty:l(()=>[t(c,{size:"small",type:"primary",plain:"",onClick:U},{default:l(()=>[S(C(e(g)("labelTree.firstAddLabel")),1)]),_:1})]),default:l(({node:h,data:D})=>[z("span",ml,[h.edit?$("",!0):(v(),j("span",{key:0,onClick:R=>h.edit=!0,onBlur:R=>h.edit=!1},C(D.label),41,cl)),h.edit?(v(),E(n,{key:1,style:{width:"60%"},ref:h.id+"_input",size:"small",onBlur:R=>h.edit=!1,modelValue:D.label,"onUpdate:modelValue":R=>D.label=R},null,8,["onBlur","modelValue","onUpdate:modelValue"])):$("",!0),z("span",pl,[t(p,{onClick:R=>w(D),type:"primary",underline:!1},{default:l(()=>[S(C(e(g)("labelTree.tree.add")),1)]),_:2},1032,["onClick"]),t(p,{onClick:R=>k(h,D),type:"danger",underline:!1,style:{"margin-left":"8px"}},{default:l(()=>[S(C(e(g)("labelTree.tree.remove")),1)]),_:2},1032,["onClick"])])])]),_:1},8,["data"])]),_:1})]),_:1})}}},wl=ot(fl,[["__scopeId","data-v-db1e8149"]]);const Ce=q=>(Nt("data-v-8e89a08e"),q=q(),Lt(),q),gl=Ce(()=>z("img",{alt:"",class:"back-img",src:Wt},null,-1)),_l={style:{display:"flex","justify-content":"space-between"}},bl={class:"hidden-xs-only"},yl=Ce(()=>z("br",null,null,-1)),vl={key:1},hl={style:{display:"flex","justify-content":"end"},class:"password-title-right"},kl=Ce(()=>z("div",{class:"password-strength",style:{"background-color":"#67C23A"}},null,-1)),Pl=Ce(()=>z("div",{class:"password-strength",style:{"background-color":"#E6A23C"}},null,-1)),xl=Ce(()=>z("div",{class:"password-strength",style:{"background-color":"#F56C6C"}},null,-1)),Cl={key:0},Sl={class:"password-text"},Vl={class:"pass-action-div"},Tl={__name:"IndexPage",setup(q){const{t:y,locale:J}=re(),g=T(),M=T(),r=T(),b=T(),u=T(),V=T(),P=W({}),a=T(""),w=T(""),k=T(""),N=T(!1),U=T(""),x=T([]),Y=T([]),A=T([]),s=T([]),o=async()=>{if(!a.value&&!A.value){Y.value=x.value;return}let i=[];for(let f=0;f<x.value.length;f++){let I=x.value[f].name||"",O=x.value[f].userName||"",ie=x.value[f].address||"",ue=x.value[f].remark||"",me=x.value[f].password||"",Ie=!a.value||I.includes(a.value)||O.includes(a.value)||ie.includes(a.value)||ue.includes(a.value)||me.includes(a.value),ve=!1;if(A.value.length>0)for(let he=0;he<A.value.length;he++){let ee=A.value[he];x.value[f].label&&x.value[f].label.includes(ee.id)&&(ve=!0)}else ve=!0;Ie&&ve&&i.push(x.value[f])}Y.value=i},n=()=>{g.value.showAddPassword()},c=i=>{g.value.showUpdatePassword(i)},p=i=>{x.value.unshift(i),oe(),o()},F=i=>{for(let f=0;f<x.value.length;f++)if(x.value[f].id===i.id){x.value[f]=i,oe(),o();break}},B=()=>{U.value=Pe(w.value,JSON.stringify(x.value)),N.value=!1,Y.value=[],x.value=[],w.value="",M.value.delLocalMainPassword()},_=()=>{M.value.verifyMainPassword()},h=i=>{let f=y("password.name")+": "+i.name+`\r
`;i.address&&(f+=y("password.address")+": "+i.address+`\r
`),i.userName&&(f+=y("password.userName")+": "+i.userName+`\r
`),i.password&&(f+=y("password.password")+": "+i.password+`\r
`),i.remark&&(f+=i.remark+`\r
`),f=f.substring(0,f.length-2),Le(f)},D=i=>{for(let f=0;f<x.value.length;f++)if(x.value[f].id===i.id){x.value.splice(f,1),oe(),o(),le.success(y("index.table.delete.success"));break}},R=i=>{w.value=i;let f=pe(i,U.value);x.value=JSON.parse(f),N.value=!0,o()},Z=(i,f)=>{w.value=i,k.value=f,oe(),le.success(y("index.mainPassword.changeSuccess"))},H=()=>{b.value.openSystemSetting()},m=()=>{r.value.updateMainPassword()},G=(i,f)=>{P[i]=f,i==="sortChange"&&Q(f)},Q=i=>{i==="insertTimeDesc"?ye("insertTime",-1):i==="insertTimeAsc"?ye("insertTime",1):i==="name"&&ye("name",1),oe(),o()},K=i=>{let f=0;return/[0-9]/.test(i)&&f++,/[a-z]/.test(i)&&f++,/[A-Z]/.test(i)&&f++,/[^0-9a-zA-Z_]/.test(i)&&f++,i.length<6&&f>2&&(f=2),ge()>2&&f>2&&(f=2),f>3?3:f},ge=i=>{let f=0;for(let I=0;I<x.value.length;I++)x.value[I].password===i&&f++;return f},se=i=>{let f=0;for(let I=0;I<x.value.length;I++){if(!x.value[I].password)continue;let O=K(x.value[I].password);i===O&&f++}return f},ye=(i,f)=>{x.value.sort((I,O)=>(I=I[i],O=O[i],I<O?f*-1:I>O?f*1:0))},oe=()=>{if(!N.value)return;U.value=Pe(w.value,JSON.stringify(x.value));let i=Pe(w.value,"password-x");ae.commit("setVerifyCode",i),nt("password.json",{verifyValue:i,mainPasswordType:k.value,passwordCiphertext:U.value})},_e=()=>{rt("password.json").then(i=>{if(i.verifyValue){let f=i.verifyValue;k.value=i.mainPasswordType||"common",ae.commit("setVerifyCode",f),ae.commit("setMainPasswordType",k.value),U.value=i.passwordCiphertext,M.value.verifyMainPassword(!0)}else N.value=!0,r.value.settingMainPassword()}).catch(i=>{console.error(i),et.error("error-1000："+i)})},de=i=>{A.value=i,o()},Re=i=>{s.value=i},Ue=i=>{if(!i)return"";let f=[];return Se(s.value,i,f),f},Se=(i,f,I)=>{for(let O=0;O<i.length;O++)f.includes(i[O].id)&&I.push(i[O].label),i[O].children&&i[O].children.length>0&&Se(i[O].children,f,I)},De=()=>{u.value.downloadExcelTemplate()},Ae=()=>{u.value.importExcel(s.value)},d=()=>{u.value.exportExcel(x.value,s.value)},it=(i,f)=>{if(i.length!==0){for(let I=i.length-1;I>=0;I--)x.value.unshift(i[I]);V.value.setLabelTree(f),oe(),o()}},ut=()=>{b.value.logout()};return tt(()=>{let i=st();for(let f in i)P[f]=i[f];P.language&&P.language!==J.value&&(J.value=P.language),_e()}),(i,f)=>{const I=Qe,O=fe,ie=we,ue=Tt,me=Mt,Ie=Ft,ve=Et,he=Rt,ee=Ut,Ve=Ge,mt=It,ct=Dt,pt=At,ft=Ye,je=$e,wt=wl,gt=Be,_t=ul,bt=dt,yt=dl,vt=sl,ht=Zt;return v(),j(X,null,[gl,t(gt,{id:"passwordBody"},{default:l(()=>[t(je,{xl:{span:16,offset:2},lg:{span:19},md:{span:19}},{default:l(()=>[t(ft,{class:"body-card"},{header:l(()=>[z("div",_l,[z("div",null,[z("div",bl,[e(x)?(v(),E(I,{key:0,class:"password-table-title"},{default:l(()=>[S(C(e(x).length)+" "+C(e(y)("index.title.passwordCount")),1)]),_:1})):$("",!0),yl,e(P).showPasswordStrength?(v(),j("div",vl,[t(I,{class:"password-table-strength"},{default:l(()=>[S(C(e(y)("index.title.strength"))+"（ ",1),t(I,{type:"success"},{default:l(()=>[S(C(e(y)("index.title.strength.strong")),1)]),_:1}),S(" : "+C(se(3))+" ",1),t(I,{style:{"margin-left":"5px"},type:"warning"},{default:l(()=>[S(C(e(y)("index.title.strength.medium")),1)]),_:1}),S(" : "+C(se(2))+" ",1),t(I,{style:{"margin-left":"5px"},type:"danger"},{default:l(()=>[S(C(e(y)("index.title.strength.weak")),1)]),_:1}),S(" : "+C(se(1))+"） ",1)]),_:1})])):$("",!0)])]),z("div",hl,[z("div",null,[t(O,{modelValue:e(a),"onUpdate:modelValue":f[0]||(f[0]=L=>ce(a)?a.value=L:null),style:{"max-width":"300px"},clearable:"",placeholder:e(y)("index.title.search"),"prefix-icon":e(jt),disabled:!e(w),onKeyup:lt(o,["enter"])},null,8,["modelValue","placeholder","prefix-icon","disabled","onKeyup"])]),z("div",null,[t(ie,{disabled:!e(w)||!e(N),type:"primary",plain:"",onClick:f[1]||(f[1]=L=>n())},{default:l(()=>[S(C(e(y)("index.title.addPassword")),1)]),_:1},8,["disabled"])]),z("div",null,[e(w)?$("",!0):(v(),E(ue,{key:0,content:e(y)("index.title.unlock"),effect:"dark",placement:"top"},{default:l(()=>[t(ie,{disabled:!e(U),icon:e(Ht),onClick:_},null,8,["disabled","icon"])]),_:1},8,["content"])),e(w)?(v(),E(ue,{key:1,content:e(y)("index.title.lock"),effect:"dark",placement:"top"},{default:l(()=>[t(ie,{icon:e(Ke),onClick:B},null,8,["icon"])]),_:1},8,["content"])):$("",!0)]),t(ve,null,{dropdown:l(()=>[t(Ie,null,{default:l(()=>[t(me,{onClick:H},{default:l(()=>[S(C(e(y)("systemSetting.title")),1)]),_:1}),t(me,{divided:"",onClick:Ae},{default:l(()=>[S(C(e(y)("index.title.importExport.import")),1)]),_:1}),t(me,{onClick:d},{default:l(()=>[S(C(e(y)("index.title.importExport.export")),1)]),_:1}),t(me,{onClick:De},{default:l(()=>[S(C(e(y)("index.title.importExport.download")),1)]),_:1}),t(me,{divided:"",onClick:ut},{default:l(()=>[S(C(e(y)("index.title.logout")),1)]),_:1})]),_:1})]),default:l(()=>[t(ie,{icon:e(Jt)},null,8,["icon"])]),_:1})])])]),default:l(()=>[t(pt,{height:"calc(100vh - 150px)",style:{"background-color":"rgba(0,0,0,0)"},"header-row-style":{"background-color":"rgba(0,0,0,0)"},"header-cell-style":{"background-color":"rgba(0,0,0,0)"},"row-style":{"background-color":"rgba(0,0,0,0)"},"cell-style":{"background-color":"rgba(0,0,0,0)"},data:e(Y)},{empty:l(()=>[t(he,{description:e(w)?e(y)("index.table.empty"):e(y)("index.table.lock")},Ee({default:l(()=>[t(ie,{onClick:_,plain:"",type:"primary"},{default:l(()=>[S(C(e(y)("index.title.unlock")),1)]),_:1})]),_:2},[e(w)?void 0:{name:"image",fn:l(()=>[t(e(Ke))]),key:"0"}]),1032,["description"])]),default:l(()=>[e(P).showPasswordStrength?(v(),E(ee,{key:0,width:"30px"},{default:l(L=>[K(L.row.password)===3?(v(),E(ue,{key:0},{content:l(()=>[S(C(e(y)("index.title.strength")+"："+e(y)("index.title.strength.strong")),1)]),default:l(()=>[kl]),_:1})):$("",!0),K(L.row.password)===2?(v(),E(ue,{key:1},{content:l(()=>[S(C(e(y)("index.title.strength")+"："+e(y)("index.title.strength.medium")),1)]),default:l(()=>[Pl]),_:1})):$("",!0),K(L.row.password)===1?(v(),E(ue,{key:2},{content:l(()=>[S(C(e(y)("index.title.strength")+"："+e(y)("index.title.strength.weak")),1)]),default:l(()=>[xl]),_:1})):$("",!0)]),_:1})):$("",!0),t(ee,{label:e(y)("password.name"),"min-width":"140px",prop:"name"},null,8,["label"]),t(ee,{label:e(y)("password.address"),"min-width":"200px",prop:"address"},{default:l(L=>[e(Gt)(L.row.address)?(v(),E(Ve,{key:0,href:L.row.address,target:"_blank"},{default:l(()=>[S(C(L.row.address),1)]),_:2},1032,["href"])):(v(),E(I,{key:1},{default:l(()=>[S(C(L.row.address),1)]),_:2},1024))]),_:1},8,["label"]),t(ee,{label:e(y)("password.userName"),"min-width":"120px",prop:"userName"},null,8,["label"]),t(ee,{label:e(y)("password.password"),"min-width":"150px"},{default:l(L=>[L.row.password?(v(),j("div",Cl,[z("span",Sl,[L.row.show?$("",!0):(v(),j(X,{key:0},[S("•••••••")],64)),L.row.show?(v(),j(X,{key:1},[S(C(L.row.password),1)],64)):$("",!0)]),z("div",Vl,[L.row.show?$("",!0):(v(),E(e(Ot),{key:0,onClick:ne=>L.row.show=!L.row.show},null,8,["onClick"])),L.row.show?(v(),E(e(Kt),{key:1,onClick:ne=>L.row.show=!L.row.show},null,8,["onClick"])):$("",!0),t(e(Xt),{onClick:ne=>e(Le)(L.row.password)},null,8,["onClick"])])])):$("",!0)]),_:1},8,["label"]),e(P).showLabel!==!1?(v(),E(ee,{key:1,label:e(y)("index.table.label"),"min-width":"130px"},{default:l(L=>[(v(!0),j(X,null,te(Ue(L.row.label),ne=>(v(),E(mt,{style:{margin:"3px"},key:ne},{default:l(()=>[S(C(ne),1)]),_:2},1024))),128))]),_:1},8,["label"])):$("",!0),t(ee,{label:e(y)("password.remark"),"min-width":"100px",prop:"remark"},null,8,["label"]),e(P).showAddTime?(v(),E(ee,{key:2,label:e(y)("password.insertTime"),"min-width":"130px",prop:"insertTime"},null,8,["label"])):$("",!0),e(P).showUpTime?(v(),E(ee,{key:3,label:e(y)("password.updateTime"),"min-width":"130px",prop:"updateTime"},null,8,["label"])):$("",!0),t(ee,{"min-width":"140px",label:e(y)("index.table.operation")},{default:l(L=>[t(Ve,{type:"success",underline:!1,onClick:ne=>h(L.row)},{default:l(()=>[S(C(e(y)("index.table.share")),1)]),_:2},1032,["onClick"]),t(Ve,{underline:!1,style:{"margin-left":"10px"},type:"primary",onClick:ne=>c(L.row)},{default:l(()=>[S(C(e(y)("index.table.edit")),1)]),_:2},1032,["onClick"]),t(ct,{title:e(y)("index.table.operation.affirmDelete"),"confirm-button-text":e(y)("index.table.operation.affirm"),"cancel-button-text":e(y)("index.table.operation.cancel"),onConfirm:ne=>D(L.row)},{reference:l(()=>[t(Ve,{style:{"margin-left":"10px"},underline:!1,type:"danger"},{default:l(()=>[S(C(e(y)("index.table.operation.delete")),1)]),_:1})]),_:2},1032,["title","confirm-button-text","cancel-button-text","onConfirm"])]),_:1},8,["label"])]),_:1},8,["header-row-style","header-cell-style","row-style","cell-style","data"])]),_:1})]),_:1}),t(je,{xl:{span:4},lg:{span:5},md:{span:5},class:"hidden-sm-and-down",style:{"padding-left":"15px"}},{default:l(()=>[t(wt,{ref_key:"labelTreeRef",ref:V,onLabelCheckChange:de,onLabelTreeChange:Re},null,512)]),_:1})]),_:1}),t(_t,{ref_key:"passwordFormRef",ref:g,labelTree:e(s),onAddPassword:p,onUpdatePassword:F},null,8,["labelTree"]),t(bt,{ref_key:"mainPasswordVerifyRef",ref:M,onVerifyPass:R},null,512),t(yt,{ref_key:"mainPasswordSettingRef",ref:r,onMainPasswordChange:Z},null,512),t(vt,{ref_key:"systemSettingRef",ref:b,onUpdateMainPassword:m,onSystemChangeChange:G},null,512),t(ht,{ref_key:"importExportRef",ref:u,labelTree:e(s),onImportComplete:it},null,8,["labelTree"])],64)}}},ql=ot(Tl,[["__scopeId","data-v-8e89a08e"]]);export{ql as default};
