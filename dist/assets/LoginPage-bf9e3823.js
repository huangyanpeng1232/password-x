import{q as k,r as x,l as M,c as O,b as R,g as L}from"./element-plus-2b0d0b3f.js";import{_ as N,l as A,s as U,g as z,e as P}from"./index-af5a2c29.js";import{s as _,g as v}from"./global-cb9f1136.js";import{u as T,b as $}from"./vue-router-32875d15.js";import{u as J}from"./vue-i18n-a2374498.js";import{p as Z}from"./@vueuse-eaf6c8a7.js";import{f as j,Z as I,o as G,c as H,a as i,U as t,O as n,u as f,S as c,T as Q,F as W,aw as X,ax as Y}from"./@vue-b395b1c5.js";import"./lodash-es-21c98b27.js";import"./@element-plus-acb39d11.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-99793a03.js";import"./ali-oss-85314bd4.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-900e7f0d.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-72671fae.js";import"./vuex-b47bdb47.js";import"./js-md5-80305e46.js";import"./crypto-js-0173151c.js";import"./@intlify-6e8dbf92.js";const ee=""+new URL("backImg-584761fc.svg",import.meta.url).href;const oe=u=>(X("data-v-91e6b5bf"),u=u(),Y(),u),se=oe(()=>i("img",{alt:"",class:"back-img",src:ee},null,-1)),te={class:"content"},re={class:"language-div"},ae={class:"content-input"},le={class:"title"},ne={class:"content-button"},ie={class:"oss-register-doc"},ce={__name:"LoginPage",setup(u){const{t:a,locale:d}=J(),S=Z(),K=T(),m=$(),b=j(),s=I({region:"",accessKeyId:"",accessKeySecret:"",bucket:""}),h=I({region:[{required:!0,message:a("login.form.region.verify"),trigger:"blur"}],accessKeyId:[{required:!0,message:a("login.form.accessKeyId.verify"),trigger:"blur"}],accessKeySecret:[{required:!0,message:a("login.form.accessKeySecret.verify"),trigger:"blur"}],bucket:[{required:!0,message:a("login.form.bucket.verify"),trigger:"blur"}]}),E=async()=>{window.open("https://gitee.com/password-x/password-x/wikis/%E9%98%BF%E9%87%8C%E4%BA%91%E8%B4%A6%E5%8F%B7%E6%93%8D%E4%BD%9C%E6%8C%87%E5%BC%95")},w=async o=>{await o.validate(e=>{e&&A(s).then(r=>{V(r)}).catch(r=>{C(r)})})},V=o=>{U.commit("setOss",o);let e=z(),r=P(e,JSON.stringify(s));localStorage.setItem("ossForm",r),k.success(a("login.form.successMessage")),K.push("/")},C=o=>{console.error(o);let e;o.code==="RequestError"?e=a("login.form.error.RequestError"):o.code==="InvalidAccessKeyId"?e=a("login.form.error.InvalidAccessKeyId"):o.code==="SignatureDoesNotMatch"?e=a("login.form.error.SignatureDoesNotMatch"):o.code==="AccessDenied"?e=a("login.form.error.AccessDenied"):e=o.code,k({type:"error",title:a("login.form.failMessage"),message:e})},y=o=>{d.value=o,_("language",o)},F=()=>{let o=v("language");o?y(o):navigator.language.toLowerCase()!=="zh-cn"&&(d.value="en-us",_("language","en-us"));let e=v("darkMode");if(e)S.value=e;else{let r=window.matchMedia("(prefers-color-scheme: dark)");r&&r.matches&&(S.value=!0,_("darkMode",!0))}},q=()=>{s.region=m.query.region||"",s.accessKeyId=m.query.accessKeyId||"",s.accessKeySecret=m.query.accessKeySecret||"",s.bucket=m.query.bucket||""};return F(),q(),(o,e)=>{const r=x,p=R,g=L,B=M,D=O;return G(),H(W,null,[se,i("div",te,[i("div",re,[t(r,{type:f(d)==="zh-cn"?"primary":"default",onClick:e[0]||(e[0]=l=>y("zh-cn")),underline:!1},{default:n(()=>[c("简体中文 ")]),_:1},8,["type"]),c(" / "),t(r,{type:f(d)==="en-us"?"primary":"default",onClick:e[1]||(e[1]=l=>y("en-us")),underline:!1},{default:n(()=>[c("English ")]),_:1},8,["type"])]),i("div",ae,[i("div",le,Q(f(a)("login.form.title")),1),t(B,{ref_key:"ruleFormRef",ref:b,rules:h,model:s},{default:n(()=>[t(g,{prop:"region"},{default:n(()=>[t(p,{modelValue:s.region,"onUpdate:modelValue":e[2]||(e[2]=l=>s.region=l),clearable:"",placeholder:"OSS region"},null,8,["modelValue"])]),_:1}),t(g,{prop:"accessKeyId"},{default:n(()=>[t(p,{modelValue:s.accessKeyId,"onUpdate:modelValue":e[3]||(e[3]=l=>s.accessKeyId=l),clearable:"",placeholder:"OSS accessKeyId"},null,8,["modelValue"])]),_:1}),t(g,{prop:"accessKeySecret"},{default:n(()=>[t(p,{modelValue:s.accessKeySecret,"onUpdate:modelValue":e[4]||(e[4]=l=>s.accessKeySecret=l),clearable:"",placeholder:"OSS accessKeySecret"},null,8,["modelValue"])]),_:1}),t(g,{prop:"bucket"},{default:n(()=>[t(p,{modelValue:s.bucket,"onUpdate:modelValue":e[5]||(e[5]=l=>s.bucket=l),clearable:"",placeholder:"OSS bucket"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"]),i("div",ne,[t(D,{type:"primary",style:{width:"100%"},onClick:e[6]||(e[6]=l=>w(f(b)))},{default:n(()=>[c("登录")]),_:1})]),i("div",ie,[t(r,{type:"primary",onClick:E},{default:n(()=>[c("阿里云OSS注册指引")]),_:1})])])])],64)}}},De=N(ce,[["__scopeId","data-v-91e6b5bf"]]);export{De as default};
