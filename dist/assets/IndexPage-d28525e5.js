import{E as Re}from"./exceljs-6b62d6db.js";import{F as He}from"./file-saver-38a5c18e.js";import{h as ve}from"./moment-fbc5633a.js";import{u as me}from"./vue-i18n-3a91c5c4.js";import{E as ne,a as Ne,b as we,c as ge,d as Se,e as Et,f as Ft,g as Ce,h as qe,i as ze,j as $e,k as Ze,l as Ut,m as Ve,n as Dt,o as Qe,p as Te,q as et,r as Ge,s as Rt,t as At,u as tt,v as Lt,w as It,x as Nt,y as zt,z as $t,A as Gt,B as Bt,C as Yt,D as Wt,F as jt,G as Ot}from"./element-plus-96c47ee5.js";import{r as T,o as g,c as j,X as le,b as lt,u as e,O as z,I as E,ad as Me,J as t,a as $,S as l,P as k,Q as v,A as ce,R as K,ac as te,ak as at,w as Je,_ as st,ar as Ht,as as Jt}from"./@vue-2150b1fb.js";import{m as Kt}from"./js-md5-11f5a111.js";import{h as Ee}from"./@vueuse-1138cc68.js";import{d as pe,s as ae,g as he,a as Ke,l as Le,b as Ae,u as Xt,c as fe,e as xe,f as Ie,r as qt,_ as ot,p as nt,h as rt,i as be,j as Zt}from"./index-0dac3127.js";import{u as Qt}from"./vue-router-67d91bd0.js";import{_ as el}from"./backImg-a3b16eec.js";import{m as tl,u as ll,n as Xe,o as al,v as sl,h as ol,r as nl}from"./@element-plus-82a6dcc3.js";import"./ali-oss-21f5c855.js";import"./@intlify-9ddbe450.js";import"./lodash-es-f5bdeb48.js";import"./async-validator-dee29e8b.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./escape-html-cf2a8097.js";import"./normalize-wheel-es-ed76fb12.js";import"./crypto-js-d55471a7.js";import"./vuex-406a410d.js";import"./cos-js-sdk-v5-31c61e27.js";const rl={__name:"ImportExport",emits:["importComplete"],setup(Z,{expose:b,emit:J}){const{t:P}=me(),M=J,n=T(),_=T(),f=T(0),S=m=>{n.value.click(),_.value=m},V=async()=>{if(n.value.files===0)return;f.value=Date.now();const m=new Re.Workbook;m.xlsx.load(n.value.files[0]).then(()=>{m.eachSheet(function(d){if(d.rowCount<2){ne.error(P("importExport.data.empty")),n.value.value="";return}let s=[];for(let r=2;r<=d.rowCount;r++){let a=d.getRow(r),x=o(a.getCell(1).value),U=o(a.getCell(2).value),p=o(a.getCell(3).value),C=o(a.getCell(4).value),A=o(a.getCell(5).value),D=o(a.getCell(6).value),O=o(a.getCell(7).value),W=o(a.getCell(8).value);x&&s.push({id:f.value++,name:x,address:U,userName:p,password:C,remark:D,label:u(A),insertTime:O,updateTime:W})}M("importComplete",s,_.value),n.value.value=""})}).catch(d=>{ne.error(d),n.value.value=""})},o=m=>m?typeof m=="object"?m instanceof Date?ve(m).format("YYYY-MM-DD HH:mm:ss"):m.text:m.toString():"",u=m=>{if(!m)return"";let d=[],s=m.split("、");for(let r=0;r<s.length;r++){let a=h(_.value,s[r],"");if(a)d.push(a);else{let x=[];R(_.value,s[r].split(">"),0,x);for(let U=0;U<x.length;U++)d.push(x[U])}}return Array.from(new Set(d))},h=(m,d,s)=>{for(let r=0;r<m.length;r++){let a=s?s+">"+m[r].label:m[r].label;if(d===a)return m[r].id;if(m[r].children&&m[r].children.length>0)return h(m[r].children,d,a)}},R=(m,d,s,r)=>{if(!d[s])return;for(let x=0;x<m.length;x++)if(m[x].label===d[s])return d[s+1]||r.push(m[x].id),R(m[x].children,d,s+1,r);let a={id:f.value++,label:d[s],children:[]};m.push(a),d[s+1]||r.push(a.id),R(a.children,d,s+1,r)},N=async(m,d)=>{_.value=d;const s=new Re.Workbook,r=s.addWorksheet("sheet1");r.getCell("A1").value=P("password.name"),r.getCell("B1").value=P("password.address"),r.getCell("C1").value=P("password.userName"),r.getCell("D1").value=P("password.password"),r.getCell("E1").value=P("password.label"),r.getCell("F1").value=P("password.remark"),r.getCell("G1").value=P("password.insertTime"),r.getCell("H1").value=P("password.updateTime");for(let a=0;a<m.length;a++){let x=m[a].insertTime;x||(x=ve().format("YYYY-MM-DD HH:mm:ss")),r.getCell("A"+(a+2)).value=m[a].name,r.getCell("B"+(a+2)).value=m[a].address,r.getCell("C"+(a+2)).value=m[a].userName,r.getCell("D"+(a+2)).value=m[a].password,r.getCell("E"+(a+2)).value=Y(m[a].label),r.getCell("F"+(a+2)).value=m[a].remark,r.getCell("G"+(a+2)).value=x,r.getCell("H"+(a+2)).value=m[a].updateTime}s.xlsx.writeBuffer().then(a=>{let x=new Blob([a],{type:"application/octet-stream"});He.saveAs(x,P("importExport.exportName")+"_"+ve().format("YYYY-MM-DD HH:mm:ss")+".xlsx")})},Y=m=>{if(!m)return"";let d=[];return G(_.value,m,d,""),d.join("、")},G=(m,d,s,r)=>{for(let a=0;a<m.length;a++){let x=r?r+">"+m[a].label:m[a].label;d.includes(m[a].id)&&s.push(x),m[a].children&&m[a].children.length>0&&G(m[a].children,d,s,x)}};return b({importExcel:S,exportExcel:N,downloadExcelTemplate:()=>{const m=new Re.Workbook,d=m.addWorksheet("sheet1");d.getCell("A1").value=P("password.name"),d.getCell("B1").value=P("password.address"),d.getCell("C1").value=P("password.userName"),d.getCell("D1").value=P("password.password"),d.getCell("E1").value=P("password.label"),d.getCell("F1").value=P("password.remark"),d.getCell("G1").value=P("password.insertTime"),d.getCell("H1").value=P("password.updateTime"),m.xlsx.writeBuffer().then(s=>{let r=new Blob([s],{type:"application/octet-stream"});He.saveAs(r,P("importExport.importTemplateName")+".xlsx")})}}),(m,d)=>(g(),j("input",{type:"file",onChange:V,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ref_key:"fileUploadInput",ref:n,style:{display:"none"}},null,544))}},dl=["width","height"],Be={__name:"GesturePassword",props:{size:{type:Number,default:300},count:{type:Number,default:3},showGesture:{type:Boolean,default:!0}},emits:["complete"],setup(Z,{expose:b,emit:J}){const P=Ee(),M=J,n=T();let _=Z;const f=le({padding:_.size*.18,background:P.value?"rgb(20,20,20)":"#fff",failColor:"#F56C6C",passColor:"#67C23A",point:{color:"#409EFF",size:_.size*.023,selected:{range:_.size*.07,color:"#409EFF",size:_.size*.023,madding:{color:"#409EFF",size:_.size*.07,lineWidth:1}}},line:{color:"#409EFF",width:2}}),S=T({}),V=T([]),o=T(!1),u=T("");let h=null;const R=()=>{f.background=P.value?"rgb(20,20,20)":"#fff",h=n.value.getContext("2d"),N()},N=()=>{h.fillStyle=f.background,h.fillRect(0,0,_.size,_.size),S.value=[];let p=(_.size-f.padding*2)/(_.count-1),C=1;for(let A=0;A<_.count;A++)for(let D=0;D<_.count;D++){let O=f.padding+D*p,W=f.padding+A*p,F=p/2,X={id:C,x:O,y:W,startX:O-F,endX:O+F,startY:W-F,endY:W+F,h:p,w:p};Y(X),S.value[C]=X,C++}},Y=p=>{let C=a(p);C&&_.showGesture&&(h.beginPath(),u.value==="fail"?h.strokeStyle=f.failColor:u.value==="pass"?h.strokeStyle=f.passColor:h.strokeStyle=f.point.selected.madding.color,h.lineWidth=f.point.selected.madding.lineWidth,h.arc(p.x,p.y,f.point.selected.madding.size,0,Math.PI*2),h.stroke()),h.beginPath(),C&&_.showGesture?(u.value==="fail"?h.fillStyle=f.failColor:u.value==="pass"?h.fillStyle=f.passColor:h.fillStyle=f.point.selected.madding.color,h.arc(p.x,p.y,f.point.selected.size,0,Math.PI*2)):(h.fillStyle=f.point.color,h.arc(p.x,p.y,f.point.size,0,Math.PI*2)),h.fill()},G=()=>{o.value=!0},y=()=>{if(!o.value)return;o.value=!1;let p=d();if(p){let C=Kt(p);M("complete",C)}N(),r()},m=p=>{u.value=p,N(),r(),p?setTimeout(()=>{u.value="",V.value=[],N()},500):(V.value=[],N())},d=()=>{let p="";for(let C=0;C<V.value.length;C++)p+=V.value[C].id+",";return p&&(p=p.substring(0,p.length-1)),p},s=p=>{let C=p.offsetX,A=p.offsetY;if(N(),r(C,A),!o.value)return;let D=x(C,A);!D||a(D)||(V.value.push(D),N(),r(C,A))},r=(p,C)=>{if(!_.showGesture)return;let A=x(p,C);if(A&&u.value===""&&(h.beginPath(),h.strokeStyle=f.point.selected.madding.color,h.lineWidth=f.point.selected.madding.lineWidth,h.arc(A.x,A.y,f.point.selected.madding.size,0,Math.PI*2),h.stroke()),V.value.length!==0){h.beginPath(),u.value==="fail"?h.strokeStyle=f.failColor:u.value==="pass"?h.strokeStyle=f.passColor:h.strokeStyle=f.line.color,h.lineWidth=f.line.width,h.lineCap="round",h.moveTo(V.value[0].x,V.value[0].y);for(let D=1;D<V.value.length;D++)h.lineTo(V.value[D].x,V.value[D].y);o.value&&p&&C&&u.value===""&&h.lineTo(p,C),h.stroke()}},a=p=>{for(let C=0;C<V.value.length;C++)if(p.id===V.value[C].id)return!0;return!1},x=(p,C)=>{for(let A in S.value){let D=S.value[A];if(p>D.startX+f.point.selected.range&&p<D.endX-f.point.selected.range&&C>D.startY+f.point.selected.range&&C<D.endY-f.point.selected.range)return D}},U=p=>{let C=p.touches[0].clientX-n.value.offsetLeft,A=p.touches[0].clientY-n.value.offsetTop;s({offsetX:C,offsetY:A})};return lt(()=>{R()}),b({setVerifyStatus:m}),(p,C)=>e(_).size?(g(),j("canvas",{key:0,width:e(_).size,height:e(_).size,ref_key:"canvasRef",ref:n,onMousedown:G,onMouseup:y,onMousemove:C[0]||(C[0]=A=>s(A)),onMouseleave:y,onTouchstart:G,onTouchend:y,onTouchmove:U},null,40,dl)):z("",!0)}},il={style:{"text-align":"center"}},ul={class:"dialog-footer"},ml={__name:"DeleteAccount",emits:["deleteAccount"],setup(Z,{expose:b,emit:J}){const{t:P}=me(),M=J,n=T(),_=le({deleteAccount:!1}),f=T(""),S=T(""),V=()=>{let R=pe(S.value,ae.state.verifyCode);if(R&&R==="password-x"){f.value==="gesture"&&n.value.setVerifyStatus("pass");let N=localStorage.getItem("databaseForm"),Y=pe(he(),N);if(JSON.parse(Y).keyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){ne.error("演示账号不能注销");return}Ke("password.json"),Ke("labelTree.json"),localStorage.removeItem("systemConfig"),ne.success(P("systemSetting.deleteAccount.success")),M("deleteAccount")}else f.value==="common"?ne.error(P("systemSetting.deleteAccount.mainPasswordError")):n.value.setVerifyStatus("fail")},o=()=>{f.value=ae.state.mainPasswordType,_.deleteAccount=!0},u=R=>{S.value=R,V()},h=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){h.value=document.documentElement.clientWidth<728}),b({showDeleteAccount:o}),(R,N)=>{const Y=Ne,G=Be,y=we,m=ge,d=Se;return g(),E(d,{fullscreen:e(h),modelValue:e(_).deleteAccount,"onUpdate:modelValue":N[1]||(N[1]=s=>e(_).deleteAccount=s),title:e(P)("systemSetting.deleteAccount"),width:"400px"},Me({default:t(()=>[l(Y,{type:"error",closable:!1},{default:t(()=>[k(v(e(P)("systemSetting.deleteAccount.text")),1)]),_:1}),$("div",il,[e(f)==="gesture"?(g(),E(G,{key:0,ref_key:"gesturePasswordRef",ref:n,onComplete:u},null,512)):z("",!0),e(f)==="common"?(g(),E(y,{key:1,modelValue:e(S),"onUpdate:modelValue":N[0]||(N[0]=s=>ce(S)?S.value=s:null),style:{"margin-top":"20px"}},null,8,["modelValue"])):z("",!0)])]),_:2},[e(f)==="common"?{name:"footer",fn:t(()=>[$("span",ul,[l(m,{type:"danger",onClick:V},{default:t(()=>[k(v(e(P)("systemSetting.deleteAccount.affirm")),1)]),_:1})])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},cl={style:{"text-align":"center"}},pl={class:"dialog-footer"},fl={__name:"SystemSetting",emits:["updateMainPassword","deleteAccount","systemChangeChange"],setup(Z,{expose:b,emit:J}){const P=Qt(),M=Ee(),{t:n,locale:_}=me(),f=J,S=T(),V=le({setting:!1}),o=le(Le()),u=le({languages:[],sorts:[],topics:[],cacheMains:[],showAddTimes:[],showUpTimes:[],showLabels:[],enableLabels:[],verifyShowGestures:[],cacheDatabaseForms:[],autoGeneratePasswords:[],showPasswordStrengths:[]}),h=()=>{u.languages=[{key:"zh-cn",label:"简体中文"},{key:"en-us",label:"English"}],u.sorts=[{key:"insertTimeDesc",label:n("systemSetting.sort.insertTimeDesc")},{key:"insertTimeAsc",label:n("systemSetting.sort.insertTimeAsc")},{key:"updateTimeDesc",label:n("systemSetting.sort.updateTimeDesc")},{key:"updateTimeAsc",label:n("systemSetting.sort.updateTimeAsc")},{key:"nameAsc",label:n("systemSetting.sort.nameAsc")},{key:"nameDesc",label:n("systemSetting.sort.nameDesc")},{key:"strengthDesc",label:n("systemSetting.sort.strengthAsc")},{key:"strengthAsc",label:n("systemSetting.sort.strengthDesc")}],u.topics=[{key:!1,label:n("systemSetting.topic.light")},{key:!0,label:n("systemSetting.topic.dark")}],u.cacheMains=[{key:!0,label:n("systemSetting.cacheMainPassword.enable")},{key:!1,label:n("systemSetting.cacheMainPassword.disabled")}],u.showAddTimes=[{key:!0,label:n("systemSetting.showAddTime.enable")},{key:!1,label:n("systemSetting.showAddTime.disabled")}],u.showUpTimes=[{key:!0,label:n("systemSetting.showUpTime.enable")},{key:!1,label:n("systemSetting.showUpTime.disabled")}],u.showLabels=[{key:!0,label:n("systemSetting.showLabel.enable")},{key:!1,label:n("systemSetting.showLabel.disabled")}],u.enableLabels=[{key:!0,label:n("systemSetting.enableLabel.enable")},{key:!1,label:n("systemSetting.enableLabel.disabled")}],u.verifyShowGestures=[{key:!0,label:n("mainPasswordSetting.verify.showGesture.enable")},{key:!1,label:n("mainPasswordSetting.verify.showGesture.disabled")}],u.cacheDatabaseForms=[{key:!0,label:n("systemSetting.cacheDatabaseForm.enable")},{key:!1,label:n("systemSetting.cacheDatabaseForm.disabled")}],u.autoGeneratePasswords=[{key:!0,label:n("passwordForm.autoGeneratePassword.enable")},{key:!1,label:n("passwordForm.autoGeneratePassword.disabled")}],u.showPasswordStrengths=[{key:!0,label:n("systemSetting.showPasswordStrength.enable")},{key:!1,label:n("systemSetting.showPasswordStrength.disabled")}]};let R=null;const N=()=>{h();let r=Le();for(let a in r)o[a]=r[a];R=JSON.stringify(o),V.setting=!0},Y=()=>{V.setting=!1},G=()=>{let r=o.defaultPasswordRule;if(!r.number&&!r.symbol&&!r.lowercase&&!r.uppercase){ne.error(n("systemSetting.passwordRuleVerify"));return}Xt(o);let a=JSON.parse(R);o.cacheMainPassword!==a.cacheMainPassword&&o.cacheMainPassword===!1&&(localStorage.removeItem("mainPasswordCiphertext"),console.log("删除主密码缓存")),o.cacheDatabaseForm!==a.cacheDatabaseForm&&o.cacheDatabaseForm===!1&&(localStorage.removeItem("databaseForm"),console.log("删除自动登录信息")),o.language!==_.value&&(_.value=o.language,console.log("系统语言设置为：",o.language)),M.value!==o.darkMode&&(M.value=o.darkMode,console.log("暗黑模式设置为：",o.darkMode)),o.sortRule!==a.sortRule&&(f("systemChangeChange","sortChange",o.sortRule),console.log("排序规则设置为：",o.sortRule)),o.showPasswordStrength!==a.showPasswordStrength&&(f("systemChangeChange","showPasswordStrength",o.showPasswordStrength),console.log("是否显示密码强度设置为：",o.showPasswordStrength)),V.setting=!1},y=()=>{localStorage.removeItem("databaseForm"),localStorage.removeItem("mainPasswordCiphertext"),ae.commit("delDatabase"),ae.commit("delDatabaseForm"),ae.commit("delVerifyCode"),P.push("/login")},m=()=>{V.setting=!1,f("updateMainPassword")},d=()=>{V.setting=!1,S.value.showDeleteAccount()},s=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){s.value=document.documentElement.clientWidth<728}),b({logout:y,openSystemSetting:N,showUpdateMainPassword:m,settingForm:o}),(r,a)=>{const x=Et,U=Ft,p=Ce,C=qe,A=ze,D=we,O=$e,W=Ze,F=ge,X=Ut,Fe=Ve,Ue=Dt,De=Qe,_e=Te,ye=Ne,re=Se,de=ml;return g(),j(K,null,[l(re,{fullscreen:e(s),modelValue:e(V).setting,"onUpdate:modelValue":a[17]||(a[17]=c=>e(V).setting=c),title:e(n)("systemSetting.title"),width:"600px"},{footer:t(()=>[$("span",pl,[l(F,{plain:"",onClick:Y},{default:t(()=>[k(v(e(n)("systemSetting.close")),1)]),_:1}),l(F,{type:"primary",plain:"",onClick:G},{default:t(()=>[k(v(e(n)("systemSetting.save")),1)]),_:1})])]),default:t(()=>[l(_e,{"label-width":"150px"},{default:t(()=>[l(De,{"tab-position":"left",style:{height:"350px"}},{default:t(()=>[l(W,{label:e(n)("systemSetting.type.general")},{default:t(()=>[l(p,{label:e(n)("systemSetting.language")},{default:t(()=>[l(U,{modelValue:e(o).language,"onUpdate:modelValue":a[0]||(a[0]=c=>e(o).language=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).languages,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(p,{label:e(n)("systemSetting.sort")},{default:t(()=>[l(U,{modelValue:e(o).sortRule,"onUpdate:modelValue":a[1]||(a[1]=c=>e(o).sortRule=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).sorts,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(p,{label:e(n)("passwordForm.autoGeneratePassword")},{default:t(()=>[l(U,{modelValue:e(o).autoGeneratePassword,"onUpdate:modelValue":a[2]||(a[2]=c=>e(o).autoGeneratePassword=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).autoGeneratePasswords,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(p,{label:e(n)("systemSetting.defaultPasswordRule")},{default:t(()=>[l(O,{style:{"margin-top":"15px"}},{default:t(()=>[l(A,{span:12},{default:t(()=>[l(C,{size:"small",modelValue:e(o).defaultPasswordRule.uppercase,"onUpdate:modelValue":a[3]||(a[3]=c=>e(o).defaultPasswordRule.uppercase=c),label:e(n)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),l(A,{span:12},{default:t(()=>[l(C,{size:"small",modelValue:e(o).defaultPasswordRule.lowercase,"onUpdate:modelValue":a[4]||(a[4]=c=>e(o).defaultPasswordRule.lowercase=c),label:e(n)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),l(A,{span:12},{default:t(()=>[l(C,{size:"small",modelValue:e(o).defaultPasswordRule.number,"onUpdate:modelValue":a[5]||(a[5]=c=>e(o).defaultPasswordRule.number=c),label:e(n)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),l(A,{span:12},{default:t(()=>[l(C,{size:"small",modelValue:e(o).defaultPasswordRule.symbol,"onUpdate:modelValue":a[6]||(a[6]=c=>e(o).defaultPasswordRule.symbol=c),label:e(n)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1}),l(A,{span:16},{default:t(()=>[$("div",null,[l(D,{size:"small",style:{position:"relative",top:"3px"},modelValue:e(o).defaultPasswordRule.length,"onUpdate:modelValue":a[7]||(a[7]=c=>e(o).defaultPasswordRule.length=c)},{prepend:t(()=>[k(v(e(n)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["label"])]),_:1},8,["label"]),l(W,{label:e(n)("systemSetting.type.personalization")},{default:t(()=>[l(p,{label:e(n)("systemSetting.topic")},{default:t(()=>[l(U,{modelValue:e(o).darkMode,"onUpdate:modelValue":a[8]||(a[8]=c=>e(o).darkMode=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).topics,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(p,{label:e(n)("systemSetting.showPasswordStrength")},{default:t(()=>[l(U,{modelValue:e(o).showPasswordStrength,"onUpdate:modelValue":a[9]||(a[9]=c=>e(o).showPasswordStrength=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).showPasswordStrengths,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(p,{label:e(n)("systemSetting.showAddTime")},{default:t(()=>[l(U,{modelValue:e(o).showAddTime,"onUpdate:modelValue":a[10]||(a[10]=c=>e(o).showAddTime=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).showAddTimes,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(p,{label:e(n)("systemSetting.showUpTime")},{default:t(()=>[l(U,{modelValue:e(o).showUpTime,"onUpdate:modelValue":a[11]||(a[11]=c=>e(o).showUpTime=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).showUpTimes,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(p,{label:e(n)("systemSetting.enableLabel")},{default:t(()=>[l(U,{modelValue:e(o).enableLabel,"onUpdate:modelValue":a[12]||(a[12]=c=>e(o).enableLabel=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).enableLabels,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(p,{label:e(n)("systemSetting.showLabel")},{default:t(()=>[l(U,{disabled:!e(o).enableLabel,modelValue:e(o).showLabel,"onUpdate:modelValue":a[13]||(a[13]=c=>e(o).showLabel=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).showLabels,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["disabled","modelValue"])]),_:1},8,["label"])]),_:1},8,["label"]),l(W,{label:e(n)("systemSetting.type.security")},{default:t(()=>[l(p,{label:e(n)("systemSetting.cacheMainPassword")},{default:t(()=>[l(U,{modelValue:e(o).cacheMainPassword,"onUpdate:modelValue":a[14]||(a[14]=c=>e(o).cacheMainPassword=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).cacheMains,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(p,{label:e(n)("systemSetting.cacheDatabaseForm")},{default:t(()=>[l(U,{modelValue:e(o).cacheDatabaseForm,"onUpdate:modelValue":a[15]||(a[15]=c=>e(o).cacheDatabaseForm=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).cacheDatabaseForms,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(p,{label:e(n)("mainPasswordSetting.verify.showGesture")},{default:t(()=>[l(U,{modelValue:e(o).verifyShowGesture,"onUpdate:modelValue":a[16]||(a[16]=c=>e(o).verifyShowGesture=c)},{default:t(()=>[(g(!0),j(K,null,te(e(u).verifyShowGestures,c=>(g(),E(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["label"]),l(W,{label:e(n)("systemSetting.type.other")},{default:t(()=>[$("div",cl,[l(F,{plain:"",onClick:m},{default:t(()=>[k(v(e(n)("systemSetting.updateMainPassword")),1)]),_:1}),l(F,{plain:"",type:"danger",onClick:d},{default:t(()=>[k(v(e(n)("systemSetting.deleteAccount")),1)]),_:1}),l(F,{type:"warning",plain:"",onClick:y},{default:t(()=>[k(v(e(n)("systemSetting.logout")),1)]),_:1})])]),_:1},8,["label"]),l(W,{label:e(n)("systemSetting.about"),style:{"text-align":"center"}},{default:t(()=>[l(Ue,{column:1,style:{margin:"15px"}},{default:t(()=>[l(X,null,{label:t(()=>[k(v(e(n)("systemSetting.about.version"))+": ",1)]),default:t(()=>[k(" "+v(e(Ae)("VITE_VERSION")),1)]),_:1}),l(X,null,{label:t(()=>[k(v(e(n)("systemSetting.about.openSourceUrl"))+": ",1)]),default:t(()=>[l(Fe,{target:"_blank",href:e(Ae)("VITE_OPEN_SOURCE_URL")},{default:t(()=>[k(v(e(Ae)("VITE_OPEN_SOURCE_URL")),1)]),_:1},8,["href"])]),_:1}),l(X,null,{default:t(()=>[k(v(e(n)("systemSetting.about.submit")),1)]),_:1})]),_:1})]),_:1},8,["label"])]),_:1})]),_:1}),l(ye,{style:{"margin-top":"20px"},type:"warning"},{default:t(()=>[k(v(e(n)("systemSetting.takeEffect")),1)]),_:1})]),_:1},8,["fullscreen","modelValue","title"]),l(de,{ref_key:"deleteAccountRef",ref:S,onDeleteAccount:y},null,512)],64)}}},wl={style:{"text-align":"center"}},gl={class:"dialog-footer"},dt={__name:"MainPasswordVerify",emits:["verifyPass"],setup(Z,{expose:b,emit:J}){const{t:P}=me(),M=J,n=T(),_=T(""),f=T(""),S=le({verifyMainPassword:!1}),V=y=>{_.value=y,o()},o=()=>{let y=pe(_.value,ae.state.verifyCode);y&&y==="password-x"?(f.value==="gesture"&&n.value.setVerifyStatus("pass"),M("verifyPass",_.value),h(_.value),_.value="",S.verifyMainPassword=!1):f.value==="common"?ne.error(P("mainPasswordVerify.form.verify")):n.value.setVerifyStatus("fail")},u=()=>{localStorage.removeItem("mainPasswordCiphertext")},h=y=>{if(fe("cacheMainPassword")===!1)return;let d=he(),s=xe(d,y);localStorage.setItem("mainPasswordCiphertext",s)},R=()=>{if(fe("cacheMainPassword")===!1)return null;let m=localStorage.getItem("mainPasswordCiphertext");if(!m)return null;let d=he(),s=pe(d,m);return s||null},N=()=>fe("verifyShowGesture")!==!1,Y=(y=!0)=>{if(f.value=ae.state.mainPasswordType,!y){S.verifyMainPassword=!0;return}let m=R();if(!m){S.verifyMainPassword=!0;return}let d=pe(m,ae.state.verifyCode);d&&d==="password-x"?M("verifyPass",m):S.verifyMainPassword=!0},G=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){G.value=document.documentElement.clientWidth<728}),b({verifyMainPassword:Y,delLocalMainPassword:u}),(y,m)=>{const d=Be,s=we,r=Ce,a=Te,x=ge,U=Se;return g(),E(U,{fullscreen:e(G),modelValue:e(S).verifyMainPassword,"onUpdate:modelValue":m[1]||(m[1]=p=>e(S).verifyMainPassword=p),title:e(P)("mainPasswordVerify.form.title"),width:"400px"},Me({default:t(()=>[$("div",wl,[e(f)==="gesture"&&e(S).verifyMainPassword?(g(),E(d,{key:0,"show-gesture":N(),ref_key:"gesturePasswordRef",ref:n,onComplete:V},null,8,["show-gesture"])):z("",!0),e(f)==="common"&&e(S).verifyMainPassword?(g(),E(a,{key:1,style:{padding:"10px"}},{default:t(()=>[l(r,null,{default:t(()=>[l(s,{modelValue:e(_),"onUpdate:modelValue":m[0]||(m[0]=p=>ce(_)?_.value=p:null),placeholder:e(P)("mainPasswordVerify.form.mainPassword"),type:"password",onKeyup:at(o,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1})]),_:1})):z("",!0)])]),_:2},[e(f)==="common"?{name:"footer",fn:t(()=>[$("span",gl,[l(x,{type:"primary",disabled:!e(_),onClick:o},{default:t(()=>[k(v(e(P)("mainPasswordVerify.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},bl={class:"dialog-footer"},_l={__name:"MainPasswordSetting",emits:["mainPasswordChange"],setup(Z,{expose:b,emit:J}){const{t:P}=me(),M=J,n=T(),_=T(),f=T("gesture"),S=T(""),V=T(""),o=le({mainPassword:!1}),u=T(""),h=m=>{u.value==="setting"?(S.value=m,u.value="affirm",_.value.setVerifyStatus("")):u.value==="affirm"&&(V.value=m,R())},R=()=>{if(S.value!==V.value){ne.error(P("mainPasswordSetting.form.passwordsDiff"));return}let m=localStorage.getItem("databaseForm"),d=pe(he(),m);if(JSON.parse(d).accessKeyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){ne.error("演示账号不能修改主密码");return}f.value==="gesture"?ae.commit("setMainPasswordType","gesture"):ae.commit("setMainPasswordType","common"),M("mainPasswordChange",S.value,f.value);let r=fe("cacheMainPassword");if(r||r==null){let a=he(),x=xe(a,S.value);localStorage.setItem("mainPasswordCiphertext",x)}S.value="",V.value="",o.mainPassword=!1},N=()=>{u.value="setting",o.mainPassword=!0},Y=()=>{n.value.verifyMainPassword(!1)},G=()=>{f.value==="gesture"&&(u.value="setting"),S.value="",V.value=""},y=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){y.value=document.documentElement.clientWidth<728}),b({settingMainPassword:N,updateMainPassword:Y}),(m,d)=>{const s=Ne,r=et,a=Be,x=Ve,U=Ze,p=we,C=Ce,A=Te,D=Qe,O=ge,W=Se,F=dt;return g(),j(K,null,[l(W,{fullscreen:e(y),modelValue:e(o).mainPassword,"onUpdate:modelValue":d[4]||(d[4]=X=>e(o).mainPassword=X),title:e(P)("mainPasswordSetting.form.setMainPassword"),width:"470px"},Me({default:t(()=>[l(s,{type:"error",style:{position:"relative",top:"-10px"},closable:!1},{default:t(()=>[k(v(e(P)("mainPasswordSetting.forget.message")),1)]),_:1}),l(D,{modelValue:e(f),"onUpdate:modelValue":d[3]||(d[3]=X=>ce(f)?f.value=X:null),style:{"margin-top":"10px"},type:"card",onTabChange:G},{default:t(()=>[l(U,{label:e(P)("mainPasswordSetting.passwordType.gesture"),name:"gesture",style:{"text-align":"center"}},{default:t(()=>[$("div",null,[e(u)==="setting"?(g(),E(r,{key:0},{default:t(()=>[k(v(e(P)("mainPasswordSetting.gesture.first")),1)]),_:1})):z("",!0),e(u)==="affirm"?(g(),E(r,{key:1},{default:t(()=>[k(v(e(P)("mainPasswordSetting.gesture.affirm")),1)]),_:1})):z("",!0)]),e(o).mainPassword&&e(f)==="gesture"?(g(),E(a,{key:0,ref_key:"gesturePasswordRef",ref:_,onComplete:h},null,512)):z("",!0),$("div",null,[l(x,{underline:!1,style:{position:"relative",top:"-2px"},type:"primary",onClick:d[0]||(d[0]=X=>u.value="setting")},{default:t(()=>[k(v(e(P)("mainPasswordSetting.gesture.reset")),1)]),_:1})])]),_:1},8,["label"]),l(U,{label:e(P)("mainPasswordSetting.passwordType.common"),name:"common",style:{"text-align":"center"}},{default:t(()=>[l(A,{inline:!0,"label-width":"100px",style:{"margin-top":"20px"}},{default:t(()=>[l(C,{label:e(P)("mainPasswordSetting.form.newMainPassword")},{default:t(()=>[l(p,{type:"password",modelValue:e(S),"onUpdate:modelValue":d[1]||(d[1]=X=>ce(S)?S.value=X:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"]),l(C,{label:e(P)("mainPasswordSetting.form.newMainPasswordAffirm")},{default:t(()=>[l(p,{type:"password",modelValue:e(V),"onUpdate:modelValue":d[2]||(d[2]=X=>ce(V)?V.value=X:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:2},[e(f)==="common"?{name:"footer",fn:t(()=>[$("span",bl,[l(O,{type:"primary",disabled:!e(S),onClick:R},{default:t(()=>[k(v(e(P)("mainPasswordSetting.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"]),l(F,{ref_key:"mainPasswordVerifyRef",ref:n,onVerifyPass:N},null,512)],64)}}},yl={class:"dialog-footer"},vl={__name:"PasswordForm",props:{labelTree:Array},emits:["addPassword","updatePassword"],setup(Z,{expose:b,emit:J}){const P=J,{t:M}=me(),n=T(),_=le({password:!1}),f=T(""),S=le({uppercase:"ABCDEFGHJKLMNPQRSTUVWXYZ",lowercase:"abcdefghjkmnpqrstuvwxyz",number:"0123456789",symbol:"~!@#$^&*()_+.,;"}),V=()=>({id:0,name:"",address:"",userName:"",password:"",remark:"",label:"",insertTime:"",updateTime:""}),o=le(V()),u=le({length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}),h=le({name:[{required:!0,message:M("passwordForm.form.name.verify"),trigger:"blur"}]}),R=()=>{if(!u.number&&!u.symbol&&!u.lowercase&&!u.uppercase){ne.error(M("systemSetting.passwordRuleVerify"));return}let d=[];u.lowercase&&d.push(S.lowercase),u.uppercase&&d.push(S.uppercase),u.symbol&&d.push(S.symbol),u.number&&d.push(S.number),o.password=qt(d,u.length)},N=async d=>{await d.validate(s=>{s&&(_.password=!1,f.value==="add"?(o.id=Date.now(),o.insertTime=ve().format("YYYY-MM-DD HH:mm:ss"),P("addPassword",JSON.parse(JSON.stringify(o)))):(o.updateTime=ve().format("YYYY-MM-DD HH:mm:ss"),P("updatePassword",JSON.parse(JSON.stringify(o)))))})},Y=()=>{let d=fe("defaultPasswordRule");if(d)for(let s in d)u[s]=d[s]},G=()=>{Y();let d=V();for(let r in d)o[r]=d[r];fe("autoGeneratePassword")&&R(),f.value="add",_.password=!0},y=d=>{Y();for(let s in o)o[s]=d[s];f.value="update",_.password=!0},m=()=>document.documentElement.clientWidth;return b({showAddPassword:G,showUpdatePassword:y}),(d,s)=>{const r=we,a=Ce,x=ge,U=ze,p=$e,C=qe,A=Ge,D=Rt,O=Te,W=At;return g(),E(W,{modelValue:e(_).password,"onUpdate:modelValue":s[13]||(s[13]=F=>e(_).password=F),title:e(f)==="add"?e(M)("passwordForm.form.addPassword"):e(M)("passwordForm.form.editPassword"),size:"620px",direction:m()>768?"rtl":"btt"},{footer:t(()=>[$("span",yl,[l(x,{onClick:s[12]||(s[12]=F=>N(e(n))),type:"primary"},{default:t(()=>[k(v(e(M)("passwordForm.generateForm.save")),1)]),_:1})])]),default:t(()=>[l(O,{ref_key:"passwordFormRef",ref:n,model:e(o),rules:e(h),"label-width":"70px",style:{"padding-right":"30px"}},{default:t(()=>[l(a,{label:e(M)("password.name"),prop:"name"},{default:t(()=>[l(r,{modelValue:e(o).name,"onUpdate:modelValue":s[0]||(s[0]=F=>e(o).name=F),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),l(a,{label:e(M)("password.address")},{default:t(()=>[l(r,{modelValue:e(o).address,"onUpdate:modelValue":s[1]||(s[1]=F=>e(o).address=F),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),l(a,{label:e(M)("password.userName")},{default:t(()=>[l(r,{modelValue:e(o).userName,"onUpdate:modelValue":s[2]||(s[2]=F=>e(o).userName=F),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),l(a,{label:e(M)("password.password")},{default:t(()=>[l(A,{style:{width:"100%"}},{default:t(()=>[l(p,null,{default:t(()=>[l(U,null,{default:t(()=>[l(r,{modelValue:e(o).password,"onUpdate:modelValue":s[4]||(s[4]=F=>e(o).password=F),clearable:""},{append:t(()=>[l(x,{onClick:s[3]||(s[3]=F=>e(Ie)(e(o).password))},{default:t(()=>[k(v(e(M)("passwordForm.generateForm.password.copy")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(p,{style:{"margin-top":"15px"}},{default:t(()=>[l(U,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:t(()=>[l(C,{size:"small",modelValue:e(u).uppercase,"onUpdate:modelValue":s[5]||(s[5]=F=>e(u).uppercase=F),label:e(M)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),l(U,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:t(()=>[l(C,{size:"small",modelValue:e(u).lowercase,"onUpdate:modelValue":s[6]||(s[6]=F=>e(u).lowercase=F),label:e(M)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),l(U,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:t(()=>[l(C,{size:"small",modelValue:e(u).number,"onUpdate:modelValue":s[7]||(s[7]=F=>e(u).number=F),label:e(M)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),l(U,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:t(()=>[l(C,{size:"small",modelValue:e(u).symbol,"onUpdate:modelValue":s[8]||(s[8]=F=>e(u).symbol=F),label:e(M)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1})]),_:1}),l(p,{style:{"margin-top":"15px"}},{default:t(()=>[l(U,{style:{"text-align":"center"}},{default:t(()=>[l(r,{modelValue:e(u).length,"onUpdate:modelValue":s[9]||(s[9]=F=>e(u).length=F),size:"small",style:{width:"120px"}},{prepend:t(()=>[k(v(e(M)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"]),l(x,{plain:"",size:"small",style:{position:"relative",top:"-5px","margin-left":"10px"},type:"success",onClick:R},{default:t(()=>[k(v(e(M)("passwordForm.generateForm.randomPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["label"]),e(fe)("enableLabel")!==!1?(g(),E(a,{key:0,label:e(M)("password.label")},{default:t(()=>[l(D,{modelValue:e(o).label,"onUpdate:modelValue":s[10]||(s[10]=F=>e(o).label=F),"value-key":"id",data:Z.labelTree,"check-strictly":"",multiple:"","default-expand-all":"",placeholder:e(M)("password.label.placeholder"),filterable:""},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"])):z("",!0),l(a,{label:e(M)("password.remark")},{default:t(()=>[l(r,{type:"textarea",placeholder:e(M)("passwordForm.generateForm.remark"),rows:4,modelValue:e(o).remark,"onUpdate:modelValue":s[11]||(s[11]=F=>e(o).remark=F)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","direction"])}}};const hl={class:"label-tree-node"},kl=["onClick","onBlur"],Pl={class:"label-tree-node-menu"},xl={__name:"LabelTree",emits:["labelCheckChange","labelTreeChange"],setup(Z,{expose:b,emit:J}){const P=Ee(),{t:M}=me(),n=J,_=T(),f=T([]),S=T([]),V=T(!1),o=()=>{let s=_.value.getCheckedNodes();n("labelCheckChange",s)},u=(s,r)=>s?r.label.includes(s):!0,h=s=>{const r={id:Date.now(),label:M("labelTree.addLabel"),children:[]};s.children||(s.children=[]),s.children.push(r)},R=(s,r)=>{const a=s.parent,x=a.data.children||a.data,U=x.findIndex(p=>p.id===r.id);x.splice(U,1)},N=s=>!s.edit,Y=()=>{S.value.push({id:Date.now(),label:M("labelTree.firstAddLabel"),children:[]})},G=()=>{V.value&&nt("labelTree.json",{labelTree:S.value})},y=s=>{S.value=s};Je(f,s=>{_.value.filter(s)}),Je(S,()=>{G(),n("labelTreeChange",S.value)},{deep:!0});const m=()=>{rt("labelTree.json").then(s=>{s&&s.labelTree?S.value=s.labelTree:S.value=[],V.value=!0}).catch(s=>{tt.error(s.code)})},d=()=>P.value;return m(),b({setLabelTree:y}),(s,r)=>{const a=we,x=ge,U=Ve,p=Lt,C=It,A=Ge;return g(),E(A,{class:"body-card",style:st({"background-color":d()?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.4)"})},{header:t(()=>[k(v(e(M)("labelTree.title")),1)]),default:t(()=>[l(a,{modelValue:e(f),"onUpdate:modelValue":r[0]||(r[0]=D=>ce(f)?f.value=D:null),clearable:"",placeholder:e(M)("labelTree.search.placeholder")},null,8,["modelValue","placeholder"]),l(C,{height:"50vh"},{default:t(()=>[l(p,{data:e(S),"show-checkbox":"",ref_key:"labelTreeRef",ref:_,draggable:"","node-key":"id",style:{"margin-top":"10px","background-color":"rgba(0,0,0,0)"},onCheck:o,"filter-node-method":u,"expand-on-click-node":!1,"allow-drag":N,"default-expand-all":""},{empty:t(()=>[l(x,{size:"small",type:"primary",plain:"",onClick:Y},{default:t(()=>[k(v(e(M)("labelTree.firstAddLabel")),1)]),_:1})]),default:t(({node:D,data:O})=>[$("span",hl,[D.edit?z("",!0):(g(),j("span",{key:0,onClick:W=>D.edit=!0,onBlur:W=>D.edit=!1},v(O.label),41,kl)),D.edit?(g(),E(a,{key:1,style:{width:"60%"},ref:D.id+"_input",size:"small",onBlur:W=>D.edit=!1,modelValue:O.label,"onUpdate:modelValue":W=>O.label=W},null,8,["onBlur","modelValue","onUpdate:modelValue"])):z("",!0),$("span",Pl,[l(U,{onClick:W=>h(O),type:"primary",underline:!1},{default:t(()=>[k(v(e(M)("labelTree.tree.add")),1)]),_:2},1032,["onClick"]),l(U,{onClick:W=>R(D,O),type:"danger",underline:!1,style:{"margin-left":"8px"}},{default:t(()=>[k(v(e(M)("labelTree.tree.remove")),1)]),_:2},1032,["onClick"])])])]),_:1},8,["data"])]),_:1})]),_:1},8,["style"])}}},Sl=ot(xl,[["__scopeId","data-v-5b83f236"]]);const ke=Z=>(Ht("data-v-2dd3bdcf"),Z=Z(),Jt(),Z),Cl=ke(()=>$("img",{alt:"",class:"back-img",src:el},null,-1)),Vl={style:{display:"flex","justify-content":"space-between"}},Tl={class:"hidden-xs-only"},Ml=ke(()=>$("br",null,null,-1)),El={key:1},Fl={style:{display:"flex","justify-content":"end"},class:"password-title-right"},Ul=ke(()=>$("div",{class:"password-strength",style:{"background-color":"#67C23A"}},null,-1)),Dl=ke(()=>$("div",{class:"password-strength",style:{"background-color":"#E6A23C"}},null,-1)),Rl=ke(()=>$("div",{class:"password-strength",style:{"background-color":"#F56C6C"}},null,-1)),Al={key:0},Ll={class:"password-text"},Il={class:"pass-action-div"},Nl={__name:"IndexPage",setup(Z){const{t:b,locale:J}=me(),P=Ee(),M=T(),n=T(),_=T(),f=T(),S=T(),V=T(),o=T(),u=le({}),h=T(""),R=T(""),N=T(""),Y=T(!1),G=T(""),y=T([]),m=T([]),d=T([]),s=T([]),r=async()=>{if(!h.value&&!d.value){m.value=y.value;return}let i=[];for(let w=0;w<y.value.length;w++){let L=(y.value[w].name||"").toUpperCase(),B=(y.value[w].userName||"").toUpperCase(),q=(y.value[w].address||"").toUpperCase(),Q=(y.value[w].remark||"").toUpperCase(),ee=(y.value[w].password||"").toUpperCase(),se=!1;if(h.value){let oe=h.value.toUpperCase().split(/\s|,|\t|\r|\n|;/);for(let H=0;H<oe.length;H++)if(L.includes(oe[H])||B.includes(oe[H])||q.includes(oe[H])||Q.includes(oe[H])||ee.includes(oe[H])){se=!0;break}}else se=!0;let ie=!1;if(d.value.length>0)for(let oe=0;oe<d.value.length;oe++){let H=d.value[oe];if(y.value[w].label&&y.value[w].label.includes(H.id)){ie=!0;break}}else ie=!0;se&&ie&&i.push(y.value[w])}m.value=i},a=()=>{M.value.showAddPassword()},x=i=>{M.value.showUpdatePassword(i)},U=i=>{y.value.unshift(i),de(),r()},p=i=>{for(let w=0;w<y.value.length;w++)if(y.value[w].id===i.id){y.value[w]=i,de(),r();break}},C=()=>{G.value=je(y.value),Y.value=!1,m.value=[],y.value=[],R.value="",_.value.delLocalMainPassword()},A=()=>{_.value.verifyMainPassword()},D=i=>{let w=b("password.name")+": "+i.name+`\r
`;i.address&&(w+=b("password.address")+": "+i.address+`\r
`),i.userName&&(w+=b("password.userName")+": "+i.userName+`\r
`),i.password&&(w+=b("password.password")+": "+i.password+`\r
`),i.remark&&(w+=i.remark+`\r
`),w=w.substring(0,w.length-2),Ie(w)},O=i=>{for(let w=0;w<y.value.length;w++)if(y.value[w].id===i.id){y.value.splice(w,1),de(),r(),ne.success(b("index.table.delete.success"));break}},W=i=>{R.value=i,y.value=_t(G.value),Y.value=!0,r()},F=(i,w)=>{R.value=i,N.value=w,de(),ne.success(b("index.mainPassword.changeSuccess"))},X=()=>{S.value.openSystemSetting()},Fe=()=>{f.value.updateMainPassword()},Ue=(i,w)=>{u[i]=w,i==="sortChange"&&De(w)},De=i=>{i==="insertTimeDesc"?(n.value.sort("insertTime","descending"),re("insertTime",-1)):i==="insertTimeAsc"?(n.value.sort("insertTime","ascending"),re("insertTime",1)):i==="updateTimeDesc"?(n.value.sort("updateTime","descending"),re("updateTime",-1)):i==="updateTimeAsc"?(n.value.sort("updateTime","ascending"),re("updateTime",1)):i==="nameAsc"?(n.value.sort("name","ascending"),re("name",1)):i==="nameDesc"?(n.value.sort("name","descending"),re("name",-1)):i==="strengthDesc"?(n.value.sort("strength","descending"),re("strength",-1)):i==="strengthAsc"&&(n.value.sort("strength","ascending"),re("strength",1)),de()},_e=(i,w)=>be(i.password)>be(w.password)?1:-1,ye=i=>{let w=0;for(let L=0;L<y.value.length;L++){if(!y.value[L].password)continue;let B=be(y.value[L].password);i===B&&w++}return w},re=(i,w)=>{y.value.sort((L,B)=>i==="strength"?w>0?_e(L,B):_e(B,L):(L=L[i],B=B[i],L<B?w*-1:L>B?w*1:0))},de=()=>{if(!Y.value)return;G.value=je(y.value);let i=xe(R.value,"password-x");ae.commit("setVerifyCode",i),nt("password.json",{verifyValue:i,mainPasswordType:N.value,passwordCiphertext:G.value})},c=()=>{rt("password.json").then(i=>{if(i.verifyValue){let w=i.verifyValue;N.value=i.mainPasswordType||"common",ae.commit("setVerifyCode",w),ae.commit("setMainPasswordType",N.value),G.value=i.passwordCiphertext,_.value.verifyMainPassword(!0)}else Y.value=!0,f.value.settingMainPassword()}).catch(i=>{console.error(i),tt.error("error-1000："+i)})},it=i=>{d.value=i,r()},ut=i=>{s.value=i},mt=i=>{if(!i)return"";let w=[];return We(s.value,i,w),w},Ye=i=>i&&i.length===19?i.substring(0,16):i,We=(i,w,L)=>{for(let B=0;B<i.length;B++)w.includes(i[B].id)&&L.push(i[B].label),i[B].children&&i[B].children.length>0&&We(i[B].children,w,L)},ct=()=>{V.value.downloadExcelTemplate()},pt=()=>{V.value.importExcel(s.value)},ft=()=>{V.value.exportExcel(y.value,s.value)},wt=(i,w)=>{if(i.length!==0){for(let L=i.length-1;L>=0;L--)y.value.unshift(i[L]);o.value.setLabelTree(w),de(),r()}},gt=()=>{S.value.logout()},bt=()=>P.value,je=i=>{if(i.length===0)return;let w={},L=[],B=0;for(let q=0;q<i.length;q++){let Q=[];for(let ee in i[q]){let se=w[ee];se===void 0&&(w[ee]=B++,se=w[ee]),Q[se]=i[q][ee]}L.push(Q)}return xe(R.value,JSON.stringify({keys:w,datas:L}))},_t=i=>{let w=JSON.parse(pe(R.value,i));if(w instanceof Array)return w;let L=w.datas,B=w.keys,q=[];for(let Q=0;Q<L.length;Q++){let ee=L[Q],se={};for(let ie in B)se[ie]=ee[B[ie]];q.push(se)}return q};return lt(()=>{let i=Le();for(let w in i)u[w]=i[w];u.language&&u.language!==J.value&&(J.value=u.language),c()}),(i,w)=>{const L=et,B=we,q=ge,Q=Nt,ee=zt,se=$t,ie=Gt,oe=Bt,H=Yt,Pe=Ve,yt=Ot,vt=Wt,ht=jt,kt=Ge,Oe=ze,Pt=Sl,xt=$e,St=vl,Ct=dt,Vt=_l,Tt=fl,Mt=rl;return g(),j(K,null,[Cl,l(xt,{id:"passwordBody"},{default:t(()=>[l(Oe,{xl:{span:e(u).enableLabel?16:20,offset:2},lg:{span:e(u).enableLabel?19:24},md:{span:e(u).enableLabel?19:24}},{default:t(()=>[l(kt,{class:"body-card",style:st({"background-color":bt()?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.4)"})},{header:t(()=>[$("div",Vl,[$("div",null,[$("div",Tl,[e(y)?(g(),E(L,{key:0,class:"password-table-title"},{default:t(()=>[k(v(e(y).length)+" "+v(e(b)("index.title.passwordCount")),1)]),_:1})):z("",!0),Ml,e(u).showPasswordStrength?(g(),j("div",El,[l(L,{class:"password-table-strength"},{default:t(()=>[k(v(e(b)("index.title.strength"))+"（ ",1),l(L,{type:"success"},{default:t(()=>[k(v(e(b)("index.title.strength.strong")),1)]),_:1}),k(" : "+v(ye(3))+" ",1),l(L,{style:{"margin-left":"5px"},type:"warning"},{default:t(()=>[k(v(e(b)("index.title.strength.medium")),1)]),_:1}),k(" : "+v(ye(2))+" ",1),l(L,{style:{"margin-left":"5px"},type:"danger"},{default:t(()=>[k(v(e(b)("index.title.strength.weak")),1)]),_:1}),k(" : "+v(ye(1))+"） ",1)]),_:1})])):z("",!0)])]),$("div",Fl,[$("div",null,[l(B,{modelValue:e(h),"onUpdate:modelValue":w[0]||(w[0]=I=>ce(h)?h.value=I:null),style:{"max-width":"300px"},clearable:"",placeholder:e(b)("index.title.search"),"prefix-icon":e(tl),disabled:!e(R),onKeyup:at(r,["enter"])},null,8,["modelValue","placeholder","prefix-icon","disabled","onKeyup"])]),$("div",null,[l(q,{disabled:!e(R)||!e(Y),type:"primary",plain:"",onClick:w[1]||(w[1]=I=>a())},{default:t(()=>[k(v(e(b)("index.title.addPassword")),1)]),_:1},8,["disabled"])]),$("div",null,[e(R)?z("",!0):(g(),E(Q,{key:0,content:e(b)("index.title.unlock"),effect:"dark",placement:"top"},{default:t(()=>[l(q,{disabled:!e(G),icon:e(ll),onClick:A},null,8,["disabled","icon"])]),_:1},8,["content"])),e(R)?(g(),E(Q,{key:1,content:e(b)("index.title.lock"),effect:"dark",placement:"top"},{default:t(()=>[l(q,{icon:e(Xe),onClick:C},null,8,["icon"])]),_:1},8,["content"])):z("",!0)]),l(ie,null,{dropdown:t(()=>[l(se,null,{default:t(()=>[l(ee,{onClick:X},{default:t(()=>[k(v(e(b)("systemSetting.title")),1)]),_:1}),l(ee,{divided:"",onClick:pt},{default:t(()=>[k(v(e(b)("index.title.importExport.import")),1)]),_:1}),l(ee,{onClick:ft},{default:t(()=>[k(v(e(b)("index.title.importExport.export")),1)]),_:1}),l(ee,{onClick:ct},{default:t(()=>[k(v(e(b)("index.title.importExport.download")),1)]),_:1}),l(ee,{divided:"",onClick:gt},{default:t(()=>[k(v(e(b)("index.title.logout")),1)]),_:1})]),_:1})]),default:t(()=>[l(q,{icon:e(al)},null,8,["icon"])]),_:1})])])]),default:t(()=>[l(ht,{height:"calc(100vh - 130px)",style:{"background-color":"rgba(0,0,0,0)"},"header-row-style":{"background-color":"rgba(0,0,0,0)"},"header-cell-style":{"background-color":"rgba(0,0,0,0)"},"row-style":{"background-color":"rgba(0,0,0,0)"},"cell-style":{"background-color":"rgba(0,0,0,0)"},data:e(m),ref_key:"tableRef",ref:n},{empty:t(()=>[l(oe,{description:e(R)?e(b)("index.table.empty"):e(b)("index.table.lock")},Me({default:t(()=>[l(q,{onClick:A,plain:"",type:"primary"},{default:t(()=>[k(v(e(b)("index.title.unlock")),1)]),_:1})]),_:2},[e(R)?void 0:{name:"image",fn:t(()=>[l(e(Xe))]),key:"0"}]),1032,["description"])]),default:t(()=>[e(u).showPasswordStrength?(g(),E(H,{key:0,sortable:"","sort-method":_e,prop:"strength",width:"30px"},{default:t(I=>[e(be)(I.row.password)===3?(g(),E(Q,{key:0},{content:t(()=>[k(v(e(b)("index.title.strength")+"："+e(b)("index.title.strength.strong")),1)]),default:t(()=>[Ul]),_:1})):z("",!0),e(be)(I.row.password)===2?(g(),E(Q,{key:1},{content:t(()=>[k(v(e(b)("index.title.strength")+"："+e(b)("index.title.strength.medium")),1)]),default:t(()=>[Dl]),_:1})):z("",!0),e(be)(I.row.password)===1?(g(),E(Q,{key:2},{content:t(()=>[k(v(e(b)("index.title.strength")+"："+e(b)("index.title.strength.weak")),1)]),default:t(()=>[Rl]),_:1})):z("",!0)]),_:1})):z("",!0),l(H,{sortable:"",label:e(b)("password.name"),"min-width":"130px",prop:"name"},null,8,["label"]),l(H,{label:e(b)("password.address"),"min-width":"200px",prop:"address"},{default:t(I=>[e(Zt)(I.row.address)?(g(),E(Pe,{key:0,href:I.row.address,target:"_blank"},{default:t(()=>[k(v(I.row.address),1)]),_:2},1032,["href"])):(g(),E(L,{key:1},{default:t(()=>[k(v(I.row.address),1)]),_:2},1024))]),_:1},8,["label"]),l(H,{label:e(b)("password.userName"),"min-width":"140px",prop:"userName"},null,8,["label"]),l(H,{label:e(b)("password.password"),"min-width":"180px",prop:"password"},{default:t(I=>[I.row.password?(g(),j("div",Al,[$("span",Ll,[I.row.show?z("",!0):(g(),j(K,{key:0},[k("•••••••••")],64)),I.row.show?(g(),j(K,{key:1},[k(v(I.row.password),1)],64)):z("",!0)]),$("div",Il,[I.row.show?z("",!0):(g(),E(e(sl),{key:0,onClick:ue=>I.row.show=!I.row.show},null,8,["onClick"])),I.row.show?(g(),E(e(ol),{key:1,onClick:ue=>I.row.show=!I.row.show},null,8,["onClick"])):z("",!0),l(e(nl),{onClick:ue=>e(Ie)(I.row.password)},null,8,["onClick"])])])):z("",!0)]),_:1},8,["label"]),e(u).enableLabel!==!1&&e(u).showLabel!==!1?(g(),E(H,{key:1,label:e(b)("index.table.label"),"min-width":"130px",prop:"label"},{default:t(I=>[(g(!0),j(K,null,te(mt(I.row.label),ue=>(g(),E(yt,{style:{margin:"3px"},key:ue},{default:t(()=>[k(v(ue),1)]),_:2},1024))),128))]),_:1},8,["label"])):z("",!0),l(H,{label:e(b)("password.remark"),"min-width":"130px",prop:"remark"},null,8,["label"]),e(u).showAddTime?(g(),E(H,{key:2,sortable:"",label:e(b)("password.insertTime"),width:"145px",prop:"insertTime"},{default:t(I=>[k(v(Ye(I.row.insertTime)),1)]),_:1},8,["label"])):z("",!0),e(u).showUpTime?(g(),E(H,{key:3,sortable:"",label:e(b)("password.updateTime"),width:"145px",prop:"updateTime"},{default:t(I=>[k(v(Ye(I.row.updateTime)),1)]),_:1},8,["label"])):z("",!0),l(H,{width:"135px",label:e(b)("index.table.operation")},{default:t(I=>[l(Pe,{type:"success",underline:!1,onClick:ue=>D(I.row)},{default:t(()=>[k(v(e(b)("index.table.share")),1)]),_:2},1032,["onClick"]),l(Pe,{underline:!1,style:{"margin-left":"10px"},type:"primary",onClick:ue=>x(I.row)},{default:t(()=>[k(v(e(b)("index.table.edit")),1)]),_:2},1032,["onClick"]),l(vt,{title:e(b)("index.table.operation.affirmDelete"),"confirm-button-text":e(b)("index.table.operation.affirm"),"cancel-button-text":e(b)("index.table.operation.cancel"),onConfirm:ue=>O(I.row)},{reference:t(()=>[l(Pe,{style:{"margin-left":"10px"},underline:!1,type:"danger"},{default:t(()=>[k(v(e(b)("index.table.operation.delete")),1)]),_:1})]),_:2},1032,["title","confirm-button-text","cancel-button-text","onConfirm"])]),_:1},8,["label"])]),_:1},8,["header-row-style","header-cell-style","row-style","cell-style","data"])]),_:1},8,["style"])]),_:1},8,["xl","lg","md"]),e(u).enableLabel?(g(),E(Oe,{key:0,xl:{span:4},lg:{span:5},md:{span:5},class:"hidden-sm-and-down",style:{"padding-left":"15px"}},{default:t(()=>[l(Pt,{ref_key:"labelTreeRef",ref:o,onLabelCheckChange:it,onLabelTreeChange:ut},null,512)]),_:1})):z("",!0)]),_:1}),l(St,{ref_key:"passwordFormRef",ref:M,labelTree:e(s),onAddPassword:U,onUpdatePassword:p},null,8,["labelTree"]),l(Ct,{ref_key:"mainPasswordVerifyRef",ref:_,onVerifyPass:W},null,512),l(Vt,{ref_key:"mainPasswordSettingRef",ref:f,onMainPasswordChange:F},null,512),l(Tt,{ref_key:"systemSettingRef",ref:S,onUpdateMainPassword:Fe,onSystemChangeChange:Ue},null,512),l(Mt,{ref_key:"importExportRef",ref:V,labelTree:e(s),onImportComplete:wt},null,8,["labelTree"])],64)}}},da=ot(Nl,[["__scopeId","data-v-2dd3bdcf"]]);export{da as default};
