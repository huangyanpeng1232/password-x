import{E as De}from"./exceljs-6b62d6db.js";import{F as We}from"./file-saver-38a5c18e.js";import{h as be}from"./moment-fbc5633a.js";import{u as oe}from"./vue-i18n-63343f04.js";import{E as te,a as Ne,b as me,c as ce,d as Pe,e as Vt,f as Tt,g as xe,h as Je,i as Le,j as ze,k as Ke,l as Se,m as Xe,n as Ce,o as Ze,p as $e,q as Mt,r as Et,s as qe,t as Ft,u as Rt,v as Dt,w as Ut,x as At,y as It,z as Nt,A as Lt,B as zt,C as $t,D as Bt}from"./element-plus-f0301b72.js";import{r as T,o as b,c as W,X as Z,b as Qe,u as e,O as B,I as D,ac as Ve,J as l,a as N,S as t,P as C,Q as h,A as ie,R as J,aj as ee,ak as et,w as Oe,_ as tt,ar as Gt,as as Yt}from"./@vue-054857f9.js";import{m as Wt}from"./js-md5-11f5a111.js";import{h as Te}from"./@vueuse-1b6f7037.js";import{d as ue,s as q,g as ve,a as je,l as Ae,b as Ue,u as Ot,c as fe,e as ye,f as Ie,r as jt,_ as lt,p as at,h as st,i as Ht}from"./index-ef15e1da.js";import{u as Jt}from"./vue-router-e948df84.js";import{_ as Kt}from"./backImg-a3b16eec.js";import{m as Xt,u as Zt,n as He,o as qt,v as Qt,h as el,r as tl}from"./@element-plus-7b906f9a.js";import"./ali-oss-21f5c855.js";import"./@intlify-9ddbe450.js";import"./lodash-es-f5bdeb48.js";import"./async-validator-dee29e8b.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./escape-html-cf2a8097.js";import"./normalize-wheel-es-ed76fb12.js";import"./crypto-js-d55471a7.js";import"./vuex-90336bc0.js";import"./cos-js-sdk-v5-31c61e27.js";const ll={__name:"ImportExport",emits:["importComplete"],setup(X,{expose:g,emit:H}){const{t:k}=oe(),M=H,n=T(),y=T(),f=T(0),P=i=>{n.value.click(),y.value=i},V=async()=>{if(n.value.files===0)return;f.value=Date.now();const i=new De.Workbook;i.xlsx.load(n.value.files[0]).then(()=>{i.eachSheet(function(d){if(d.rowCount<2){te.error(k("importExport.data.empty")),n.value.value="";return}let s=[];for(let r=2;r<=d.rowCount;r++){let a=d.getRow(r),x=o(a.getCell(1).value),F=o(a.getCell(2).value),p=o(a.getCell(3).value),S=o(a.getCell(4).value),A=o(a.getCell(5).value),R=o(a.getCell(6).value),O=o(a.getCell(7).value),Y=o(a.getCell(8).value);x&&s.push({id:f.value++,name:x,address:F,userName:p,password:S,remark:R,label:m(A),insertTime:O,updateTime:Y})}M("importComplete",s,y.value),n.value.value=""})}).catch(d=>{te.error(d),n.value.value=""})},o=i=>i?typeof i=="object"?i instanceof Date?be(i).format("YYYY-MM-DD HH:mm:ss"):i.text:i.toString():"",m=i=>{if(!i)return"";let d=[],s=i.split("、");for(let r=0;r<s.length;r++){let a=_(y.value,s[r],"");if(a)d.push(a);else{let x=[];U(y.value,s[r].split(">"),0,x);for(let F=0;F<x.length;F++)d.push(x[F])}}return Array.from(new Set(d))},_=(i,d,s)=>{for(let r=0;r<i.length;r++){let a=s?s+">"+i[r].label:i[r].label;if(d===a)return i[r].id;if(i[r].children&&i[r].children.length>0)return _(i[r].children,d,a)}},U=(i,d,s,r)=>{if(!d[s])return;for(let x=0;x<i.length;x++)if(i[x].label===d[s])return d[s+1]||r.push(i[x].id),U(i[x].children,d,s+1,r);let a={id:f.value++,label:d[s],children:[]};i.push(a),d[s+1]||r.push(a.id),U(a.children,d,s+1,r)},I=async(i,d)=>{y.value=d;const s=new De.Workbook,r=s.addWorksheet("sheet1");r.getCell("A1").value=k("password.name"),r.getCell("B1").value=k("password.address"),r.getCell("C1").value=k("password.userName"),r.getCell("D1").value=k("password.password"),r.getCell("E1").value=k("password.label"),r.getCell("F1").value=k("password.remark"),r.getCell("G1").value=k("password.insertTime"),r.getCell("H1").value=k("password.updateTime");for(let a=0;a<i.length;a++){let x=i[a].insertTime;x||(x=be().format("YYYY-MM-DD HH:mm:ss")),r.getCell("A"+(a+2)).value=i[a].name,r.getCell("B"+(a+2)).value=i[a].address,r.getCell("C"+(a+2)).value=i[a].userName,r.getCell("D"+(a+2)).value=i[a].password,r.getCell("E"+(a+2)).value=G(i[a].label),r.getCell("F"+(a+2)).value=i[a].remark,r.getCell("G"+(a+2)).value=x,r.getCell("H"+(a+2)).value=i[a].updateTime}s.xlsx.writeBuffer().then(a=>{let x=new Blob([a],{type:"application/octet-stream"});We.saveAs(x,k("importExport.exportName")+"_"+be().format("YYYY-MM-DD HH:mm:ss")+".xlsx")})},G=i=>{if(!i)return"";let d=[];return $(y.value,i,d,""),d.join("、")},$=(i,d,s,r)=>{for(let a=0;a<i.length;a++){let x=r?r+">"+i[a].label:i[a].label;d.includes(i[a].id)&&s.push(x),i[a].children&&i[a].children.length>0&&$(i[a].children,d,s,x)}};return g({importExcel:P,exportExcel:I,downloadExcelTemplate:()=>{const i=new De.Workbook,d=i.addWorksheet("sheet1");d.getCell("A1").value=k("password.name"),d.getCell("B1").value=k("password.address"),d.getCell("C1").value=k("password.userName"),d.getCell("D1").value=k("password.password"),d.getCell("E1").value=k("password.label"),d.getCell("F1").value=k("password.remark"),d.getCell("G1").value=k("password.insertTime"),d.getCell("H1").value=k("password.updateTime"),i.xlsx.writeBuffer().then(s=>{let r=new Blob([s],{type:"application/octet-stream"});We.saveAs(r,k("importExport.importTemplateName")+".xlsx")})}}),(i,d)=>(b(),W("input",{type:"file",onChange:V,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ref_key:"fileUploadInput",ref:n,style:{display:"none"}},null,544))}},al=["width","height"],Be={__name:"GesturePassword",props:{size:{type:Number,default:300},count:{type:Number,default:3},showGesture:{type:Boolean,default:!0}},emits:["complete"],setup(X,{expose:g,emit:H}){const k=Te(),M=H,n=T();let y=X;const f=Z({padding:y.size*.18,background:k.value?"rgb(20,20,20)":"#fff",failColor:"#F56C6C",passColor:"#67C23A",point:{color:"#409EFF",size:y.size*.023,selected:{range:y.size*.07,color:"#409EFF",size:y.size*.023,madding:{color:"#409EFF",size:y.size*.07,lineWidth:1}}},line:{color:"#409EFF",width:2}}),P=T({}),V=T([]),o=T(!1),m=T("");let _=null;const U=()=>{f.background=k.value?"rgb(20,20,20)":"#fff",_=n.value.getContext("2d"),I()},I=()=>{_.fillStyle=f.background,_.fillRect(0,0,y.size,y.size),P.value=[];let p=(y.size-f.padding*2)/(y.count-1),S=1;for(let A=0;A<y.count;A++)for(let R=0;R<y.count;R++){let O=f.padding+R*p,Y=f.padding+A*p,E=p/2,K={id:S,x:O,y:Y,startX:O-E,endX:O+E,startY:Y-E,endY:Y+E,h:p,w:p};G(K),P.value[S]=K,S++}},G=p=>{let S=a(p);S&&y.showGesture&&(_.beginPath(),m.value==="fail"?_.strokeStyle=f.failColor:m.value==="pass"?_.strokeStyle=f.passColor:_.strokeStyle=f.point.selected.madding.color,_.lineWidth=f.point.selected.madding.lineWidth,_.arc(p.x,p.y,f.point.selected.madding.size,0,Math.PI*2),_.stroke()),_.beginPath(),S&&y.showGesture?(m.value==="fail"?_.fillStyle=f.failColor:m.value==="pass"?_.fillStyle=f.passColor:_.fillStyle=f.point.selected.madding.color,_.arc(p.x,p.y,f.point.selected.size,0,Math.PI*2)):(_.fillStyle=f.point.color,_.arc(p.x,p.y,f.point.size,0,Math.PI*2)),_.fill()},$=()=>{o.value=!0},v=()=>{if(!o.value)return;o.value=!1;let p=d();if(p){let S=Wt(p);M("complete",S)}I(),r()},i=p=>{m.value=p,I(),r(),p?setTimeout(()=>{m.value="",V.value=[],I()},500):(V.value=[],I())},d=()=>{let p="";for(let S=0;S<V.value.length;S++)p+=V.value[S].id+",";return p&&(p=p.substring(0,p.length-1)),p},s=p=>{let S=p.offsetX,A=p.offsetY;if(I(),r(S,A),!o.value)return;let R=x(S,A);!R||a(R)||(V.value.push(R),I(),r(S,A))},r=(p,S)=>{if(!y.showGesture)return;let A=x(p,S);if(A&&m.value===""&&(_.beginPath(),_.strokeStyle=f.point.selected.madding.color,_.lineWidth=f.point.selected.madding.lineWidth,_.arc(A.x,A.y,f.point.selected.madding.size,0,Math.PI*2),_.stroke()),V.value.length!==0){_.beginPath(),m.value==="fail"?_.strokeStyle=f.failColor:m.value==="pass"?_.strokeStyle=f.passColor:_.strokeStyle=f.line.color,_.lineWidth=f.line.width,_.lineCap="round",_.moveTo(V.value[0].x,V.value[0].y);for(let R=1;R<V.value.length;R++)_.lineTo(V.value[R].x,V.value[R].y);o.value&&p&&S&&m.value===""&&_.lineTo(p,S),_.stroke()}},a=p=>{for(let S=0;S<V.value.length;S++)if(p.id===V.value[S].id)return!0;return!1},x=(p,S)=>{for(let A in P.value){let R=P.value[A];if(p>R.startX+f.point.selected.range&&p<R.endX-f.point.selected.range&&S>R.startY+f.point.selected.range&&S<R.endY-f.point.selected.range)return R}},F=p=>{let S=p.touches[0].clientX-n.value.offsetLeft,A=p.touches[0].clientY-n.value.offsetTop;s({offsetX:S,offsetY:A})};return Qe(()=>{U()}),g({setVerifyStatus:i}),(p,S)=>e(y).size?(b(),W("canvas",{key:0,width:e(y).size,height:e(y).size,ref_key:"canvasRef",ref:n,onMousedown:$,onMouseup:v,onMousemove:S[0]||(S[0]=A=>s(A)),onMouseleave:v,onTouchstart:$,onTouchend:v,onTouchmove:F},null,40,al)):B("",!0)}},sl={style:{"text-align":"center"}},ol={class:"dialog-footer"},nl={__name:"DeleteAccount",emits:["deleteAccount"],setup(X,{expose:g,emit:H}){const{t:k}=oe(),M=H,n=T(),y=Z({deleteAccount:!1}),f=T(""),P=T(""),V=()=>{let U=ue(P.value,q.state.verifyCode);if(U&&U==="password-x"){f.value==="gesture"&&n.value.setVerifyStatus("pass");let I=localStorage.getItem("databaseForm"),G=ue(ve(),I);if(JSON.parse(G).keyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){te.error("演示账号不能注销");return}je("password.json"),je("labelTree.json"),localStorage.removeItem("systemConfig"),te.success(k("systemSetting.deleteAccount.success")),M("deleteAccount")}else f.value==="common"?te.error(k("systemSetting.deleteAccount.mainPasswordError")):n.value.setVerifyStatus("fail")},o=()=>{f.value=q.state.mainPasswordType,y.deleteAccount=!0},m=U=>{P.value=U,V()},_=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){_.value=document.documentElement.clientWidth<728}),g({showDeleteAccount:o}),(U,I)=>{const G=Ne,$=Be,v=me,i=ce,d=Pe;return b(),D(d,{fullscreen:e(_),modelValue:e(y).deleteAccount,"onUpdate:modelValue":I[1]||(I[1]=s=>e(y).deleteAccount=s),title:e(k)("systemSetting.deleteAccount"),width:"400px"},Ve({default:l(()=>[t(G,{type:"error",closable:!1},{default:l(()=>[C(h(e(k)("systemSetting.deleteAccount.text")),1)]),_:1}),N("div",sl,[e(f)==="gesture"?(b(),D($,{key:0,ref_key:"gesturePasswordRef",ref:n,onComplete:m},null,512)):B("",!0),e(f)==="common"?(b(),D(v,{key:1,modelValue:e(P),"onUpdate:modelValue":I[0]||(I[0]=s=>ie(P)?P.value=s:null),style:{"margin-top":"20px"}},null,8,["modelValue"])):B("",!0)])]),_:2},[e(f)==="common"?{name:"footer",fn:l(()=>[N("span",ol,[t(i,{type:"danger",onClick:V},{default:l(()=>[C(h(e(k)("systemSetting.deleteAccount.affirm")),1)]),_:1})])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},rl={style:{"text-align":"center"}},dl={style:{"margin-top":"20px"}},il={style:{"margin-top":"20px"}},ul={style:{"margin-top":"20px"}},ml={class:"dialog-footer"},cl={__name:"SystemSetting",emits:["updateMainPassword","deleteAccount","systemChangeChange"],setup(X,{expose:g,emit:H}){const k=Jt(),M=Te(),{t:n,locale:y}=oe(),f=H,P=T(),V=Z({setting:!1}),o=Z(Ae()),m=Z({languages:[],sorts:[],topics:[],cacheMains:[],showAddTimes:[],showUpTimes:[],showLabels:[],verifyShowGestures:[],cacheDatabaseForms:[],autoGeneratePasswords:[],showPasswordStrengths:[]}),_=()=>{m.languages=[{key:"zh-cn",label:"简体中文"},{key:"en-us",label:"English"}],m.sorts=[{key:"insertTimeDesc",label:n("systemSetting.sort.insertTimeDesc")},{key:"insertTimeAsc",label:n("systemSetting.sort.insertTimeAsc")},{key:"updateTimeDesc",label:n("systemSetting.sort.updateTimeDesc")},{key:"updateTimeAsc",label:n("systemSetting.sort.updateTimeAsc")},{key:"nameAsc",label:n("systemSetting.sort.nameAsc")},{key:"nameDesc",label:n("systemSetting.sort.nameDesc")},{key:"strengthDesc",label:n("systemSetting.sort.strengthAsc")},{key:"strengthAsc",label:n("systemSetting.sort.strengthDesc")}],m.topics=[{key:!1,label:n("systemSetting.topic.light")},{key:!0,label:n("systemSetting.topic.dark")}],m.cacheMains=[{key:!0,label:n("systemSetting.cacheMainPassword.enable")},{key:!1,label:n("systemSetting.cacheMainPassword.disabled")}],m.showAddTimes=[{key:!0,label:n("systemSetting.showAddTime.enable")},{key:!1,label:n("systemSetting.showAddTime.disabled")}],m.showUpTimes=[{key:!0,label:n("systemSetting.showUpTime.enable")},{key:!1,label:n("systemSetting.showUpTime.disabled")}],m.showLabels=[{key:!0,label:n("systemSetting.showLabel.enable")},{key:!1,label:n("systemSetting.showLabel.disabled")}],m.verifyShowGestures=[{key:!0,label:n("mainPasswordSetting.verify.showGesture.enable")},{key:!1,label:n("mainPasswordSetting.verify.showGesture.disabled")}],m.cacheDatabaseForms=[{key:!0,label:n("systemSetting.cacheDatabaseForm.enable")},{key:!1,label:n("systemSetting.cacheDatabaseForm.disabled")}],m.autoGeneratePasswords=[{key:!0,label:n("passwordForm.autoGeneratePassword.enable")},{key:!1,label:n("passwordForm.autoGeneratePassword.disabled")}],m.showPasswordStrengths=[{key:!0,label:n("systemSetting.showPasswordStrength.enable")},{key:!1,label:n("systemSetting.showPasswordStrength.disabled")}]};let U=null;const I=()=>{_();let r=Ae();for(let a in r)o[a]=r[a];U=JSON.stringify(o),V.setting=!0},G=()=>{V.setting=!1},$=()=>{let r=o.defaultPasswordRule;if(!r.number&&!r.symbol&&!r.lowercase&&!r.uppercase){te.error(n("systemSetting.passwordRuleVerify"));return}Ot(o);let a=JSON.parse(U);o.cacheMainPassword!==a.cacheMainPassword&&o.cacheMainPassword===!1&&(localStorage.removeItem("mainPasswordCiphertext"),console.log("删除主密码缓存")),o.cacheDatabaseForm!==a.cacheDatabaseForm&&o.cacheDatabaseForm===!1&&(localStorage.removeItem("databaseForm"),console.log("删除自动登录信息")),o.language!==y.value&&(y.value=o.language,console.log("系统语言设置为：",o.language)),M.value!==o.darkMode&&(M.value=o.darkMode,console.log("暗黑模式设置为：",o.darkMode)),o.sortRule!==a.sortRule&&(f("systemChangeChange","sortChange",o.sortRule),console.log("排序规则设置为：",o.sortRule)),o.showPasswordStrength!==a.showPasswordStrength&&(f("systemChangeChange","showPasswordStrength",o.showPasswordStrength),console.log("是否显示密码强度设置为：",o.showPasswordStrength)),V.setting=!1},v=()=>{localStorage.removeItem("databaseForm"),localStorage.removeItem("mainPasswordCiphertext"),q.commit("delDatabase"),q.commit("delDatabaseForm"),q.commit("delVerifyCode"),k.push("/login")},i=()=>{V.setting=!1,f("updateMainPassword")},d=()=>{V.setting=!1,P.value.showDeleteAccount()},s=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){s.value=document.documentElement.clientWidth<728}),g({logout:v,openSystemSetting:I,showUpdateMainPassword:i,settingForm:o}),(r,a)=>{const x=Vt,F=Tt,p=xe,S=Je,A=Le,R=me,O=ze,Y=Ke,E=ce,K=Se,Me=Xe,Ee=Ce,Fe=Ne,le=Pe,we=nl;return b(),W(J,null,[t(le,{fullscreen:e(s),modelValue:e(V).setting,"onUpdate:modelValue":a[16]||(a[16]=c=>e(V).setting=c),title:e(n)("systemSetting.title"),width:"600px"},{footer:l(()=>[N("span",ml,[t(E,{plain:"",onClick:G},{default:l(()=>[C(h(e(n)("systemSetting.close")),1)]),_:1}),t(E,{type:"primary",plain:"",onClick:$},{default:l(()=>[C(h(e(n)("systemSetting.save")),1)]),_:1})])]),default:l(()=>[t(Ee,{"label-width":"120px"},{default:l(()=>[t(Me,{"tab-position":"left",style:{height:"350px"}},{default:l(()=>[t(Y,{label:e(n)("systemSetting.type.general")},{default:l(()=>[t(p,{label:e(n)("systemSetting.language")},{default:l(()=>[t(F,{modelValue:e(o).language,"onUpdate:modelValue":a[0]||(a[0]=c=>e(o).language=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).languages,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.sort")},{default:l(()=>[t(F,{modelValue:e(o).sortRule,"onUpdate:modelValue":a[1]||(a[1]=c=>e(o).sortRule=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).sorts,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("passwordForm.autoGeneratePassword")},{default:l(()=>[t(F,{modelValue:e(o).autoGeneratePassword,"onUpdate:modelValue":a[2]||(a[2]=c=>e(o).autoGeneratePassword=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).autoGeneratePasswords,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.defaultPasswordRule")},{default:l(()=>[t(O,{style:{"margin-top":"15px"}},{default:l(()=>[t(A,{span:12},{default:l(()=>[t(S,{size:"small",modelValue:e(o).defaultPasswordRule.uppercase,"onUpdate:modelValue":a[3]||(a[3]=c=>e(o).defaultPasswordRule.uppercase=c),label:e(n)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(A,{span:12},{default:l(()=>[t(S,{size:"small",modelValue:e(o).defaultPasswordRule.lowercase,"onUpdate:modelValue":a[4]||(a[4]=c=>e(o).defaultPasswordRule.lowercase=c),label:e(n)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(A,{span:12},{default:l(()=>[t(S,{size:"small",modelValue:e(o).defaultPasswordRule.number,"onUpdate:modelValue":a[5]||(a[5]=c=>e(o).defaultPasswordRule.number=c),label:e(n)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(A,{span:12},{default:l(()=>[t(S,{size:"small",modelValue:e(o).defaultPasswordRule.symbol,"onUpdate:modelValue":a[6]||(a[6]=c=>e(o).defaultPasswordRule.symbol=c),label:e(n)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1}),t(A,{span:24},{default:l(()=>[N("div",null,[t(R,{size:"small",style:{position:"relative",top:"3px"},modelValue:e(o).defaultPasswordRule.length,"onUpdate:modelValue":a[7]||(a[7]=c=>e(o).defaultPasswordRule.length=c)},{prepend:l(()=>[C(h(e(n)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["label"])]),_:1},8,["label"]),t(Y,{label:e(n)("systemSetting.type.personalization")},{default:l(()=>[t(p,{label:e(n)("systemSetting.topic")},{default:l(()=>[t(F,{modelValue:e(o).darkMode,"onUpdate:modelValue":a[8]||(a[8]=c=>e(o).darkMode=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).topics,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.showPasswordStrength")},{default:l(()=>[t(F,{modelValue:e(o).showPasswordStrength,"onUpdate:modelValue":a[9]||(a[9]=c=>e(o).showPasswordStrength=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).showPasswordStrengths,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.showAddTime")},{default:l(()=>[t(F,{modelValue:e(o).showAddTime,"onUpdate:modelValue":a[10]||(a[10]=c=>e(o).showAddTime=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).showAddTimes,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.showUpTime")},{default:l(()=>[t(F,{modelValue:e(o).showUpTime,"onUpdate:modelValue":a[11]||(a[11]=c=>e(o).showUpTime=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).showUpTimes,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.showLabel")},{default:l(()=>[t(F,{modelValue:e(o).showLabel,"onUpdate:modelValue":a[12]||(a[12]=c=>e(o).showLabel=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).showLabels,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["label"]),t(Y,{label:e(n)("systemSetting.type.security")},{default:l(()=>[t(p,{label:e(n)("systemSetting.cacheMainPassword")},{default:l(()=>[t(F,{modelValue:e(o).cacheMainPassword,"onUpdate:modelValue":a[13]||(a[13]=c=>e(o).cacheMainPassword=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).cacheMains,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("systemSetting.cacheDatabaseForm")},{default:l(()=>[t(F,{modelValue:e(o).cacheDatabaseForm,"onUpdate:modelValue":a[14]||(a[14]=c=>e(o).cacheDatabaseForm=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).cacheDatabaseForms,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e(n)("mainPasswordSetting.verify.showGesture")},{default:l(()=>[t(F,{modelValue:e(o).verifyShowGesture,"onUpdate:modelValue":a[15]||(a[15]=c=>e(o).verifyShowGesture=c)},{default:l(()=>[(b(!0),W(J,null,ee(e(m).verifyShowGestures,c=>(b(),D(x,{key:c.key,label:c.label,value:c.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["label"]),t(Y,{label:e(n)("systemSetting.type.other")},{default:l(()=>[N("div",rl,[t(E,{plain:"",onClick:i},{default:l(()=>[C(h(e(n)("systemSetting.updateMainPassword")),1)]),_:1}),t(E,{plain:"",type:"danger",onClick:d},{default:l(()=>[C(h(e(n)("systemSetting.deleteAccount")),1)]),_:1}),t(E,{type:"warning",plain:"",onClick:v},{default:l(()=>[C(h(e(n)("systemSetting.logout")),1)]),_:1})])]),_:1},8,["label"]),t(Y,{label:e(n)("systemSetting.about"),style:{"text-align":"center"}},{default:l(()=>[N("div",dl,h(e(n)("systemSetting.about.version"))+"："+h(e(Ue)("VITE_VERSION")),1),N("div",il,[C(h(e(n)("systemSetting.about.openSourceUrl"))+"：",1),t(K,{target:"_blank",href:e(Ue)("VITE_OPEN_SOURCE_URL")},{default:l(()=>[C(h(e(Ue)("VITE_OPEN_SOURCE_URL")),1)]),_:1},8,["href"])]),N("div",ul,h(e(n)("systemSetting.about.submit")),1)]),_:1},8,["label"])]),_:1})]),_:1}),t(Fe,{style:{"margin-top":"20px"},type:"warning"},{default:l(()=>[C(h(e(n)("systemSetting.takeEffect")),1)]),_:1})]),_:1},8,["fullscreen","modelValue","title"]),t(we,{ref_key:"deleteAccountRef",ref:P,onDeleteAccount:v},null,512)],64)}}},pl={style:{"text-align":"center"}},fl={class:"dialog-footer"},ot={__name:"MainPasswordVerify",emits:["verifyPass"],setup(X,{expose:g,emit:H}){const{t:k}=oe(),M=H,n=T(),y=T(""),f=T(""),P=Z({verifyMainPassword:!1}),V=v=>{y.value=v,o()},o=()=>{let v=ue(y.value,q.state.verifyCode);v&&v==="password-x"?(f.value==="gesture"&&n.value.setVerifyStatus("pass"),M("verifyPass",y.value),_(y.value),y.value="",P.verifyMainPassword=!1):f.value==="common"?te.error(k("mainPasswordVerify.form.verify")):n.value.setVerifyStatus("fail")},m=()=>{localStorage.removeItem("mainPasswordCiphertext")},_=v=>{if(fe("cacheMainPassword")===!1)return;let d=ve(),s=ye(d,v);localStorage.setItem("mainPasswordCiphertext",s)},U=()=>{if(fe("cacheMainPassword")===!1)return null;let i=localStorage.getItem("mainPasswordCiphertext");if(!i)return null;let d=ve(),s=ue(d,i);return s||null},I=()=>fe("verifyShowGesture")!==!1,G=(v=!0)=>{if(f.value=q.state.mainPasswordType,!v){P.verifyMainPassword=!0;return}let i=U();if(!i){P.verifyMainPassword=!0;return}let d=ue(i,q.state.verifyCode);d&&d==="password-x"?M("verifyPass",i):P.verifyMainPassword=!0},$=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){$.value=document.documentElement.clientWidth<728}),g({verifyMainPassword:G,delLocalMainPassword:m}),(v,i)=>{const d=Be,s=me,r=xe,a=Ce,x=ce,F=Pe;return b(),D(F,{fullscreen:e($),modelValue:e(P).verifyMainPassword,"onUpdate:modelValue":i[1]||(i[1]=p=>e(P).verifyMainPassword=p),title:e(k)("mainPasswordVerify.form.title"),width:"400px"},Ve({default:l(()=>[N("div",pl,[e(f)==="gesture"&&e(P).verifyMainPassword?(b(),D(d,{key:0,"show-gesture":I(),ref_key:"gesturePasswordRef",ref:n,onComplete:V},null,8,["show-gesture"])):B("",!0),e(f)==="common"&&e(P).verifyMainPassword?(b(),D(a,{key:1,style:{padding:"10px"}},{default:l(()=>[t(r,null,{default:l(()=>[t(s,{modelValue:e(y),"onUpdate:modelValue":i[0]||(i[0]=p=>ie(y)?y.value=p:null),placeholder:e(k)("mainPasswordVerify.form.mainPassword"),type:"password",onKeyup:et(o,["enter"])},null,8,["modelValue","placeholder","onKeyup"])]),_:1})]),_:1})):B("",!0)])]),_:2},[e(f)==="common"?{name:"footer",fn:l(()=>[N("span",fl,[t(x,{type:"primary",disabled:!e(y),onClick:o},{default:l(()=>[C(h(e(k)("mainPasswordVerify.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"])}}},wl={class:"dialog-footer"},gl={__name:"MainPasswordSetting",emits:["mainPasswordChange"],setup(X,{expose:g,emit:H}){const{t:k}=oe(),M=H,n=T(),y=T(),f=T("gesture"),P=T(""),V=T(""),o=Z({mainPassword:!1}),m=T(""),_=i=>{m.value==="setting"?(P.value=i,m.value="affirm",y.value.setVerifyStatus("")):m.value==="affirm"&&(V.value=i,U())},U=()=>{if(P.value!==V.value){te.error(k("mainPasswordSetting.form.passwordsDiff"));return}let i=localStorage.getItem("databaseForm"),d=ue(ve(),i);if(JSON.parse(d).accessKeyId==="LTAI5tRPBc5sY6KbZd1Vc1jU"){te.error("演示账号不能修改主密码");return}f.value==="gesture"?q.commit("setMainPasswordType","gesture"):q.commit("setMainPasswordType","common"),M("mainPasswordChange",P.value,f.value);let r=fe("cacheMainPassword");if(r||r==null){let a=ve(),x=ye(a,P.value);localStorage.setItem("mainPasswordCiphertext",x)}P.value="",V.value="",o.mainPassword=!1},I=()=>{m.value="setting",o.mainPassword=!0},G=()=>{n.value.verifyMainPassword(!1)},$=()=>{f.value==="gesture"&&(m.value="setting"),P.value="",V.value=""},v=T(document.documentElement.clientWidth<728);return window.addEventListener("resize",function(){v.value=document.documentElement.clientWidth<728}),g({settingMainPassword:I,updateMainPassword:G}),(i,d)=>{const s=Ne,r=Ze,a=Be,x=Se,F=Ke,p=me,S=xe,A=Ce,R=Xe,O=ce,Y=Pe,E=ot;return b(),W(J,null,[t(Y,{fullscreen:e(v),modelValue:e(o).mainPassword,"onUpdate:modelValue":d[4]||(d[4]=K=>e(o).mainPassword=K),title:e(k)("mainPasswordSetting.form.setMainPassword"),width:"470px"},Ve({default:l(()=>[t(s,{type:"error",style:{position:"relative",top:"-10px"},closable:!1},{default:l(()=>[C(h(e(k)("mainPasswordSetting.forget.message")),1)]),_:1}),t(R,{modelValue:e(f),"onUpdate:modelValue":d[3]||(d[3]=K=>ie(f)?f.value=K:null),style:{"margin-top":"10px"},type:"card",onTabChange:$},{default:l(()=>[t(F,{label:e(k)("mainPasswordSetting.passwordType.gesture"),name:"gesture",style:{"text-align":"center"}},{default:l(()=>[N("div",null,[e(m)==="setting"?(b(),D(r,{key:0},{default:l(()=>[C(h(e(k)("mainPasswordSetting.gesture.first")),1)]),_:1})):B("",!0),e(m)==="affirm"?(b(),D(r,{key:1},{default:l(()=>[C(h(e(k)("mainPasswordSetting.gesture.affirm")),1)]),_:1})):B("",!0)]),e(o).mainPassword&&e(f)==="gesture"?(b(),D(a,{key:0,ref_key:"gesturePasswordRef",ref:y,onComplete:_},null,512)):B("",!0),N("div",null,[t(x,{underline:!1,style:{position:"relative",top:"-2px"},type:"primary",onClick:d[0]||(d[0]=K=>m.value="setting")},{default:l(()=>[C(h(e(k)("mainPasswordSetting.gesture.reset")),1)]),_:1})])]),_:1},8,["label"]),t(F,{label:e(k)("mainPasswordSetting.passwordType.common"),name:"common",style:{"text-align":"center"}},{default:l(()=>[t(A,{inline:!0,"label-width":"100px",style:{"margin-top":"20px"}},{default:l(()=>[t(S,{label:e(k)("mainPasswordSetting.form.newMainPassword")},{default:l(()=>[t(p,{type:"password",modelValue:e(P),"onUpdate:modelValue":d[1]||(d[1]=K=>ie(P)?P.value=K:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"]),t(S,{label:e(k)("mainPasswordSetting.form.newMainPasswordAffirm")},{default:l(()=>[t(p,{type:"password",modelValue:e(V),"onUpdate:modelValue":d[2]||(d[2]=K=>ie(V)?V.value=K:null),style:{width:"231px"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:2},[e(f)==="common"?{name:"footer",fn:l(()=>[N("span",wl,[t(O,{type:"primary",disabled:!e(P),onClick:U},{default:l(()=>[C(h(e(k)("mainPasswordSetting.form.save")),1)]),_:1},8,["disabled"])])]),key:"0"}:void 0]),1032,["fullscreen","modelValue","title"]),t(E,{ref_key:"mainPasswordVerifyRef",ref:n,onVerifyPass:I},null,512)],64)}}},_l={class:"dialog-footer"},bl={__name:"PasswordForm",props:{labelTree:Array},emits:["addPassword","updatePassword"],setup(X,{expose:g,emit:H}){const k=H,{t:M}=oe(),n=T(),y=Z({password:!1}),f=T(""),P=Z({uppercase:"ABCDEFGHJKLMNPQRSTUVWXYZ",lowercase:"abcdefghjkmnpqrstuvwxyz",number:"0123456789",symbol:"~!@#$^&*()_+.,;"}),V=()=>({id:0,name:"",address:"",userName:"",password:"",remark:"",label:"",insertTime:"",updateTime:""}),o=Z(V()),m=Z({length:16,number:!0,lowercase:!0,uppercase:!0,symbol:!0}),_=Z({name:[{required:!0,message:M("passwordForm.form.name.verify"),trigger:"blur"}]}),U=()=>{if(!m.number&&!m.symbol&&!m.lowercase&&!m.uppercase){te.error(M("systemSetting.passwordRuleVerify"));return}let d=[];m.lowercase&&d.push(P.lowercase),m.uppercase&&d.push(P.uppercase),m.symbol&&d.push(P.symbol),m.number&&d.push(P.number),o.password=jt(d,m.length)},I=async d=>{await d.validate(s=>{s&&(y.password=!1,f.value==="add"?(o.id=Date.now(),o.insertTime=be().format("YYYY-MM-DD HH:mm:ss"),k("addPassword",JSON.parse(JSON.stringify(o)))):(o.updateTime=be().format("YYYY-MM-DD HH:mm:ss"),k("updatePassword",JSON.parse(JSON.stringify(o)))))})},G=()=>{let d=fe("defaultPasswordRule");if(d)for(let s in d)m[s]=d[s]},$=()=>{G();let d=V();for(let r in d)o[r]=d[r];fe("autoGeneratePassword")&&U(),f.value="add",y.password=!0},v=d=>{G();for(let s in o)o[s]=d[s];f.value="update",y.password=!0},i=()=>document.documentElement.clientWidth;return g({showAddPassword:$,showUpdatePassword:v}),(d,s)=>{const r=me,a=xe,x=ce,F=Le,p=ze,S=Je,A=$e,R=Mt,O=Ce,Y=Et;return b(),D(Y,{modelValue:e(y).password,"onUpdate:modelValue":s[13]||(s[13]=E=>e(y).password=E),title:e(f)==="add"?e(M)("passwordForm.form.addPassword"):e(M)("passwordForm.form.editPassword"),size:"620px",direction:i()>768?"rtl":"btt"},{footer:l(()=>[N("span",_l,[t(x,{onClick:s[12]||(s[12]=E=>I(e(n))),type:"primary"},{default:l(()=>[C(h(e(M)("passwordForm.generateForm.save")),1)]),_:1})])]),default:l(()=>[t(O,{ref_key:"passwordFormRef",ref:n,model:e(o),rules:e(_),"label-width":"70px",style:{"padding-right":"30px"}},{default:l(()=>[t(a,{label:e(M)("password.name"),prop:"name"},{default:l(()=>[t(r,{modelValue:e(o).name,"onUpdate:modelValue":s[0]||(s[0]=E=>e(o).name=E),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(a,{label:e(M)("password.address")},{default:l(()=>[t(r,{modelValue:e(o).address,"onUpdate:modelValue":s[1]||(s[1]=E=>e(o).address=E),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(a,{label:e(M)("password.userName")},{default:l(()=>[t(r,{modelValue:e(o).userName,"onUpdate:modelValue":s[2]||(s[2]=E=>e(o).userName=E),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),t(a,{label:e(M)("password.password")},{default:l(()=>[t(A,{style:{width:"100%"}},{default:l(()=>[t(p,null,{default:l(()=>[t(F,null,{default:l(()=>[t(r,{modelValue:e(o).password,"onUpdate:modelValue":s[4]||(s[4]=E=>e(o).password=E),clearable:""},{append:l(()=>[t(x,{onClick:s[3]||(s[3]=E=>e(Ie)(e(o).password))},{default:l(()=>[C(h(e(M)("passwordForm.generateForm.password.copy")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(p,{style:{"margin-top":"15px"}},{default:l(()=>[t(F,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(S,{size:"small",modelValue:e(m).uppercase,"onUpdate:modelValue":s[5]||(s[5]=E=>e(m).uppercase=E),label:e(M)("passwordForm.generateForm.uppercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(F,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(S,{size:"small",modelValue:e(m).lowercase,"onUpdate:modelValue":s[6]||(s[6]=E=>e(m).lowercase=E),label:e(M)("passwordForm.generateForm.lowercase"),border:""},null,8,["modelValue","label"])]),_:1}),t(F,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(S,{size:"small",modelValue:e(m).number,"onUpdate:modelValue":s[7]||(s[7]=E=>e(m).number=E),label:e(M)("passwordForm.generateForm.number"),border:""},null,8,["modelValue","label"])]),_:1}),t(F,{xs:{span:12},md:{span:6},style:{"text-align":"center"}},{default:l(()=>[t(S,{size:"small",modelValue:e(m).symbol,"onUpdate:modelValue":s[8]||(s[8]=E=>e(m).symbol=E),label:e(M)("passwordForm.generateForm.symbol"),border:""},null,8,["modelValue","label"])]),_:1})]),_:1}),t(p,{style:{"margin-top":"15px"}},{default:l(()=>[t(F,{style:{"text-align":"center"}},{default:l(()=>[t(r,{modelValue:e(m).length,"onUpdate:modelValue":s[9]||(s[9]=E=>e(m).length=E),size:"small",style:{width:"120px"}},{prepend:l(()=>[C(h(e(M)("passwordForm.generateForm.length")),1)]),_:1},8,["modelValue"]),t(x,{plain:"",size:"small",style:{position:"relative",top:"-5px","margin-left":"10px"},type:"success",onClick:U},{default:l(()=>[C(h(e(M)("passwordForm.generateForm.randomPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["label"]),t(a,{label:e(M)("password.label")},{default:l(()=>[t(R,{modelValue:e(o).label,"onUpdate:modelValue":s[10]||(s[10]=E=>e(o).label=E),"value-key":"id",data:X.labelTree,"check-strictly":"",multiple:"","default-expand-all":"",placeholder:e(M)("password.label.placeholder"),filterable:""},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),t(a,{label:e(M)("password.remark")},{default:l(()=>[t(r,{type:"textarea",placeholder:e(M)("passwordForm.generateForm.remark"),rows:4,modelValue:e(o).remark,"onUpdate:modelValue":s[11]||(s[11]=E=>e(o).remark=E)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","direction"])}}};const yl={class:"label-tree-node"},vl=["onClick","onBlur"],hl={class:"label-tree-node-menu"},kl={__name:"LabelTree",emits:["labelCheckChange","labelTreeChange"],setup(X,{expose:g,emit:H}){const k=Te(),{t:M}=oe(),n=H,y=T(),f=T([]),P=T([]),V=T(!1),o=()=>{let s=y.value.getCheckedNodes();n("labelCheckChange",s)},m=(s,r)=>s?r.label.includes(s):!0,_=s=>{const r={id:Date.now(),label:M("labelTree.addLabel"),children:[]};s.children||(s.children=[]),s.children.push(r)},U=(s,r)=>{const a=s.parent,x=a.data.children||a.data,F=x.findIndex(p=>p.id===r.id);x.splice(F,1)},I=s=>!s.edit,G=()=>{P.value.push({id:Date.now(),label:M("labelTree.firstAddLabel"),children:[]})},$=()=>{V.value&&at("labelTree.json",{labelTree:P.value})},v=s=>{P.value=s};Oe(f,s=>{y.value.filter(s)}),Oe(P,()=>{$(),n("labelTreeChange",P.value)},{deep:!0});const i=()=>{st("labelTree.json").then(s=>{s&&s.labelTree?P.value=s.labelTree:P.value=[],V.value=!0}).catch(s=>{qe.error(s.code)})},d=()=>k.value;return i(),g({setLabelTree:v}),(s,r)=>{const a=me,x=ce,F=Se,p=Ft,S=Rt,A=$e;return b(),D(A,{class:"body-card",style:tt({"background-color":d()?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.4)"})},{header:l(()=>[C(h(e(M)("labelTree.title")),1)]),default:l(()=>[t(a,{modelValue:e(f),"onUpdate:modelValue":r[0]||(r[0]=R=>ie(f)?f.value=R:null),clearable:"",placeholder:e(M)("labelTree.search.placeholder")},null,8,["modelValue","placeholder"]),t(S,{height:"50vh"},{default:l(()=>[t(p,{data:e(P),"show-checkbox":"",ref_key:"labelTreeRef",ref:y,draggable:"","node-key":"id",style:{"margin-top":"10px","background-color":"rgba(0,0,0,0)"},onCheck:o,"filter-node-method":m,"expand-on-click-node":!1,"allow-drag":I,"default-expand-all":""},{empty:l(()=>[t(x,{size:"small",type:"primary",plain:"",onClick:G},{default:l(()=>[C(h(e(M)("labelTree.firstAddLabel")),1)]),_:1})]),default:l(({node:R,data:O})=>[N("span",yl,[R.edit?B("",!0):(b(),W("span",{key:0,onClick:Y=>R.edit=!0,onBlur:Y=>R.edit=!1},h(O.label),41,vl)),R.edit?(b(),D(a,{key:1,style:{width:"60%"},ref:R.id+"_input",size:"small",onBlur:Y=>R.edit=!1,modelValue:O.label,"onUpdate:modelValue":Y=>O.label=Y},null,8,["onBlur","modelValue","onUpdate:modelValue"])):B("",!0),N("span",hl,[t(F,{onClick:Y=>_(O),type:"primary",underline:!1},{default:l(()=>[C(h(e(M)("labelTree.tree.add")),1)]),_:2},1032,["onClick"]),t(F,{onClick:Y=>U(R,O),type:"danger",underline:!1,style:{"margin-left":"8px"}},{default:l(()=>[C(h(e(M)("labelTree.tree.remove")),1)]),_:2},1032,["onClick"])])])]),_:1},8,["data"])]),_:1})]),_:1},8,["style"])}}},Pl=lt(kl,[["__scopeId","data-v-5b83f236"]]);const he=X=>(Gt("data-v-b5fb178d"),X=X(),Yt(),X),xl=he(()=>N("img",{alt:"",class:"back-img",src:Kt},null,-1)),Sl={style:{display:"flex","justify-content":"space-between"}},Cl={class:"hidden-xs-only"},Vl=he(()=>N("br",null,null,-1)),Tl={key:1},Ml={style:{display:"flex","justify-content":"end"},class:"password-title-right"},El=he(()=>N("div",{class:"password-strength",style:{"background-color":"#67C23A"}},null,-1)),Fl=he(()=>N("div",{class:"password-strength",style:{"background-color":"#E6A23C"}},null,-1)),Rl=he(()=>N("div",{class:"password-strength",style:{"background-color":"#F56C6C"}},null,-1)),Dl={key:0},Ul={class:"password-text"},Al={class:"pass-action-div"},Il={__name:"IndexPage",setup(X){const{t:g,locale:H}=oe(),k=Te(),M=T(),n=T(),y=T(),f=T(),P=T(),V=T(),o=T(),m=Z({}),_=T(""),U=T(""),I=T(""),G=T(!1),$=T(""),v=T([]),i=T([]),d=T([]),s=T([]),r=async()=>{if(!_.value&&!d.value){i.value=v.value;return}let u=[];for(let w=0;w<v.value.length;w++){let z=v.value[w].name||"",j=v.value[w].userName||"",ne=v.value[w].address||"",re=v.value[w].remark||"",de=v.value[w].password||"",Re=!_.value||z.includes(_.value)||j.includes(_.value)||ne.includes(_.value)||re.includes(_.value)||de.includes(_.value),ge=!1;if(d.value.length>0)for(let _e=0;_e<d.value.length;_e++){let Q=d.value[_e];v.value[w].label&&v.value[w].label.includes(Q.id)&&(ge=!0)}else ge=!0;Re&&ge&&u.push(v.value[w])}i.value=u},a=()=>{M.value.showAddPassword()},x=u=>{M.value.showUpdatePassword(u)},F=u=>{v.value.unshift(u),pe(),r()},p=u=>{for(let w=0;w<v.value.length;w++)if(v.value[w].id===u.id){v.value[w]=u,pe(),r();break}},S=()=>{$.value=ye(U.value,JSON.stringify(v.value)),G.value=!1,i.value=[],v.value=[],U.value="",y.value.delLocalMainPassword()},A=()=>{y.value.verifyMainPassword()},R=u=>{let w=g("password.name")+": "+u.name+`\r
`;u.address&&(w+=g("password.address")+": "+u.address+`\r
`),u.userName&&(w+=g("password.userName")+": "+u.userName+`\r
`),u.password&&(w+=g("password.password")+": "+u.password+`\r
`),u.remark&&(w+=u.remark+`\r
`),w=w.substring(0,w.length-2),Ie(w)},O=u=>{for(let w=0;w<v.value.length;w++)if(v.value[w].id===u.id){v.value.splice(w,1),pe(),r(),te.success(g("index.table.delete.success"));break}},Y=u=>{U.value=u;let w=ue(u,$.value);v.value=JSON.parse(w),G.value=!0,r()},E=(u,w)=>{U.value=u,I.value=w,pe(),te.success(g("index.mainPassword.changeSuccess"))},K=()=>{P.value.openSystemSetting()},Me=()=>{f.value.updateMainPassword()},Ee=(u,w)=>{m[u]=w,u==="sortChange"&&Fe(w)},Fe=u=>{u==="insertTimeDesc"?(n.value.sort("insertTime","descending"),ae("insertTime",-1)):u==="insertTimeAsc"?(n.value.sort("insertTime","ascending"),ae("insertTime",1)):u==="updateTimeDesc"?(n.value.sort("updateTime","descending"),ae("updateTime",-1)):u==="updateTimeAsc"?(n.value.sort("updateTime","ascending"),ae("updateTime",1)):u==="nameAsc"?(n.value.sort("name","ascending"),ae("name",1)):u==="nameDesc"?(n.value.sort("name","descending"),ae("name",-1)):u==="strengthDesc"?(n.value.sort("strength","descending"),ae("strength",-1)):u==="strengthAsc"&&(n.value.sort("strength","ascending"),ae("strength",1)),pe()},le=u=>{let w=0;return/[0-9]/.test(u)&&w++,/[a-z]/.test(u)&&w++,/[A-Z]/.test(u)&&w++,/[^0-9a-zA-Z_]/.test(u)&&w++,u.length<6&&w>2&&(w=2),w>3?3:w},we=(u,w)=>le(u.password)>le(w.password)?1:-1,c=u=>{let w=0;for(let z=0;z<v.value.length;z++){if(!v.value[z].password)continue;let j=le(v.value[z].password);u===j&&w++}return w},ae=(u,w)=>{v.value.sort((z,j)=>u==="strength"?w>0?we(z,j):we(j,z):(z=z[u],j=j[u],z<j?w*-1:z>j?w*1:0))},pe=()=>{if(!G.value)return;$.value=ye(U.value,JSON.stringify(v.value));let u=ye(U.value,"password-x");q.commit("setVerifyCode",u),at("password.json",{verifyValue:u,mainPasswordType:I.value,passwordCiphertext:$.value})},nt=()=>{st("password.json").then(u=>{if(u.verifyValue){let w=u.verifyValue;I.value=u.mainPasswordType||"common",q.commit("setVerifyCode",w),q.commit("setMainPasswordType",I.value),$.value=u.passwordCiphertext,y.value.verifyMainPassword(!0)}else G.value=!0,f.value.settingMainPassword()}).catch(u=>{console.error(u),qe.error("error-1000："+u)})},rt=u=>{d.value=u,r()},dt=u=>{s.value=u},it=u=>{if(!u)return"";let w=[];return Ge(s.value,u,w),w},Ge=(u,w,z)=>{for(let j=0;j<u.length;j++)w.includes(u[j].id)&&z.push(u[j].label),u[j].children&&u[j].children.length>0&&Ge(u[j].children,w,z)},ut=()=>{V.value.downloadExcelTemplate()},mt=()=>{V.value.importExcel(s.value)},ct=()=>{V.value.exportExcel(v.value,s.value)},pt=(u,w)=>{if(u.length!==0){for(let z=u.length-1;z>=0;z--)v.value.unshift(u[z]);o.value.setLabelTree(w),pe(),r()}},ft=()=>{P.value.logout()},wt=()=>k.value;return Qe(()=>{let u=Ae();for(let w in u)m[w]=u[w];m.language&&m.language!==H.value&&(H.value=m.language),nt()}),(u,w)=>{const z=Ze,j=me,ne=ce,re=Dt,de=Ut,Re=At,ge=It,_e=Nt,Q=Lt,ke=Se,gt=Bt,_t=zt,bt=$t,yt=$e,Ye=Le,vt=Pl,ht=ze,kt=bl,Pt=ot,xt=gl,St=cl,Ct=ll;return b(),W(J,null,[xl,t(ht,{id:"passwordBody"},{default:l(()=>[t(Ye,{xl:{span:16,offset:2},lg:{span:19},md:{span:19}},{default:l(()=>[t(yt,{class:"body-card",style:tt({"background-color":wt()?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.4)"})},{header:l(()=>[N("div",Sl,[N("div",null,[N("div",Cl,[e(v)?(b(),D(z,{key:0,class:"password-table-title"},{default:l(()=>[C(h(e(v).length)+" "+h(e(g)("index.title.passwordCount")),1)]),_:1})):B("",!0),Vl,e(m).showPasswordStrength?(b(),W("div",Tl,[t(z,{class:"password-table-strength"},{default:l(()=>[C(h(e(g)("index.title.strength"))+"（ ",1),t(z,{type:"success"},{default:l(()=>[C(h(e(g)("index.title.strength.strong")),1)]),_:1}),C(" : "+h(c(3))+" ",1),t(z,{style:{"margin-left":"5px"},type:"warning"},{default:l(()=>[C(h(e(g)("index.title.strength.medium")),1)]),_:1}),C(" : "+h(c(2))+" ",1),t(z,{style:{"margin-left":"5px"},type:"danger"},{default:l(()=>[C(h(e(g)("index.title.strength.weak")),1)]),_:1}),C(" : "+h(c(1))+"） ",1)]),_:1})])):B("",!0)])]),N("div",Ml,[N("div",null,[t(j,{modelValue:e(_),"onUpdate:modelValue":w[0]||(w[0]=L=>ie(_)?_.value=L:null),style:{"max-width":"300px"},clearable:"",placeholder:e(g)("index.title.search"),"prefix-icon":e(Xt),disabled:!e(U),onKeyup:et(r,["enter"])},null,8,["modelValue","placeholder","prefix-icon","disabled","onKeyup"])]),N("div",null,[t(ne,{disabled:!e(U)||!e(G),type:"primary",plain:"",onClick:w[1]||(w[1]=L=>a())},{default:l(()=>[C(h(e(g)("index.title.addPassword")),1)]),_:1},8,["disabled"])]),N("div",null,[e(U)?B("",!0):(b(),D(re,{key:0,content:e(g)("index.title.unlock"),effect:"dark",placement:"top"},{default:l(()=>[t(ne,{disabled:!e($),icon:e(Zt),onClick:A},null,8,["disabled","icon"])]),_:1},8,["content"])),e(U)?(b(),D(re,{key:1,content:e(g)("index.title.lock"),effect:"dark",placement:"top"},{default:l(()=>[t(ne,{icon:e(He),onClick:S},null,8,["icon"])]),_:1},8,["content"])):B("",!0)]),t(ge,null,{dropdown:l(()=>[t(Re,null,{default:l(()=>[t(de,{onClick:K},{default:l(()=>[C(h(e(g)("systemSetting.title")),1)]),_:1}),t(de,{divided:"",onClick:mt},{default:l(()=>[C(h(e(g)("index.title.importExport.import")),1)]),_:1}),t(de,{onClick:ct},{default:l(()=>[C(h(e(g)("index.title.importExport.export")),1)]),_:1}),t(de,{onClick:ut},{default:l(()=>[C(h(e(g)("index.title.importExport.download")),1)]),_:1}),t(de,{divided:"",onClick:ft},{default:l(()=>[C(h(e(g)("index.title.logout")),1)]),_:1})]),_:1})]),default:l(()=>[t(ne,{icon:e(qt)},null,8,["icon"])]),_:1})])])]),default:l(()=>[t(bt,{height:"calc(100vh - 150px)",style:{"background-color":"rgba(0,0,0,0)"},"header-row-style":{"background-color":"rgba(0,0,0,0)"},"header-cell-style":{"background-color":"rgba(0,0,0,0)"},"row-style":{"background-color":"rgba(0,0,0,0)"},"cell-style":{"background-color":"rgba(0,0,0,0)"},data:e(i),"highlight-current-row":"",ref_key:"tableRef",ref:n},{empty:l(()=>[t(_e,{description:e(U)?e(g)("index.table.empty"):e(g)("index.table.lock")},Ve({default:l(()=>[t(ne,{onClick:A,plain:"",type:"primary"},{default:l(()=>[C(h(e(g)("index.title.unlock")),1)]),_:1})]),_:2},[e(U)?void 0:{name:"image",fn:l(()=>[t(e(He))]),key:"0"}]),1032,["description"])]),default:l(()=>[e(m).showPasswordStrength?(b(),D(Q,{key:0,sortable:"","sort-method":we,prop:"strength",width:"30px"},{default:l(L=>[le(L.row.password)===3?(b(),D(re,{key:0},{content:l(()=>[C(h(e(g)("index.title.strength")+"："+e(g)("index.title.strength.strong")),1)]),default:l(()=>[El]),_:1})):B("",!0),le(L.row.password)===2?(b(),D(re,{key:1},{content:l(()=>[C(h(e(g)("index.title.strength")+"："+e(g)("index.title.strength.medium")),1)]),default:l(()=>[Fl]),_:1})):B("",!0),le(L.row.password)===1?(b(),D(re,{key:2},{content:l(()=>[C(h(e(g)("index.title.strength")+"："+e(g)("index.title.strength.weak")),1)]),default:l(()=>[Rl]),_:1})):B("",!0)]),_:1})):B("",!0),t(Q,{sortable:"",label:e(g)("password.name"),"min-width":"140px",prop:"name"},null,8,["label"]),t(Q,{label:e(g)("password.address"),"min-width":"200px",prop:"address"},{default:l(L=>[e(Ht)(L.row.address)?(b(),D(ke,{key:0,href:L.row.address,target:"_blank"},{default:l(()=>[C(h(L.row.address),1)]),_:2},1032,["href"])):(b(),D(z,{key:1},{default:l(()=>[C(h(L.row.address),1)]),_:2},1024))]),_:1},8,["label"]),t(Q,{label:e(g)("password.userName"),"min-width":"120px",prop:"userName"},null,8,["label"]),t(Q,{label:e(g)("password.password"),"min-width":"150px",prop:"password"},{default:l(L=>[L.row.password?(b(),W("div",Dl,[N("span",Ul,[L.row.show?B("",!0):(b(),W(J,{key:0},[C("•••••••")],64)),L.row.show?(b(),W(J,{key:1},[C(h(L.row.password),1)],64)):B("",!0)]),N("div",Al,[L.row.show?B("",!0):(b(),D(e(Qt),{key:0,onClick:se=>L.row.show=!L.row.show},null,8,["onClick"])),L.row.show?(b(),D(e(el),{key:1,onClick:se=>L.row.show=!L.row.show},null,8,["onClick"])):B("",!0),t(e(tl),{onClick:se=>e(Ie)(L.row.password)},null,8,["onClick"])])])):B("",!0)]),_:1},8,["label"]),e(m).showLabel!==!1?(b(),D(Q,{key:1,label:e(g)("index.table.label"),"min-width":"130px",prop:"label"},{default:l(L=>[(b(!0),W(J,null,ee(it(L.row.label),se=>(b(),D(gt,{style:{margin:"3px"},key:se},{default:l(()=>[C(h(se),1)]),_:2},1024))),128))]),_:1},8,["label"])):B("",!0),t(Q,{label:e(g)("password.remark"),"min-width":"100px",prop:"remark"},null,8,["label"]),e(m).showAddTime?(b(),D(Q,{key:2,sortable:"",label:e(g)("password.insertTime"),"min-width":"130px",prop:"insertTime"},null,8,["label"])):B("",!0),e(m).showUpTime?(b(),D(Q,{key:3,sortable:"",label:e(g)("password.updateTime"),"min-width":"130px",prop:"updateTime"},null,8,["label"])):B("",!0),t(Q,{"min-width":"140px",label:e(g)("index.table.operation")},{default:l(L=>[t(ke,{type:"success",underline:!1,onClick:se=>R(L.row)},{default:l(()=>[C(h(e(g)("index.table.share")),1)]),_:2},1032,["onClick"]),t(ke,{underline:!1,style:{"margin-left":"10px"},type:"primary",onClick:se=>x(L.row)},{default:l(()=>[C(h(e(g)("index.table.edit")),1)]),_:2},1032,["onClick"]),t(_t,{title:e(g)("index.table.operation.affirmDelete"),"confirm-button-text":e(g)("index.table.operation.affirm"),"cancel-button-text":e(g)("index.table.operation.cancel"),onConfirm:se=>O(L.row)},{reference:l(()=>[t(ke,{style:{"margin-left":"10px"},underline:!1,type:"danger"},{default:l(()=>[C(h(e(g)("index.table.operation.delete")),1)]),_:1})]),_:2},1032,["title","confirm-button-text","cancel-button-text","onConfirm"])]),_:1},8,["label"])]),_:1},8,["header-row-style","header-cell-style","row-style","cell-style","data"])]),_:1},8,["style"])]),_:1}),t(Ye,{xl:{span:4},lg:{span:5},md:{span:5},class:"hidden-sm-and-down",style:{"padding-left":"15px"}},{default:l(()=>[t(vt,{ref_key:"labelTreeRef",ref:o,onLabelCheckChange:rt,onLabelTreeChange:dt},null,512)]),_:1})]),_:1}),t(kt,{ref_key:"passwordFormRef",ref:M,labelTree:e(s),onAddPassword:F,onUpdatePassword:p},null,8,["labelTree"]),t(Pt,{ref_key:"mainPasswordVerifyRef",ref:y,onVerifyPass:Y},null,512),t(xt,{ref_key:"mainPasswordSettingRef",ref:f,onMainPasswordChange:E},null,512),t(St,{ref_key:"systemSettingRef",ref:P,onUpdateMainPassword:Me,onSystemChangeChange:Ee},null,512),t(Ct,{ref_key:"importExportRef",ref:V,labelTree:e(s),onImportComplete:pt},null,8,["labelTree"])],64)}}},na=lt(Il,[["__scopeId","data-v-b5fb178d"]]);export{na as default};
